<!doctype linuxdoc system>

<!-- kde handbook
 -->

<article>

<!-- Title information -->

<title>Описание национальной клавиатуры
<author>Александр Будник, <tt/budnik@linserv.jinr.ru/
<date>v1.0b1, Oct 23 1998
<abstract>Данное описание соответствует версии 1.0b1

<!-- Table of contents -->
<toc>

<!-- Begin the document -->

<sect>Вступление<p>

  KiKbd предназначено для национализации клавиатуры в среде KDE/Xwindow.

  KiKbd не использует XKB, она использует динамически сменяемый xmodmap.
  Это значит что в одно и тоже время можно иметь под рукой множество разных
  раскладок.

  В дополнение KiKbd может делать полезную работу - например назначать
  для каждого окошка или приложения свою раскладку
  (используя стиль ввода <it>Окно</it> или <it>Класс</it>).

</sect>

<sect>Установка<p>

  Установка проводиться как обычно :-)
  <verb>
     % ./configure
     % make
     % make install
  </verb>
  Для успешной установки необходим KDE 1.0. 
  <comment>
  Начиная с KDE1.1 KiKbd включено в <it>kdebase</it>.
  </comment>

</sect>

<sect>Национальная клавиатура<p>

  Для каждой национальной клавиатуры KiKbd запоминает соответствие
  клавиши клавиатуры двум, трем или четырем символам.
  Например в русском клавише 'Q' соответствует символы 'й', 'Й', 'q', 'Q'.
  Первые два символа называются национальными, последние два - альтернативными.
  Для набора альтернативных символов в конфигурации надо назначить
  специальный <it>Альтернативный переключатель</it>. Смотрите
  <ref id="config" name="Персональная конфигурация">.

  Первый символ 'й' вы получите при обычном нажатии, второй 'Й' при нажатом
  Shift, третий 'q' при нажатом  <it>Альтернативном переключателе</it> и
  четвертый 'Q' при нажатых Shift и <it>Альтернативном переключателе</it>.

  Во время написания этого документа в дистрибутиве KiKbd уже находилось
  более двадцати готовых клавиатур.
  
  Если нужная вам клавиатура отсутствует, смотрите 
  <ref id="create" name="Создание новой клавиатуры">.

<sect>Персональная конфигурация<label id="config"><p>

  Персональная конфигурация включает все необходимые установки KiKbd.
  Для изменения конфигурации необходимо пользоваться программой kcmikbd.
  Когда вы запускаете KiKbd в первый раз, вы получите копию системной
  конфигурации.

  <sect1>Главное<p>

  <p><img SRC=general.gif>

  <sect2>Раскладки<p>

    Используя кнопки <it>Добавить</it> и <it>Удалить</it> вы можете
    создать список необходимых вам раскладок. Верхняя раскладка в
    списке станет основной при старте KiKbd.

    Если вы используете более двух раскладок (например английскую,
    русскую КОИ8 и русскую 1251), очень удобно включить
    <it>Использование горячего списка</it>.
    В этом случае с клавиатуры будут переключаться только две раскладки -
    основная и дополнительная активная. Поменять дополнительную активную
    можно из меню KiKbd. Если же еще включить стиль ввода <it>Окно</it>
    или <it>Класс</it> то вы с успехом можете набирать КОИ8 в одном
    окне и 1251 в другом.

  </sect2>
  <sect2>Переключатель и Альтернативный переключатель<p>

    Для переключения раскладок с клавиатуры вы можете назначить
    комбинации клавиш из списка. Так же можно назначить альтернативный
    переключатель для набора альтернативных символов.

  </sect2>
  <sect2>Сигнал<p>

    Если включить режим сигнала вы будете информированы о любом переключении
    раскладок.

  </sect2>
  </sect1>

  <sect1>Специальное<label id="advanced"><p>

    <img SRC=advanced.gif>
    <sect2>Глобальное меню<p>

      Если включить эту опцию, вы легко можете активировать меню KiKbd
      в любом месте экрана удерживая какое-то время клавиши
      выбранного переключателя.

    </sect2>
    <sect2>Эмулировать Caps Lock<p>

      Для некоторых раскладок (как например для русской) есть проблемы
      с Caps Lock. KiKbd может решить эту проблему эмулируя Caps Lock.
      В этом случае статус Сaps Lock будет отображаться не лампочками
      клавиатуры а цветом фона кнопки KiKbd.

    </sect2>
    <sect2>Ввод<p>
 
      Вы можете выбрать:

      <itemize>
      <item>
        Глобально - "обычное" поведение, раскладка активируется для всех
        окошек.
      </item>
      <item>
        Окно - "расширенное" поведение, каждое окошко помнит свою активную
        раскладку
      </item>
      <item>
        Класс - "специальное" поведение, каждому классу окошек назначается
        своя активная раскладка. Вы можете печатать по русски в окошке
        редактора и набирать команды shell не заботясь о переключении
        раскладок. Причем в каждом вновь открытом окне редактора русский
        будет включен автоматически.
      </item>
      </itemize>

    </sect2>
    <sect2>Сохранять Классы<p>

      Если вы выбрали стиль ввода <it>Окно</it> то вы можете сохранять
      текущее соответствие раскладок оконным классам при окончании работы
      и восстанавливать это соответствие в следующей сессии.

    </sect2>

  </sect1>

  <sect1>Стиль<p>

    Вы можете назначить фонт и установить три цвета:
    <p><img SRC=style.gif>

    <sect2>Передний план<p>
      Это текст надписи на кнопке KiKbd.
    </sect2>

    <sect2>Вместе с Caps Lock<p>
      Этот цвет фона будет обозначать включенный Caps Lock если
      включен режим эмуляции Caps Lock.
    </sect2>

    <sect2>Вместе с Альтернативным<p>
      Этот цвет фона будет обозначать нажатый Альтернативный переключатель.
    </sect2>

    <sect2>Выбрать свой Фонт<p>
      Можно выбрать специальный фонт для KiKbd или использовать основные
      установки KDE.
    </sect2>

  </sect1>

  <sect1>Запуск<p>

  <img SRC=startup.gif>
  <sect2>Автостарт<p>
    При включенной этой опции KiKbd будет запускаться автоматически
    в начале каждой сессии KDE.
  </sect2>

  <sect2>Docked<p>
    При включенной этой опции KiKbd будет "упрятан" в специальной области
    kpanel.
  </sect2>

  <sect2>Место<p>
    Если вам не нравиться "docked" KiKbd или вы не пользуетесь kpanel,
    KiKbd может разместиться в одном из четырех углов экрана.
  </sect2>

  </sect1>

<sect>Создание новой раскладки<label id="create"><p>

  Все системные раскладки находятся в директории
  <it>$KDEDIR/share/apps/kikbd</it>
  и персональные в
  <it>$HOME/.kde/share/apps/kikbd</it>.
  Индивидуальность раскладки определяется именем файла без расширения
  <it>.kimap</it>. Файл в персональной директории скрывает файл с
  таким же именем в системной директории.

  Для создания новой раскладки стоит взять за основу одну из существующих
  раскладок. Файл раскладки содержит два раздела:

  <enum>
  <item><bf>International Keyboard</bf><newline>
  В этой секции можно определить следующее:
    <itemize>
      <item>Authors - список авторов
        в формате "имя фамилия &lt email адрес&gt",
        авторы в списке разделяются запятыми;
      </item>
      <item>Comment** - дополнительный комментарий;</item>
      <item>Language** - язык для которого предназначена эта раскладка;</item>
      <item>Charset - charset;</item>
      <item>Locale - локализация для которой предназначена эта раскладка;
      </item>
      <item>Label* - метка этой раскладки.</item>
    </itemize>
    * - необходимо<newline>
    ** - может быть представлено в переводе на другие языки
    <p>
  </item>
  <item><bf>KeyboardMap</bf><newline>
  Эта секция описывает соответствие между основными символами клавиатуры и
  двумя, тремя или четырьмя новыми символами по форме:
  <verb>
    keysym<num> = <default sym>,<sym1>,<sym2>,<sym3>,<sym4>,
  </verb>
  и соответсвие кодов символам:
  <verb>
    keycode<num> = <key code>,<sym1>,<sym2>,<sym3>,<sym4>,
  </verb>

  Где <it>num</it> означает любое уникальное число, <it>sym</it> означает
  символ в форме шестнадцатиричного числа или форме которую понимает X,
  <it>key code</it> означает десятичное число, <it>default sym</it>
  означает основной символ или символ до запуска KiKbd.
  Символа <it>sym1, sym2</it> определяют <it>национальные</it> 
  символы
  и <it>sym3, sym4</it> определяют <it>альтернативные</it> символы.
  При описании раскладки предпочтительно использовать описание 
  <it>keysym</it>. 
  <p>
  В дополнение в этой секции можно описать <it>CapsSymbols</it>
  как список символов разделенных запятой используемых при эмуляции Caps Lock.
  </item>
  </enum>

  После создания и тестирования новой раскладки можно отправить ее
  команде разработчиков KDE или напрямую автору.

</sect>

<sect>Проблемы<p>

  <sect1>Не найден символ<p>
    Такое может случиться если ваш Xserver имеет не латинский или 
    какой необычный набор символов.
    Начиная с версии 1.0b1 вы можете пред определить символы при старте
    KiKbd в <ref id="advanced" name="секции Специальное конфигурации">,
    это исправит проблему.
  </sect1>

  <sect1>Хранители экрана<p>
    Может возникнуть проблема набрать пароль латинскими буквами в приглашении
    хранителя экрана (screen saver) если перед его запуском была включена
    не латинская раскладка.

    Первое решение состоит в использовании хранителей экрана из поставки KDE
    и установки английской раскладки в качестве основной. В этом случае
    KiKbd распознает появление окна хранителя экрана и автоматически
    переключиться на основную раскладку.

    Если вы используете стиль ввода <it>Окно</it> или <it>Класс</it>
    KiKbd назначит основную раскладку любому новому окну в том числе
    и окну хранителей экрана не из поставки KDE.

    Другое решение - это использование раскладок с латинскими символами
    в качестве альтернативных (русские раскладки из поставки KiKbd содержат
    латинские символы в качестве альтернативных). Пароль можно набрать
    при нажатом альтернативном переключателе.

  </sect1>

  <sect1>Bugs<p>
  Рапорты по обнаруженным bugs принимаются на
  <htmlurl url="http://buglist.kde.org" 
	name="http://buglist.kde.org">
  </sect1>

</sect>

<sect>Автор<p>

Интернациональная клавиатура написана 
<htmlurl url="mailto:budnik@linserv.jinr.ru" 
	name="Александром Будник">
<p>
</sect>

</article>
