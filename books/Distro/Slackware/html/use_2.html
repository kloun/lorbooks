 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html LANG=ru>
<meta name="GENERATOR" content="TtH 2.89">
<table width="100%"  CELLSPACING="1" CELLPADDING="1" >
<tr>
<td align="left"><a href="use_1.html">Предыдущий</a></td>
<td align="center"><a href="index.html">Содержание</a></td>
<td align="right"><a href="use_3.html">Следующий</a></td>
</table>
<hr />

<p>
 <h2><a name="tth_sEc5.2">
5.2</a>&nbsp;&nbsp;Структура файловой системы</h2><a name="struct">
</a>

<p>
Мы с вами уже обсуждали структуру каталогов в Linux Slackware. Вы умеете искать файлы и каталоги, которые вам нужны. Но файловая система это нечто большее, чем структура каталогов.

<p>
Linux это многопользовательская система. Все элементы системы многопользовательские, даже файловая система. Система хранит информацию о том, кому принадлежит файл и кто может читать его. А так же позволяет использовать ссылки и подключение NFS. В этом разделе наряду с перечисленными аспектами разъясняются аспекты многопользовательской структуры файловой системы.

<p>
     <h3><a name="tth_sEc5.2.1">
5.2.1</a>&nbsp;&nbsp;Права собственности</h3>

<p>
Файловая система хранит информацию о правах собственности для каждого фала и каталога. Включая информацию о пользователе и группе, которым принадлежит файл.Самый простой способ просмотреть эту информацию - воспользоваться <b>ls</b>:

<p>

<table>
<tr><td><tt>$ </tt><b>ls -l /usr/bin/wc</b></td></tr>
<tr><td>-rwxr-xr-x&nbsp;&nbsp;&nbsp;1&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bin&nbsp;&nbsp;&nbsp;&nbsp;7368&nbsp;Jul&nbsp;30&nbsp;&nbsp;1999&nbsp;/usr/bin/wc
</td></tr></table>


<p>
Нас интересуют третий и четвёртый столбцы. Они содержат информацию о именах пользователя и группы, которым принадлежит файл. В приведённом примере файл принадлежит пользователю root и группе bin.

<p>
Владельца файла можно изменить при помощи <b>chown</b>(1) (что значит ''change owner''&nbsp;- изменить владельца), а группу при помощи <b>chgrp</b> (''change group''&nbsp;- изменить группу). Чтобы изменить владельца фала на ''daemon'', мы выполним команду:

<p>

<table>
<tr><td><tt># </tt><b>chown daemon /usr/bin/wc</b>
</td></tr></table>


<p>
А чтобы изменить группу на ''root'':

<p>

<table>
<tr><td><tt># </tt><b>chgrp root /usr/bin/wc</b>
</td></tr></table>


<p>
<b>chown</b> так же может быть использована для задания и пользователя и группы, которым принадлежит файл:

<p>

<table>
<tr><td><tt># </tt><b>chown daemon.root /usr/bin/wc</b>
</td></tr></table>


<p>
Принадлежность фалов&nbsp;- это очень важная часть использования Linux системы, даже если вы единственный пользователь. Иногда вам придётся исправлять права владения файлами и узлами (nodes) устройств.

<p>
     <h3><a name="tth_sEc5.2.2">
5.2.2</a>&nbsp;&nbsp;Права доступа</h3><a name="access">
</a>

<p>
Права доступа&nbsp;- это ещё одно проявление многопользовательских основ файловой системы. С их помощью вы можете указать, кто может читать, изменять и выполнять фалы.

<p>
Права доступа хранятся в виде четырёх восьмеричных чисел, каждое из которых устанавливает права для отдельного блока. Блоки представляют права владельца, права группы и права всего остального мира. Четвёртое восьмеричное число используется для хранения специальной информации, такой как ID владельца, ID группы и ''sticky''бит. Значения этих чисел соответствуют правам доступа (им так же сопоставляются буквы, которые выводятся такими программами, как <b>ls</b> и могут быть использованы программой <b>chmod</b>:

<p>

<p>
<a name="tth_tAb5.1">
</a> <center>Table 5.1: Соответствие восьми-битовых чисел правам</center>

<table>
<tr><td>Тип</td><td>Восьми-битовое </td><td>Буква </td></tr>
<tr><td></td><td>значение </td><td></td></tr>
<tr><td>''sticky'' bit </td><td>1 </td><td>t</td></tr>
<tr><td>set user ID (ID пользователя)</td><td>4 </td><td>s</td></tr>
<tr><td>set group ID (ID группы)   </td><td>2  </td><td>s</td></tr>
<tr><td>read (чтение)        </td><td>4          	</td><td>r</td></tr>
<tr><td>write (запись)       </td><td>2         	</td><td>w</td></tr>
<tr><td>execute (выполнение) </td><td>1          	</td><td>x</td></tr></table>


<p>
Для каждой из групп права складываются. Например, если вы хотите, чтобы права группы были ''read'' и ''write'', вы воспользуетесь ''6'' в части соответствующей группе прав доступа.

<p>
Права по умолчанию для <b>bash</b>:

<p>

<table>
<tr><td><tt>$ </tt><b>ls -l /bin/bash</b></td></tr>
<tr><td>-rwxr-xr-x&nbsp;&nbsp;&nbsp;1&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bin&nbsp;&nbsp;477692&nbsp;Mar&nbsp;21&nbsp;19:57&nbsp;/bin/bash
</td></tr></table>


<p>
Первый дефис для каталогов принимает значение, равное ''d''. Три группы прав (владелец, группа и весь мир) отображаются следующими. Из примера мы видим, что владелец имеет права для чтения, записи и выполнения (rwx). Группа имеет только право на чтение и выполнения файла (r-x). И все остальные имеют только права на чтение и выполнение фала (r-x).

<p>
Как же нам присваивать права файлам? Вначале давайте создадим файл для примеров:

<p>

<table>
<tr><td><tt>$ </tt><b>touch /tmp/example</b></td></tr>
<tr><td><tt>$ </tt><b>ls -l /tmp/example</b></td></tr>
<tr><td>-rw-rw-r-&nbsp;&nbsp;1&nbsp;david&nbsp;&nbsp;&nbsp;&nbsp;users&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;Apr&nbsp;19&nbsp;11:21&nbsp;/tmp/example
</td></tr></table>


<p>
Мы воспользуемся <b>chmod</b>(1) (что означает ''change mode''&nbsp;- изменить режим), для того чтобы установить права доступа для файла примера. Сложите восьмизначные числа, для прав, которые вы хотите. Для того, чтобы владелец имел права чтения, записи и выполнения, получится 7. Чтение и выполнение соответствует числу 5. Установим права:

<p>

<table>
<tr><td><tt>$ </tt><b>chmod 755 /tmp/example</b></td></tr>
<tr><td><tt>$ </tt><b>ls -l /tmp/example</b></td></tr>
<tr><td>-rwxr-xr-x&nbsp;&nbsp;&nbsp;1&nbsp;david&nbsp;&nbsp;&nbsp;&nbsp;users&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;Apr&nbsp;19&nbsp;11:21&nbsp;/tmp/example
</td></tr></table>


<p>
Для задания специальных прав, сложите числа вместе, и расположите их в первом столбце:

<p>

<table>
<tr><td><tt>$ </tt><b>chmod 6755 /tmp/example</b></td></tr>
<tr><td><tt>$ </tt><b>ls -l /tmp/example</b></td></tr>
<tr><td>-rwsr-sr-x&nbsp;&nbsp;&nbsp;1&nbsp;david&nbsp;&nbsp;&nbsp;&nbsp;users&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;Apr&nbsp;19&nbsp;11:21&nbsp;/tmp/example
</td></tr></table>


<p>
Если вас смущают восьми-битовые числа, вы можете пользоваться буквами. Группы прав представляются, как:

<p>

<table>
<tr><td>Владелец              </td><td>u</td></tr>
<tr><td>Группа                </td><td>g</td></tr>
<tr><td>Мир                   </td><td>o</td></tr>
<tr><td>Все вышеперечисленные </td><td>a</td></tr></table>


<p>
Чтобы проделать то же, что и выше, нам понадобится выполнить команду несколько раз:

<p>

<table>
<tr><td><tt>$ </tt><b>chmod a+rx /tmp/example</b></td></tr>
<tr><td><tt>$ </tt><b>chmod u+w /tmp/example</b></td></tr>
<tr><td><tt>$ </tt><b>chmod ug+s /tmp/example</b></td></tr></table>


<p>
Некоторые предпочитают работать с буквами. Но в любом случае, результат&nbsp;- это тот же самый набор прав доступа.

<p>
Мы несколько раз упоминали упоминали права ''set user ID'' (установить ID пользователя) и ''set group ID'' (установить ID группы). Возможно, вы мучаетесь в догадках, что же это такое. Обычно, когда вы выполняете программу, она имеет все те же самые права, что и вы имеете, как пользователь. То же справедливо и для группы. Когда вы запускаете программу, она выполняется с правами вашей текущей группы. При помощи ''set user ID'' вы можете заставить программу всегда выполнятся с правами её владельца (например ''root''). ''Set group ID'' работает так же, но для группы.

<p>
Будьте осторожны здесь, так как set user ID и set group ID могут открыть ''дыры '' в безопасности вашей системы. Если вы установите эти права на файл, принадлежащий root-у, вы позволяете всем запускать эту программу, и выполнять её, как root. Так как у пользователя root нет ограничений в системе, это ставит под вопрос целостность основной безопасности системы. Короче, пользоваться этими командами не плохо, но здравый смысл должен присутствовать.

<p>
     <h3><a name="tth_sEc5.2.3">
5.2.3</a>&nbsp;&nbsp;Ссылки</h3><a name="links">
</a>

<p>
Ссылки это указатели на файлы. При помощи ссылок вы можете создавать файлы, существующие в нескольких местах, и доступные под многими именами. Есть два типа ссылок: жёсткие и символические.

<p>
Жёсткие ссылки это просто разные имена для одного и того же файла. Они могут существовать только в одном и том же каталоге и удаляются тогда, когда исходный файл удаляется. В некоторых случаях они бывают полезны, но большинство пользователей находит символьные ссылки более удобными.

<p>
Символьные ссылки (или так же мягкие) могут указывать на файл, находящийся вне текущего каталога. Фактически, это маленький файл, содержащий необходимую информацию. Вы можете добавлять и удалять символьные ссылки не влияя на исходный файл.

<p>
У ссылок нет их собственных прав доступа и принадлежности. Вместо этого они отражают права файла, на который они указывают. Slackware, в основном использует символьные ссылки.  Вот обычный пример:

<p>

<table>
<tr><td><tt>$ </tt><b>ls -l /bin/sh</b></td></tr>
<tr><td>lrwxrwxrwx&nbsp;&nbsp;&nbsp;1&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;Apr&nbsp;&nbsp;6&nbsp;12:34&nbsp;/bin/sh&nbsp;-&#62;&nbsp;bash
</td></tr></table>


<p>
Оболочка <b>sh</b> в Slackware, на самом деле, <b>bash</b>. Ссылки удаляются при помощи <b>rm</b>. А для их создания используется команда <b>ln</b>. Эти команды будут обсуждены более подробно в разделе&nbsp;<a href="use_3.html#file">5.3</a>.

<p>
     <h3><a name="tth_sEc5.2.4">
5.2.4</a>&nbsp;&nbsp;Монтирование (подключение) устройств</h3>

<p>
Как обсуждалось ранее в разделе ''Структура файловой системы'', все диски и устройства в вашем компьютере являются одной большой файловой системой. Различные разделы жёсткого диска, CD-ROMы, и дисководы, все расположены в одном и том же дереве каталогов. Для подключения всех этих устройств к файловой системе, вам надо использовать <b>mount</b> и <b>umount</b> команды.

<p>
Некоторые устройства автоматически подключаются при загрузке компьютера. Они перечислены в файле <tt>/etc/fstab</tt>. Всё, что вы хотите подключать автоматически, должно иметь строчку в этом файле. Для других устройств, вам придётся указывать команду каждый раз, когда вы хотите воспользоваться ими.

<p>

<h4><tt>fstab</tt></h4>
Давайте рассмотрим пример файла <tt>/etc/fstab</tt>:

<p>

<table>
<tr><td>/dev/sda1&nbsp;&nbsp;&nbsp;&nbsp;  </td><td>/             </td><td>ext2      </td><td>defaults       </td><td>1&nbsp;&nbsp;1</td></tr>
<tr><td>/dev/sda2      </td><td>/usr/local&nbsp;&nbsp;  </td><td>ext2      </td><td>defaults       </td><td>1&nbsp;&nbsp;1</td></tr>
<tr><td>/dev/sda4      </td><td>/home         </td><td>ext2      </td><td>defaults       </td><td>1&nbsp;&nbsp;1</td></tr>
<tr><td>/dev/sdb1      </td><td>swap          </td><td>swap      </td><td>defaults       </td><td>0&nbsp;&nbsp;0</td></tr>
<tr><td>/dev/sdb3      </td><td>/export       </td><td>ext2      </td><td>defaults       </td><td>1&nbsp;&nbsp;1</td></tr>
<tr><td>none           </td><td>/dev/pts      </td><td>devpts    </td><td>gid=5,mode=620&nbsp;&nbsp;</td><td>0&nbsp;&nbsp;0</td></tr>
<tr><td>none           </td><td>/proc         </td><td>proc      </td><td>defaults       </td><td>0&nbsp;&nbsp;0</td></tr>
<tr><td>/dev/fd0       </td><td>/mnt          </td><td>ext2      </td><td>defaults       </td><td>0&nbsp;&nbsp;0</td></tr>
<tr><td>/dev/cdrom     </td><td>/cdrom        </td><td>iso9660&nbsp;&nbsp; </td><td>ro             </td><td>0&nbsp;&nbsp;0</td></tr></table>


<p>
В первом столбце указанно имя устройства. В этом случае устройства, это пять разделов, разбросанных по двум SCSI жёстким дискам, два специальных файловых системы, которым не  нужны файловые системы, флоппи дисковод и CD-ROM дисковод. Второй столбец указывает куда подключать устройство. Это должен быть существующий каталог, за исключением раздела подкачки. Третий столбец указывает тип файловой системы для устройства. Для обычного Linux раздела это будет <b>ext2</b> (''second extended filesystem''&nbsp;- вторая расширенная файловая система). Для CD-ROM это будет <b>iso9660</b>, а для Windows разделов это может быть, как <b>msdos</b>, так и <b>vfat</b>.

<p>
Четвёртый столбец перечисляет опции, которые используются при монтировании устройств. Почти всегда ''defaults'' вполне достаточно<a href="footnotes.html#tthFtNtACE" name="tthFrefACE"><sup>24</sup></a>. Тем не менее, устройствам, доступным только для чтения рекомендуется указывать параметр <b>ro</b>. Существует огромное количество различных опций. Смотрите man страницу <tt>fstab</tt>(5) для получения дополнительной информации. Последние два столбца используются программой <b>fsck</b> и другими командами для манипулирования дисками. Так же обращайтесь к man странице для получения разъяснений.

<p>
При установке Slackware Linux, программа установки генерирует минимальный <tt>fstab</tt> файл. Вам понадобится изменить этот файл только если вы хотите добавить диски, или захотите, чтобы устройства автоматически монтировались при загрузке.

<p>

<h4><b>mount</b> и <b>umount</b></h4>

<p>
В Linux очень просто подключать устройства. Всё что вам надо сделать, это запустить <b>mount</b> команду, указывай ей несколько опций. Использование этой команды может быть значительно упрощено, если монтируемое устройство описано в <tt>/etc/fstab</tt> файле. Предположим, я хочу подключить CD-ROM и <tt>fstab</tt> выглядит так, как в примере предыдущего раздела. Я могу сделать это, выполнив команду:

<p>

<table>
<tr><td><tt># </tt><b>mount /cdrom</b>
</td></tr></table>


<p>
Так как в <tt>fstab</tt> есть строчка для этого устройства, <b>mount</b> возьмёт все опции оттуда. Если бы для этого устройства не было описания в <b>fstab</b>, то пришлось бы задавать все опции вручную:

<p>

<table>
<tr><td><tt># </tt><b>mount -t iso9660 -o ro /dev/cdrom /cdrom</b>
</td></tr></table>


<p>
Эта строка включает ту же самую информацию, что и строка в вышеприведённом <tt>fstab</tt>, но в другом формате. Давайте разберёмся. <b>-t iso9660</b> указывает тип файловой системы на устройстве. В этом случае это <b>iso9660</b> система, которая используется на большинстве CD-ROM. <b>-o ro</b> указывает, что устройство подключается только для чтения. <b>/dev/cdrom</b> это имя устройства, которое мы хотим подключить и <b>/cdrom</b> это каталог, куда мы хотим подключить устройство.

<p>
До того, как извлекать флоппи, CD-ROM, или другое извлекаемое устройство, которое в данный момент подмонтированно, вам надо размонтировать его. Для того, чтобы сделать это, нужно воспользоваться командой <b>umount</b>. Не спрашивайте, почему она называется не <b>unmount</b>, так как мы не сможем вам ответить. Вы можете использовать либо имя устройства, либо точку монтирования в качестве аргумента для команды. Например, если вы хотите размонтировать CD-ROM, подключённый в предыдущем примере, любая из нижеприведённых команд позволит вам сделать это:

<p>

<table>
<tr><td><tt># </tt><b>umount /dev/cdrom</b></td></tr>
<tr><td><tt># </tt><b>umount /cdrom</b>
</td></tr></table>


<p>
     <h3><a name="tth_sEc5.2.5">
5.2.5</a>&nbsp;&nbsp;Монтирование NFS</h3>

<p>
NFS, как мы уже упоминали, это сокращение для Network Filesystem (Сетевая файловая система. На самом деле она не является частью реальной файловой системы, но может быть использована для подключения устройств через сеть.

<p>
Зачастую в больших Unix сетях возникает необходимость разделять многие программы, домашние каталоги, и почтовые очереди. Проблема предоставления идентичных копий файлов различным компьютерам разрешается при помощи NFS. Можно использовать NFS для разделения одного набора домашних каталогов между всеми рабочими станциями. В таком случае, рабочие станции монтируют этот разделяемый каталог и используют его, как если бы он был размещён локально.

<p>
Смотрите раздел&nbsp;<a href="conf_2.html#NFS">4.2.6</a> и man страницы для <tt>exports</tt>(5), <b>nfsd</b>(5) и <b>mountd</b> для дополнительной информации.

<p>
     <h3><a name="tth_sEc5.2.6">
5.2.6</a>&nbsp;&nbsp;Итог</h3>
В этом разделе вы должны были приобрести знания о правах владения и доступа. Вы должны понимать, для чего это нужно, и как их устанавливать. Так же вы должны иметь представление о ссылках и уметь монтировать устройства. Это основные необходимые знания по файловой системе.

<hr />
<table width="100%"  CELLSPACING="1" CELLPADDING="1" >
<tr>
<td align="left"><a href="use_1.html">Предыдущий</a></td>
<td align="center"><a href="index.html">Содержание</a></td>
<td align="right"><a href="use_3.html">Следующий</a></td>
</table>
<hr /><small>File translated from
T<sub><font size="-1">E</font></sub>X
by <a href="http://hutchinson.belmont.ma.us/tth/">
T<sub><font size="-1">T</font></sub>H</a>,
version 2.89.<br />On 24 Apr 2001, 16:43.</small>
</html>