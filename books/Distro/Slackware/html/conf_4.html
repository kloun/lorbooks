 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html LANG=ru>
<meta name="GENERATOR" content="TtH 2.89">
<table width="100%"  CELLSPACING="1" CELLPADDING="1" >
<tr>
<td align="left"><a href="conf_3.html">Предыдущий</a></td>
<td align="center"><a href="index.html">Содержание</a></td>
<td align="right"><a href="use_1.html">Следующий</a></td>
</table>
<hr />
<p>
 <h2><a name="tth_sEc4.4">
4.4</a>&nbsp;&nbsp;Загрузка</h2><a name="boot">
</a>

<p>
Настройка загрузчика системы Linux может быть как простой, так и сложной.  Многие из пользователей устанавливают только Slackware на свой компьютер.  Они просто включают компьютер и он готов к использованию. А некоторым из пользователей, необходимо так же загружать и другие операционные системы для выполнения определённых задач, в связи с чем им необходимо, чтобы обе системы сосуществовали на компьютере.

<p>
В этом разделе описывается использование LILO и Loadlin&nbsp;- двух загрузчиков, поставляемых в Slackware. Здесь так же будут описаны типичные варианты ''двойной'' загрузки и приведены примеры по её настройке.

<p>
     <h3><a name="tth_sEc4.4.1">
4.4.1</a>&nbsp;&nbsp;LILO</h3><a name="lilo">
</a>

<p>
Linux Loader (Загрузчик Linux), или LILO, является наиболее популярным загрузчиком, используемым в системе Linux. Он достаточно гибок в настройках и может быть использован для загрузки других операционных систем.

<p>
Slackware Linux поставляется с меню управляемой программой для настройки LILO, называемой <b>liloconfig</b>. Первый раз эта программа запускается в процессе установки системы, но вы можете вызвать её и после установки, напечатав <b>liloconfig</b> в командной строке.

<p>
LILO читает свои параметры настройки из файла <tt>/etc/lilo.conf</tt>(5). Этот файл не используется при каждой загрузке системы, но используется при каждой установке LILO. LILO должен быть пере установлен в загрузочный сектор после изменения его настроек. <b>liloconfig</b> поможет вам построить конфигурационный файл. Если вы предпочитаете редактировать <tt>/etc/lilo.conf</tt> вручную, то пере установка LILO должна быть произведена путём вызова <b>/sbin/lilo</b> из командной строки.

<p>
При вызове <b>liloconfig</b> вы увидите такой экран:

<p>
<br /><table align="left" border="1"><tr><td width="0" align="center">
<a href="../gifs/liloconfig.first.gif">Figure</a></td></tr></table><!--hbox-->

<p>
Если вы устанавливаете LILO впервые, то вам лучше выбрать ''simple''.  В другом случае, вы найдёте, что режим ''expert'' быстрее, если вы знакомы с Linux и LILO. Выбор ''simple'' начнёт настройку LILO.

<p>
Если поддержка framebuffer-а включена в ядро, <b>liloconfig</b> спросит вас, какое видео разрешение вы хотите использовать. Это же разрешение будет использовано для XFree86 frame buffer сервера. Если вы не хотите запускать консоль в специфическом видео разрешении, то выбор normal сохранит стандартный 80x25 текстовый режим.

<p>
<br /><table align="left" border="1"><tr><td width="0" align="center">
<a href="../gifs/liloconfig.framebuffer.gif">Figure</a></td></tr></table><!--hbox-->

<p>
Следующая часть настройки LILO&nbsp;- это выбор места, куда вы его установите. Это, вероятно, самый важный шаг. Список, приведённый ниже объясняет подробности выбора.

<p>

<dl compact="compact"><dt><b>Root</b></dt>
	<dd>
     Этот вариант установки расположит LILO в начале вашего корневого каталога. Это наиболее безопасный выбор в случае, если у вас на компьютере есть другая операционная система. В этом случае вы можете быть уверены, что любые другие загрузчики не будут стёрты. Недостаток в том, что LILO может быть загружен отсюда только в случае, если ваш Linux диск является первым в вашей системе.<dt><b>Floppy</b></dt>
	<dd>
     Этот вариант ещё более безопасен, чем предыдущий. Он создаст загрузочную дискетку, которую вы сможете использовать для загрузки вашей Linux системы. Загрузчик вообще не располагается на жёстком диске, и когда вы хотите пользоваться Slackware Linux, вы загружаетесь с этой дискеты.<dt><b>MBR</b></dt>
	<dd>
     Этот метод рекомендуется в том случае, если Slackware единственная система на вашем компьютере, или если вы решили воспользоваться LILO для загрузки так же и остальных систем на вашем компьютере.
<tt>ВНИМАНИЕ: Этот вариант перепишет любой другой загрузчик, находящийся в MBR</tt></dl>

<p>
После выбора места для расположения загрузчика, <b>liloconfig</b> запишет конфигурационный файл и установит LILO. Вот и всё. Если вы выберите вариант установки ''expert'', вы получите особое меню. Пункты в этом меню позволят вам пройтись по файлу <tt>/etc/lilo.conf</tt>, добавить другие операционные системы в ваше загрузочное меню, и указать LILO передать особые параметры ядру во время загрузки. Меню ''expert'' выглядит следующим образом:

<p>
<br /><table align="left" border="1"><tr><td width="0" align="center">
<a href="../gifs/liloconfig.expert.gif">Figure</a></td></tr></table><!--hbox-->

<p>
Какой бы не была конфигурация системы, установка загрузчика довольно проста. <b>liloconfig</b> заметно упрощает процесс установки. Тем не менее, возможны варианты, когда LILO просто не будет работать. Но LILO это не единственный способ загрузки Linux.

<p>
     <h3><a name="tth_sEc4.4.2">
4.4.2</a>&nbsp;&nbsp;LOADLIN</h3>

<p>
Второй способ загрузки системы, предоставляемый в Slackware это LOADLIN. LOADLIN представляет собой DOS выполняемый файл, который может быть использован для загрузки Linux из работающей DOS системы. Для работы программы необходимо, чтобы ядро Linux находилось на DOS разделе, чтобы LOADLIN мог загрузить его и запустить систему.

<p>
При установке системы, LOADLIN устанавливается в домашний каталог root пользователя, как .ZIP файл. Для LOADLIN нет автоматической процедуры установки. Вам необходимо будет скопировать ядро Linux (<tt>/vmlinuz</tt>) и LOADLIN файл из домашнего каталога root-а на DOS раздел.

<p>
LOADLIN полезен, если вы хотите сделать загрузочное меню в DOS разделе. Меню может быть добавлено в <tt>AUTOEXEC.BAT</tt> файл, что позволит выбирать, какую из систем (DOS или Linux) загружать при включении компьютера. Если вы выберите Linux, меню вызовет LOADLIN, для запуска Slackware. Ниже приведён пример <tt>AUTOEXEC.BAT</tt> файла для Windows 95, с меню выбора системы:

<p>

<table>
<tr><td>@ECHO OFF</td></tr>
<tr><td>SET PROMPT=$P$G</td></tr>
<tr><td>SET PATH=C:\WINDOWS;C:\WINDOWS\COMMAND;C:\</td></tr>
<tr><td>CLS</td></tr>
<tr><td>ECHO Please Select Your Operating System:</td></tr>
<tr><td>ECHO.</td></tr>
<tr><td>ECHO [1] Slackware Linux</td></tr>
<tr><td>ECHO [2] Windows 95</td></tr>
<tr><td>ECHO.</td></tr>
<tr><td>CHOICE /C:12 "Selection? -&#62; "</td></tr>
<tr><td>IF ERRORLEVEL 2 GOTO WIN</td></tr>
<tr><td>IF ERRORLEVEL 1 GOTO LINUX</td></tr>
<tr><td>:WIN</td></tr>
<tr><td>CLS</td></tr>
<tr><td>ECHO Starting Windows 95...</td></tr>
<tr><td>WIN</td></tr>
<tr><td>GOTO END</td></tr>
<tr><td>:LINUX</td></tr>
<tr><td>ECHO Starting Slackware Linux...</td></tr>
<tr><td>CD \LINUX</td></tr>
<tr><td>LOADLIN C:\LINUX\VMLINUZ ROOT=&lt;root partition device&#62; RO</td></tr>
<tr><td>GOTO END</td></tr>
<tr><td>:END
</td></tr></table>


<p>
Вам необходимо будет указать имя устройства вашего корневого раздела. Что-то вроде <tt>/dev/hda2</tt>. Вы так же всегда можете воспользоваться <b>LOADLIN</b> из командной строки. Вам надо указать параметры программе, по аналогии с приведенным выше примером. Документация LOADLIN предлагает вам много различных примеров использования программы.

<p>
     <h3><a name="tth_sEc4.4.3">
4.4.3</a>&nbsp;&nbsp;Двойная загрузка</h3><a name="dblboot">
</a>

<p>
Многие пользователи настраивают свои компьютеры для загрузки Slackware Linux и ещё какой-то другой операционной системы. Ниже описаны несколько типичных сценариев двойной загрузки.

<p>

<h4>Windows 9x/DOS</h4>

<p>
Настройка компьютера для загрузки, как Windows 9x, так и Linux, вероятно наиболее часто встречающийся сценарий двойной загрузки. Есть много способов реализации такой загрузки. Ниже будут приведены два из возможных вариантов.

<p>
Часто при настройке двойной загрузки системы составляется замечательный план того, как всё должно происходить, но в процессе настройки ошибаются порядком. Очень важно понимать, что операционные системы должны быть установлены в определённом порядке, для того чтобы двойная загрузка работала.  Linux предоставляет больше  контроля над управлением содержимого MBR.  В связи с этим настоятельно рекомендуется устанавливать Linux в последнюю очередь. Вначале должна быть установлена Windows, так как она всегда переписывает MBR своим загрузчиком в процессе установки.

<p>

<b>Использование LILO&nbsp;&nbsp;</b>
Большинство пользователей предпочитают использовать LILO для выбора системы в процессе загрузки. Как и предложено выше, Windows должен быть установлен первым.

<p>
Предположим, что у вас есть единственный 47GB IDE жёсткий диск в системе.  Так же мы предположим, что вы хотите использовать половину диска для Windows, и половину для Linux. В этом случае появляется проблема с загрузкой Linux. Я не знаю, какая будет геометрия у такого диска, но скорее всего, после 23.5GB вы выйдете за предел в 1024-ого цилиндра. Лучшее расположение разделов для такой системы предложено ниже:

<p>

<table>
<tr><td>1GB  </td><td>Windows boot </td><td>(C:)</td></tr>
<tr><td>1GB  </td><td>Linux root   </td><td>(/)</td></tr>
<tr><td>22.5 </td><td>Windows misc </td><td>(D:)</td></tr>
<tr><td>22.5 </td><td>Linux /usr   </td><td>(/usr)
</td></tr></table>


<p>
Не забудьте так же, что вам понадобится пространство для раздела подкачки Linux. Неписанное правило гласит, что размер раздела подкачки должен в 2 раза превышать объём оперативной памяти вашей системы. Для машины с 64Мб памяти нужен раздел подкачки в 128Мб и т.д.

<p>
После разметки диска, вам следует установить Windows. После того, как он установлен и работает, вам следует установить Linux. Установка LILO потребует дополнительного внимания. Вам надо будет выбрать ''expert'' вариант установки LILO.

<p>
Начните новую настройку LILO. Вам надо выбрать вариант установки в MBR, чтобы вы могли использовать LILO для выбора операционной системы. Затем из меню добавьте ваш Linux раздел и затем ваш Windows или DOS раздел. После того, как это сделано, выберите ''install LILO''

<p>
Пере загрузите компьютер. LILO должен загрузиться и ждать реакции пользователя. Вы можете нажать <b>Alt</b> для получения приглашения boot:. Введите имя системы, которую вы желаете загрузить (эти имена были выбраны при установке LILO). Если вы не помните, какие имена указали, то нажмите <b>Tab</b> для получения списка доступных для загрузки ОС.

<p>
Вы можете настроить LILO более детально, путём редактирования <tt>/etc/lilo.conf</tt> файла. Вы можете настроить его таким образом, чтобы при загрузке выводилось текстовое меню, и чтобы всегда выводилось приглашение. Например, если я хочу, чтобы LILO выводил на экран такое приглашение:

<p>

<table>
<tr><td>System Boot Menu</td></tr>
<tr><td>================</td></tr>
<tr><td>1 - Linux</td></tr>
<tr><td>2 - Windows</td></tr>
<tr><td></td></tr>
<tr><td>LILO boot:</td></tr></table>


<p>
То мой <tt>/etc/lilo.conf</tt> будет выглядеть следующим образом:

<p>

<table>
<tr><td># LILO configuration file</td></tr>
<tr><td>boot = /dev/hda</td></tr>
<tr><td>vga = normal</td></tr>
<tr><td>message = /boot/message</td></tr>
<tr><td>image = /vmlinuz</td></tr>
<tr><td>root = /dev/hda2</td></tr>
<tr><td>label = 1</td></tr>
<tr><td>read-only</td></tr>
<tr><td></td></tr>
<tr><td>other = /dev/hda1</td></tr>
<tr><td>label = 2</td></tr>
<tr><td>table = /dev/hda</td></tr></table>


<p>
А мой <tt>/boot/message</tt> файл будет выглядеть вот так:

<p>

<table>
<tr><td>System Boot Menu</td></tr>
<tr><td>================</td></tr>
<tr><td>1 - Linux</td></tr>
<tr><td>2 - Windows</td></tr></table>


<p>
LILO очень гибкий в настройках системный загрузчик. Он не ограничен загрузкой только Linux или DOS. Он может загрузить практически любую систему. Обратитесь к man страницам для <b>lilo</b>(8) и <tt>lilo.conf</tt>(5) для получения более подробной информации.

<p>
А что делать, если LILO не работает? Существуют определённые конфигурации, при которых LILO просто не будет работать на определённом компьютере. Но к счастью есть и другие способы реализации двойной загрузки Linux и Windows.

<p>

<b>Использование LOADLIN&nbsp;&nbsp;</b>

<p>
Этот способ может быть использован в случае, если LILO не работает в вашей системе или просто, если вы не хотите устанавливать LILO.  Этот способ идеален для тех пользователей, которые часто пере устанавливают Windows. При каждой установке Windows, он перепишет MBR, и таким образом уничтожит LILO оттуда. С LOADLIN вы избежите этой проблемы. Большой недостаток в том, что вы можете использовать LOADLIN только для загрузки Linux.

<p>
При использовании LOADLIN вы можете установить системы в любом желаемом порядке. При установке Linux будьте внимательны и не перепишите MBR. Лучше всего, просто пропустите установку LILO.

<p>
После установки операционных систем, скопируйте файл <tt>loadlinX.zip</tt> (где ''X''&nbsp;- номер версии, например ''16a'') из домашнего каталога root пользователя на ваш Windows раздел. Так же скопируйте туда образ вашего ядра. Вам надо проделать это из Linux. Вот пример того, как проделать это:

<p>

<table>
<tr><td><tt># </tt><b>mkdir /win</b></td></tr>
<tr><td><tt># </tt><b>mount -t vfat /dev/hda1 /win</b></td></tr>
<tr><td><tt># </tt><b>mkdir /win/linux</b></td></tr>
<tr><td><tt># </tt><b>cd /root</b></td></tr>
<tr><td><tt># </tt><b>cp loadlin* /win/linux</b></td></tr>
<tr><td><tt># </tt><b>cp /vmlinuz /win/linux</b></td></tr>
<tr><td><tt># </tt><b>cd /win/linuz</b></td></tr>
<tr><td><tt># </tt><b>unzip loadlin16a.zip</b></td></tr></table>


<p>
Это создаст каталог <tt>C:\LINUX</tt> на вашем Windows разделе (мы предположили выше, что это <tt>/dev/hda1</tt>) и создаст там копии файлов, необходимых для LOADLIN. Затем вам следует пере-загрузиться в Windows для создания загрузочного меню.

<p>
После загрузки Windows, войдите в командную строку DOS. Нам необходимо убедиться в том, что система настроена так, чтобы не загружать графический интерфейс при включении.

<p>

<table>
<tr><td><tt>C:\&#62; </tt><b>cd \</b></td></tr>
<tr><td><tt>C:\&#62; </tt><b>cattrib -r -a -s -h MSDOS.SYS</b></td></tr>
<tr><td><tt>C:\&#62; </tt><b>cedit MSDOS.SYS</b>
</td></tr></table>


<p>
Добавьте туда такую строчку:

<p>

<table>
<tr><td>BootGUI=0
</td></tr></table>


<p>
Сохраните файл и выйдите из редактора. Теперь надо добавить меню в <tt>C:\AUTOEXEC.BAT</tt>. Ниже приведён пример такого блока в <tt>AUTOEXEC.BAT</tt>:

<p>

<table>
<tr><td>cls</td></tr>
<tr><td>echo System Boot Menu</td></tr>
<tr><td>echo.</td></tr>
<tr><td>echo 1 - Linux</td></tr>
<tr><td>echo 2 - Windows</td></tr>
<tr><td>echo.</td></tr>
<tr><td>choice /c:12 ''Selection? -&#62; ''</td></tr>
<tr><td>if errorlevel 2 goto WIN</td></tr>
<tr><td>if errorlevel 1 goto LINUX</td></tr>
<tr><td>:LINUX</td></tr>
<tr><td>cls</td></tr>
<tr><td>echo ''Starting Linux...''</td></tr>
<tr><td>cd \linux</td></tr>
<tr><td>loadlin c:\linux\vmlinuz root=/dev/hda2 ro</td></tr>
<tr><td>goto END</td></tr>
<tr><td>:WIN</td></tr>
<tr><td>cls</td></tr>
<tr><td>echo ''Starting Windows...''</td></tr>
<tr><td>win</td></tr>
<tr><td>goto END</td></tr>
<tr><td>:END</td></tr></table>


<p>
Ключевая строчка здесь та, что загружает LOADLIN. Мы сообщили ей, какое ядро загружать, где находиться корневой каталог Linux, и что мы хотим, чтобы он был подключён только для чтения на начальном этапе загрузки.

<p>
Все инструменты, необходимые для обоих этих методов поставляются с Slackware Linux. На рынке существует огромное количество загрузчиков, но этих инструментов должно быть достаточно практически для любого варианта двойной загрузки.

<p>

<h4>Windows NT</h4>

<p>
Это второй из наиболее распространённых вариантов двойной загрузки.  С Windows NT возникает несколько дополнительных проблем, по сравнению с Windows 9x. Самая основная в том, что если LILO записать в MBR, то Windows NT не сможет загрузиться. Поэтому приходится использовать загрузчик, поставляемый с Windows NT. Ниже приведён список необходимых шагов по настройке Windows NT и Linux для двойной загрузки.

<p>

<ol type="1"><p>
<li> Установите Windows NT</li>
<p>
<li> Установите Linux, расположив LILO в суперблок Linux раздела</li>
<p>
<li> Прочтите первые 512 байт корневого раздела Linux и запишите их на Windows NT раздел.</li>
<p>
<li> Отредактируйте <tt>C:\BOOT.INI</tt> из Windows NT, добавив опцию загрузки Linux</li>
</ol>

<p>
Установка Windows NT должна быть довольно проста, как и установка Linux. Затем начинаются небольшие трюки. Получение первых 512-ти байтов вашего Linux раздела на самом деле не так сложно, как звучит. Для этого вам надо находиться в Linux. Предположив, что ваш Linux раздел это <tt>/dev/hda2</tt>, мы выполним команду:

<p>

<table>
<tr><td><tt># </tt><b>dd if=/dev/hda2 of=/tmp/bootsect.lnx bs=1 count=512</b>
</td></tr></table>


<p>
Ну вот и готово. Теперь надо скопировать <tt>bootsect.lnx</tt> в ваш Windows NT раздел. Вот вам ещё одна проблема. Linux не содержит стабильной поддержки записи для файловой системы NTFS. Если при установке Windows NT вы отформатировали её раздел, как NTFS, то вам понадобится скопировать этот файл на FAT дискету, а затем в Windows NT прочесть его. Если же вы разметили диск Windows NT, как FAT, то вы можете просто смонтировать этот диск в Linux и скопировать файл на него. В любом случае, вам надо скопировать файл <tt>/tmp/bootesct.lnx</tt> с Linux диска в <tt>C:\BOOTSECT.LNX</tt> на Windows NT диске.

<p>
Последний шаг&nbsp;- добавление пункта в загрузочное меню Windows NT. Из Windows NT откройте режим командной строки.

<p>

<table>
<tr><td><tt>C:\WINNT&#62; </tt><b>cd \</b></td></tr>
<tr><td><tt>С:\&#62; </tt><b>attrib -r -a -s -h boot.ini</b></td></tr>
<tr><td><tt>C:\&#62; </tt><b>edit boot.ini</b></td></tr></table>


<p>
Добавьте такую строчку в конец файла:

<p>

<table>
<tr><td>C:\bootsect.lnx=''Slackware Linux''
</td></tr></table>


<p>
Сохраните изменения и выйдите из редактора. После пере загрузки Windows NT в загрузочном меню появится пункт ''Slackware Linux''. Если вы выберете его, то загрузиться Linux.

<p>

<h4>Linux</h4>

<p>
Это определённо, самый простой сценарий двойной загрузки. Используя LILO, просто добавьте ещё пункт в <tt>/etc/lilo.conf</tt> файл. Вот и всё.

<p>
     <h3><a name="tth_sEc4.4.4">
4.4.4</a>&nbsp;&nbsp;Итог</h3>

<p>
В этом разделе были обсуждены различные варианты загрузки системы. Использование LILO и Loadlin. Была обсуждена загрузка Linux в паре с другой операционной системой. Вы должны были усвоить, как настроить систему для загрузки, как только Linux, так и варианты двойной загрузки с системой, которую вы выберите.

<hr />
<table width="100%"  CELLSPACING="1" CELLPADDING="1" >
<tr>
<td align="left"><a href="conf_3.html">Предыдущий</a></td>
<td align="center"><a href="index.html">Содержание</a></td>
<td align="right"><a href="use_1.html">Следующий</a></td>
</table>
<hr /><small>File translated from
T<sub><font size="-1">E</font></sub>X
by <a href="http://hutchinson.belmont.ma.us/tth/">
T<sub><font size="-1">T</font></sub>H</a>,
version 2.89.<br />On 24 Apr 2001, 16:43.</small>
</html>