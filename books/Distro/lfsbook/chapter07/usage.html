<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><title>Как взаимодействует процесс загрузки со скриптами?</title><meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.73" /=""><link rel="HOME" title="Linux From Scratch" href="../index.html" /=""><link rel="UP" title="Setting up system boot scripts" href="../chapter07/chapter07.html" /=""><link rel="PREVIOUS" title="Introduction" href="../chapter07/introduction.html" /=""><link rel="NEXT" title="Configuring the setclock script" href="../chapter07/setclock.html" /=""></head><body class="sect1" bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#840084" alink="#006000"><div class="NAVHEADER"><table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0"><tbody><tr><th colspan="3" align="Center">Linux From Scratch: Версия 4.0</th></tr><tr><td width="10%" align="Left" valign="Bottom"><a href="introduction.html" accesskey="P">Назад</a></td><td width="80%" align="Center" valign="Bottom">Глава 7. Конфигурация загрузочных скриптов.</td><td width="10%" align="Right" valign="Bottom"><a href="setclock.html" accesskey="N">Вперед</a></td></tr></tbody></table><hr align="Left" width="100%" /=""></div><div class="sect1"><h1 class="sect1"><a name="ch07-usage">Как взаимодействует процесс загрузки со скриптами?</a></h1><p>LINUX использует специальную возможность загрузки именуемой SysVinit
Она основана на концепции 
<em>runlevels</em>. Они могут различаться от системы к системе, но это будет работать в дистрибутиве
&lt;вставьте его имя здесь&gt; и в системах типа LFS. LFS имеет собственный путь в
конфигурации, но мы уважаем стандарты.
</p><p>SysVinit (мы называем <em>init</em> с этого места) работает используя схему runlevels. Всего их 7 (от 0 до 6).
Может быть и более чем 7, но они создаются в отдельных случаях и в обыных системах
 не работают. Страница man для init описыват такие случаи. Каждый из уровней runlevels
 соответствует необходимам вещам, которые компьютер должен выполнить при загрузке этого уровня (runlevels).
 По умолчанию используется уровень 3 (runlevels). Далее приводится описание кажого уровня (runlevels) и небольшое описание:</p><p class="literallayout">0: halt the computer - выключить копмьютер<br /="">
1: single-user mode - однопользовательский режим<br /="">
2: multi-user mode without networking - многопользовательский режим без сети<br /="">
3: multi-user mode with networking - многопользовательский режим с сетевыми установками<br /="">
4: зарезервирован для создания, своего иначе используется так, как 3<br /="">
5: Так-же как 4, только с использованием GUI входа в систему (например X'ы xdm или KDE's kdm)<br /="">
6: перезагрузка компьютера</p><p>Комманда для изменения runlevels - 
<tt class="userinput"><b>init
&lt;runlevel&gt;</b></tt> где &lt;runlevel&gt; целевой номер runlevel. Для примера: перезагрузить компьютер можно используя
комманду <b>init 6</b>. Комманда reboot только алиас для <b>init 6</b>, как и комманда halt алиас для init 0.
</p><p>Дирестории, находящиеся в поддиректории /etc/rc.d выглядят как /rc?.d, где d-это
номер runlevel и rcsysinit.d который содержит число символических ссылок.
Неоторые начинаются на К, другие на S, и все из них имеют двухсимольную цифру,
следующую после начальной буквы. Буква К означает останов (kill) службы, а S означает запуск службы.
Число после буквы означает порядок, в котором скрипты будут запускаться. Числа могут
иметь значения от 00 до 99, и чем меньше число, тем раньше запуститься скрипт.
Когда init переключается на другой уровень, то службы предназначенные для одного
runlevel`a убиваются, и другие запускаются.
</p><p>Главные скрипты располагаются в директории /etc/rc.d/init.d. Они выполняют всю работу
и все симлинки указывают на них. Симинки для запуска и остановки указывают на скрипт
в директории /etc/rc.d/init.d с таким же именем. Поэтому скрипты могут быть вызваны
с различными параметрами, например start, stop, restart, reload, 
status. Когда скрипту передается аргумент stop, то вызывается К симлинк.
Когда скрипту передается аргумент start, то вызывается S симлинк.
</p><p>Есть только одно исключение. симлинки начинающиеся с S в директориях rc0.d и rc6.d
не могут быть запущены никогда. Они могут бать вызваны только с параметром
 <em>stop</em>для остановки чего либо.
Логика состоит в том, что если вы перезапустили или остановили систему, вам не надо
запускать что либо, а только остановить систему. 
</p><p>Здесь предоставлены описания аргументов, передаваемых в скрипты, и заставляющих их выполнять что либо:
</p><p></p><ul><li><p><em>start</em>: Запуск службы
</p></li><li><p><em>stop</em>: Останов службы</p></li><li><p><em>restart</em>: Перезагрузка службы. Сначала останов службы, потом запуск.</p></li><li><p><em>reload</em>: Обновить конфигурацию службы. Используется когда конфигурационный файл
данной службы был изменен. Перезапуск службы не требуется.
</p></li><li><p><em>status</em>: Опросить службу. Выдается информация о том, запущена служба или нет, ее PIDs.
</p></li></ul><p>Почувствуйте свободу в создании собственных процессов загрузки (на вашей 
собственной системе LFS). Все поля, данные здесь - лишь примеры, о том,
 как лучше сделать (если вы знаете, что вам надо - сделайте так, как вы хотите).
</p></div><div class="NAVFOOTER"><hr align="Left" width="100%" /=""><table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td width="33%" align="Left" valign="Top"><a href="introduction.html" accesskey="P">Назад</a></td><td width="34%" align="Center" valign="Top"><a href="../index.html" accesskey="H">Домой</a></td><td width="33%" align="Right" valign="Top"><a href="setclock.html" accesskey="N">Вперед</a></td></tr><tr><td width="33%" align="Left" valign="Top">Введение<br>
</td><td width="34%" align="Center" valign="Top"><a href="chapter07.html" accesskey="U">Наверх</a></td><td width="33%" align="Right" valign="Top">Конфигурация скрипта setclock</td></tr></tbody></table></div></body></html>