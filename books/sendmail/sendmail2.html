<html>

<head>
<title>Sendmail Installation and Operation Guide (part 2)</title>
</head>

<body>

<p><a name="toc2"></a><b>2. НОРМАЛЬНАЯ РАБОТА</b></p>

<dir>
    <dir>
            <a name="toc21"></a><b>2.1.
                Системный Протокол</b>
        </dir>
    </dir>

<p>Системный протокол
поддерживается программой <u>syslogd</u>(8).
Все сообщения от <u>sendmail</u>
протоколируются посредством LOG_MAIL<a
href="sendmail2.html#refer"><sup>1</sup></a>.<a name="b1"></a></p>

<dir><dir><dir><dir>
<a name="toc211"></a><b>2.1.1. Формат</b>
</dir></dir></dir></dir>

<p>Каждая строка в системном
протоколе состоит из временной
отметки, имени машины, создавшей ее
(для протоколирования с нескольких
машин через локальную сеть), слова
&quot;sendmail:&quot;, и самого сообщения<a
href="sendmail2.html#refer"><sup>2</sup></a>
.<a name="b2"></a> Большинство сообщений
являются последовательностью пар <u>имя</u>=<u>значение</u>.</p>

<p>После обработки сообщения обычно
протоколируются две строки. Первая
отмечает получение сообщения; на
каждое сообщение будет ровно одна
такая строка. Некоторые поля могут
быть пропущены, если они не
содержат интересной информации.
Поля такие:</p>

<table border="0" cellpadding="7" cellspacing="0" width="100%">
    <tr>
        <td valign="top" width="20%">from </td>
        <td valign="top" width="80%">Конвертный
        адрес отправителя </td>
    </tr>
    <tr>
        <td valign="top" width="20%">size </td>
        <td valign="top" width="80%">Размер
        сообщения в байтах </td>
    </tr>
    <tr>
        <td valign="top" width="20%">class</td>
        <td valign="top" width="80%">Класс (т.е.
        числовой приоритет) сообщения</td>
    </tr>
    <tr>
        <td valign="top" width="20%">pri </td>
        <td valign="top" width="80%">Начальный
        приоритет сообщения
        (используется для сортировки
        очереди) </td>
    </tr>
    <tr>
        <td valign="top" width="20%">nrcpts </td>
        <td valign="top" width="80%">Количество
        почтовых получателей для этого
        сообщения (после обработки
        псевдонимов и перенаправлений)
        </td>
    </tr>
    <tr>
        <td valign="top" width="20%">msgid </td>
        <td valign="top" width="80%">Идентификационный
        номер сообщения (из заголовка) </td>
    </tr>
    <tr>
        <td valign="top" width="20%">proto </td>
        <td valign="top" width="80%">Протокол,
        использовавшийся при
        получении этого сообщения
        (например, ESMTP или UUCP) </td>
    </tr>
    <tr>
        <td valign="top" width="20%">relay </td>
        <td valign="top" width="80%">Машина, от
        которой было получено
        сообщение </td>
    </tr>
</table>

<p>На каждую попытку доставки
сообщения записываетя еще одна
строка (так что каждое сообщение
таких строк может быть несколько,
например, если оно отложено, или
если имеется несколько
получателей). Поля в этой строке
таковы:</p>

<table border="0" cellpadding="7" cellspacing="0" width="100%">
    <tr>
        <td valign="top" width="20%">to</td>
        <td valign="top" width="80%">Список
        получателей для этой почтовой
        программы, разделенный
        запятыми.</td>
    </tr>
    <tr>
        <td valign="top" width="20%">ctladdr</td>
        <td valign="top" width="80%">&quot;Контрольный
        пользователь&quot;, то есть, имя
        пользователя, чьи параметры мы
        используем при доставке.</td>
    </tr>
    <tr>
        <td valign="top" width="20%">delay</td>
        <td valign="top" width="80%">Общее время
        задержки между получением и
        доставкой сообщения.</td>
    </tr>
    <tr>
        <td valign="top" width="20%">xdelay</td>
        <td valign="top" width="80%">Время,
        понадобившееся для попытки
        доставки (обычно показывает
        скорость соединения).</td>
    </tr>
    <tr>
        <td valign="top" width="20%">mailer</td>
        <td valign="top" width="80%">Имя почтовой
        программы, использовавшейся
        для доставки к данному
        получателю.</td>
    </tr>
    <tr>
        <td valign="top" width="20%">relay</td>
        <td valign="top" width="80%">Имя хоста,
        принявшего сообщение для
        данного получателя (или
        отказавшего в доставке).</td>
    </tr>
    <tr>
        <td valign="top" width="20%">stat</td>
        <td valign="top" width="80%">Статус
        доставки. </td>
    </tr>
</table>

<p>Не все эти поля присутствуют для
всех сообщений; например, для
локальных сообщений отсутствует
поле relay.</p>

<dir>
    <dir>
            <dir>
                    <dir>
                            <a name="toc212"></a><b>2.1.2.
                                Уровни</b>
                        </dir>
                    
                </dir>
            
        </dir>
    
</dir>

<p>Если у вас установлен <u>syslogd</u>(8)
или его эквивалент, то вы можете
производить протоколирование.
Имеется большое количество
информации, которое можно
запротоколировать. Протокол
организован как
последовательность уровней. На
самом нижнем уровне
протоколируются только самые
странные ситуации. На самом высоком
уровне даже самые обычные и
неинтересные события записываются
для потомства. Согласно соглашению,
уровни протоколирования ниже
десятого обычно считаются
&quot;полезными&quot;; уровни
протоколирования выше 64
зарезервированы для целей отладки.
Уровни с 11 по 64 зарезервированы для
многословной информации, что могут
захотеть некоторые узлы.</p>

<p>Полное описание уровней
протоколирования дано в разделе 4.6.</p>

<dir>
    <dir>
            <a name="toc22"></a><b>2.2.
                Состояние Сброса</b>
        </dir>
    
</dir>

<p>Вы можете попросить <u>sendmail</u>
запротоколировать сброс открытых
файлов и кэша соединений, послав
ему сигнал SIGUSR1. Результаты
протоколируются по очередности
LOG_DEBUG.</p>

<dir>
    <dir>
            <a name="toc23"></a><b>2.3.
                Почтовая Очередь</b>
        </dir>
    
</dir>

<p>Время от времени <u>sendmail</u> не может
обслужить сообщение немедленно.
Например, он может быть перегружен,
или вообще &quot;упасть&quot;,
последствием чего будет отказ от
соединений. Тогда посылающий хост
должен будет сохранить это
сообщение в своей почтовой очереди
и попытаться доставить его позже.</p>

<p>При нормальных условиях почтовая
очередь будет обрабатываться
прозрачно. Однако вы можете
обнаружить, что иногда необходимо
вмешаться руками. Например, если
основной хост долгое время
отключен, очередь может засориться.
Хотя <u>sendmail</u> должен нормально
восстановить все при загрузке
хоста, тем временем вы можете найти
его производительность
неприемлемо низкой.</p>

<dir>
    <dir>
            <dir>
                    <dir>
                            <a name="toc231"></a><b>2.3.1.
                                Печать Очереди</b>
                        </dir>
                    
                </dir>
            
        </dir>
    
</dir>

<p>Содержимое очереди можно
распечатать, используя команду <u>mailq</u>
(или указав <u>sendmail</u> флаг <b>-bp</b>):</p>

<dir>
    <font color="#008000">mailq</font>
</dir>

<p>Результатом ее выполнения будет
список идентификаторов сообщений,
находящихся в очереди, размеров
сообщений, даты поступления
сообщения в очередь, и отправитель
с получателями.</p>

<dir>
    <dir>
            <dir>
                    <dir>
                            <a name="toc232"></a><b>2.3.2.
                                Ускорение Очереди</b>
                        </dir>
                    
                </dir>
            
        </dir>
    
</dir>

<p><u>Sendmail</u> должен обрабатывать
очередь автоматически через
определенный интервал. Алгоритм
такой: прочитать и отсортировать
очередь, а затем обработать все
сообщения по порядку. При попытке
запустить работу, <u>sendmail</u> сначала
проверяет, не заблокирована ли она.
Если блокировка имеется, то он
игнорирует эту работу.</p>

<p>Не производится ни одной попытки
удостовериться в том, что только
один обработчик очереди существует
в любое время, поэтому нет никакой
гарантии, что работа не будет
производиться вечно (однако, <u>sendmail</u>
имеет некоторую эвристику, чтобы
попытаться прекратить работу,
занимающую абсурдно большое
количество времени;
технологически, это нарушает
требования RFC 821, но одобряется в RFC
1123). Согласно алгоритму блокировки,
одна работа не может заморозить всю
очередь. Однако, недружественный
принимающий хост, или программа
приема, которая никогда ничего не
возвращает, может собрать большое
количество процессов в вашей
системе. К несчастью, нет никакого
общего решения для разрешения
подобных проблем. </p>

<p>В некоторых случаях, вы можете
заметить, что основной хост второй
день как упал, и у вас накопилась
невероятно большая очередь. В
результате <u>sendmail</u> большую часть
времени будет проводить, сортируя
эту очередь. Эта ситуация может
быть исправлена, если вы уберете
очередь в какое-то временное место
и создадите новую очередь. Старую
очередь можно будет обработать
позже, когда хост-нарушитель опять
начнет работать.</p>

<p>Чтобы это сделать, вполне
возможно перенести весь каталог
очереди:</p>

<dir>
    <font color="#008000">cd /var/spool<p>
	mv mqueue omqueue; mkdir mqueue; chmod
        700 mqueue</font></p>
    
</dir>

<p>Затем вы должны убить работающий
демон (потому что он все еще будет
продолжать обрабатывать старый
каталог очереди) и создать нового
демона.</p>

<p>Чтобы обработать старую очередь,
запустите следующую команду:</p>

<dir>
    <font color="#008000">/usr/sbin/sendmail
        -oQ/var/spool/omqueue -q</font>
</dir>

<p>Флаг <b>-oQ</b> определит
альтернативный каталог очереди, а
флаг <b>-q</b> скажет о том, что нужна
всего лишь обработка каждого
сообщения в очереди. Если у вас
имеется тяга к вуайеризму, вы
можете использовать флаг <b>-v</b>,
чтобы посмотреть, что будет
происходить.</p>

<p>Когда в очереди наконец-то не
останется ни одного сообщения, вы
сможете удалить этот каталог:</p>

<dir>
    <font color="#008000">rmdir /var/spool/omqueue</font><dir>
            <a name="toc24"><b></b></a><b>2.4.
                Дисковая Информация о
                Соединении</b>
        </dir>
    
</dir>

<p>О каждой удаленной системе, с
которой было соединение, <u>sendmail</u>
сохраняет в памяти большое
количество информации. Теперь
стало возможным сохранять
некоторую часть этой информации на
диске, используя опцию <b>HostStatusDirectory</b>
, которая может одновременно
использоваться несколькими
процессами <u>sendmail</u>. Это позволяет
немедленно ставить почту в очередь,
или пропустить ее при обработке
очереди, если недавно было
неудачное соединение с удаленной
машиной.</p>

<p>Дополнительно, включение опции <b>SingleThreadDelivery</b>
даст дополнительный эффект
доставки почты к месту назначения
одной цепочкой. Это может очень
помочь, если на удаленной машине
работает сервер SMTP, который легко
перегружается, или может работать
только с одним соединением за раз.
Она применяется ко <u>всем</u> хостам,
поэтому установите ее, если на
вашем узле для доставки почты
используется одна машина, на
которой работает дополнительное
программное обеспечение,
увеличивающее загрузку машины, что
может привести к замедлению
доставки почты на другие хосты.
Установите эту опцию, если вы
имеете на вашем узле одну почтовую
машину, и на ней еще работают
приложения, которые могут
увеличить ее загрузку, замедлив
обработку почты. Если эта опция
выставлена, то вам, возможно,
захочется выставить опцию <b>MinQueueAge</b>,
чтобы ваша очередь обрабатывалась
достаточно часто; в результате
работы, пропущенные по причине
того, что другой процесс <u>sendmail</u>
разговаривал с тем же хостом,
вскоре были опробованы снова, а не
отложены на долгое время.</p>

<p>Информация о хостах сохраняется
на диске в подкаталоге <b>.hoststat</b><a
href="sendmail2.html#refer"><sup>3</sup></a>
<a name="b3"></a>каталога <b>mqueue</b>. Удаление
этого каталога с его подкаталогами
равносильно команде <u>purgestat</u> и
вполне безопасно. Информация из
этих каталогов может быть
просмотрена командой <u>hoststat</u>,
которая покажет имя хоста,
последний доступ и статус этого
доступа. Звездочка в самой левой
колонке означает, что процесс <u>sendmail</u>
в настоящее время имеет блокировку
на доставку почты на этот хост.</p>

<p>В целях оптимизации таймаутов,
информация, сохраняемая на диске,
обслуживается таким же образом, что
и информация, хранимая в памяти. По
умолчанию, информация об ошибках
хостов действительна в течение 30
минут. Это значение может быть
изменено опцией <b>Timeout.hoststatus</b>.</p>

<p>Информация о соединении,
сохраненная на диске, может быть
очищена в любой момент командой <u>purgestat</u>,
или запуском sendmail с ключом <b>-bH</b>.
Информацию о соединении можно
просмотреть командой <u>hoststat</u>, или
запуском sendmail с ключом <b>-bh</b>.</p>

<dir>
    <dir>
            <a name="toc25"></a><b>2.5.
                Сервисный Переключатель</b>
        </dir>
    
</dir>

<p>Реализация системных сервисов,
таких, как определение имени хоста
и пользователя управляется
сервисным переключателем. Если
операционная система хоста
поддерживает такой переключатель,
то <u>sendmail</u> будет использовать
родную версию. Ultrix, Solaris, и DEC OSF/1 -
примеры таких операционных систем.
И хотя HP-UX 10 имеет поддержку
сервисного переключателя, но, так
как API не поддерживается
библиотеками, <u>sendmail</u> в этот раз не
использует родной сервисный
переключатель.</p>

<p>Если операционная система не
поддерживает сервисный
переключатель (например, SunOS, HP-UX, BSD),
то <u>sendmail</u> будет использовать свою
реализацию. Опция <b>ServiceSwitchFile</b>
указывает на имя файла, содержащего
определения сервисов. Каждая
строка содержит имя сервиса и
возможные реализации этого
сервиса. Например, файл:</p>

<dir>
    <dir>
            <font color="#008000">hosts dns files nis<br>
                aliases files nis</font>
        </dir>
    
</dir>

<p>попросит <u>sendmail</u> просматривать
имена хостов сначала в Domain Name System.
Если запрошенное имя хоста не
найдено, он попробует локальные
файлы, если и там не найдет, то
попробует NIS. Точно также, при
просмтре псевдонимов, сначала он
попробует локальные файлы, а затем
NIS.</p>

<p>Сервисные переключатели не
полностью интегрированы. Например,
несмотря на то, что в вышеописанном
примере имя хоста необходимо
смотреть в NIS, в SunOS этого не
произойдет, из-за того, что
системная реализация <u>gethostbyname</u>(3)
не понимает этого. Если имеется
достаточно причин, <u>sendmail</u> может
использовать свои реализации <u>gethostbyname</u>(3),
<u>gethostbyaddr</u>(3), <u>getpwent</u>(3), и других
системных подпрограмм, которые
необходимы для его нормальной
работы.</p>

<dir>
    <dir>
            <a name="toc26"></a><b>2.6. База
                Данных Псевдонимов</b>
        </dir>
    
</dir>

<p>После получения адресов
получателей из соединения SMTP или
командной строки, они
обрабатываются согласно набору
правил 0, которые должны определить
тройку {<u>mailer</u>, <u>host</u>, <u>user</u>}. Если
флаги выбранные <u>mailer</u>'ом включают
флаг <b>A</b> (aliasable), часть тройки <u>user</u>
рассматривается как ключ (т.е.,
левосторонняя) в базе данных
псевдонимов (aliases). Если имеется
совпадение, адрес удаляется из
очереди на отсылку, а все адреса с
правой стороны псевдонима
добавляются вместо найденного
псевдонима. Эта операция является
рекурсивной, поэтому псевдонимы,
найденные в правосторонней части
псевдонима обрабатываются таким же
образом.</p>

<p>База данных псевдонимов
существует в двух видах. Один -
текстовая форма, содержащаяся в
файле <u>/etc/aliases.</u> Псевдонимы имеют
следующий вид</p>

<dir>
    <dir>
            <font color="#008000">name: name1, name2, ...</font>
        </dir>
    
</dir>

<p>Только локальные имена могут быть
псевдонимизированы; например, </p>

<dir>
    <dir>
            <font color="#008000">eric@prep.ai.MIT.EDU:
                eric@CS.Berkeley.EDU</font>
        </dir>
    
</dir>

<p>не возымеет ожидаемого эффекта
(если это не на prep.ai.MIT.EDU, но я им
точно не нужен)<a href="sendmail2.html#refer"><sup>4</sup></a>.<a
name="b4"></a>Псевдонимы могут быть
продолжены началом любых
строк-продолжений с пробелом или
табуляцией. Пустые строки и строки,
начинающиеся со знака диез (&quot;#&quot;)
считаются комментариями.</p>

<p>Вторая форма обрабатывается
библиотекой <u>ndbm</u>(3)<a href="sendmail2.html#refer"><sup>5</sup></a><a name="b5"></a>.
Эта форма находится в файлах <u>/etc/aliases.db</u>
(если используется NEWDB) или <u>/etc/aliases.dir</u>
и <u>/etc/aliases.pag</u> (если используется
NDBM). Эта именно та форма, которую
использует <u>sendmail</u> при
определении псевдонимов. Эта
технология используется для
увеличения производительности.</p>

<p>Управление порядком поиска
выставляется непосредственно
сервисным переключателем. По
существу, вхождение</p>

<dir>
    <dir>
            <font color="#008000">OAswitch:aliases</font>
        </dir>
    
</dir>

<p>всегда добавляется как первое
вхождение псевдонимов; также,
первое имя файла псевдонимов без
класса (например, без &quot;nis:&quot;
вначале) будет использовано как имя
файла для вхождения &quot;files&quot; в
переключателе псевдонимов.
Например, если конфигурация
содержит </p>

<dir>
    <dir>
            <font color="#008000">OA/etc/aliases, </font>
        </dir>
    
</dir>

<p>а сервисный переключатель
содержит</p>

<dir>
    <dir>
            <font color="#008000">aliases nis files nisplus</font>
        </dir>
    
</dir>

<p>то псевдонимы будут сначала
искаться в базе данных NIS, затем в
/etc/aliases, а затем в базе данных NIS+.</p>

<p>Вы также можете использовать
файлы псевдонимов на основе NIS.
Например, определение:</p>

<dir>
    <dir>
            <font color="#008000">OAliasFile=/etc/aliases<p>
OAliasFile=nis:mail.aliases@my.nis.domain</font></p>
            
        </dir>
    
</dir>

<p>будет сначала искать файл /etc/aliases,
а затем карту с именем &quot;mail.aliases&quot;
в &quot;my.nis.domain&quot;. Внимание: если вы
строите свой собственный файл
псевдонимов на основе NIS,
обязательно поставьте флаг <b>-l</b>
для <u>makedbm</u>(8) для преобразования
заглавных букв в ключах в строчные;
иначе псевдонимы с заглавными
буквами в именах не будут совпадать
с входящими адресами.</p>

<p>Дополнительные флаги могут быть
добавлены после двоеточия, точно
как строка <b>K</b>; например:</p>

<dir>
    <dir>
            <font color="#008000">OAliasFile=nis:-N
                mail.aliases@my.nis.domain</font>
        </dir>
    
</dir>

<p>будет искать соответствующую
карту NIS и всегда иметь ноль байт в
ключе. Также</p>

<dir>
    <dir>
            <font color="#008000">OAliasFile=nis:-f
                mail.aliases@my.nis.domain</font>
        </dir>
    
</dir>

<p>удержит sendmail от преобразования
ключа в символы нижнего регистра
перед просмотром псевдонимов.</p>

<dir>
    <dir>
            <dir>
                    <dir>
                            <a name="toc261"><b></b></a><b>2.6.1.
                                Перестроение Базы
                                Данных
                                Псевдонимов</b>
                        </dir>
                    
                </dir>
            
        </dir>
    
</dir>

<p>Версия базы данных в виде <u>hash</u>
или <u>dbm</u> может быть перестроена
выполнением команды</p>

<dir>
    <dir>
            <font color="#008000">newaliases</font>
        </dir>
    
</dir>

<p>Это эквивалентно заданию <u>sendmail</u>
флага <b>-bi</b>:</p>

<dir>
    <dir>
            <font color="#008000">/usr/sbin/sendmail -bi</font>
        </dir>
    
</dir>

<p>Если в конфигурации определена
опция <b>RebuildAliases</b> (раннее <b>D</b>), <u>sendmail</u>
будет перестраивать базу данных
псевдонимов автоматически, если
она может быть старой.
Автоматическая перестройка может
быть опасной на сильно загруженных
машинах с большими файлами
псевдонимов; если перестроение
базы займет больше чем таймаут
перестройки базы (опция <b>AliasWait</b>,
ранее <b>a</b>, нормальное значение
которой равно пяти минутам), то
вполне возможно, что будут запущены
одновременно несколько процессов
перестройки.</p>

<p>Если вы определили несколько баз
данных псевдонимов, флаг <b>-bi</b>
перестроит все типы баз данных,
которые он понимает (например, он
может перестраивать базы данных NDBM,
но не может базы данных NIS).</p>

<dir>
    <dir>
            <dir>
                    <dir>
                            <a name="toc262"></a><b>2.6.2.
                                Потенциальные
                                проблемы</b>
                        </dir>
                    
                </dir>
            
        </dir>
    
</dir>

<p>Существует несколько проблем,
которые могут случиться с базой
данных псевдонимов. Все они
происходят из того, что процесс <u>sendmail</u>
может начать использовать DBM-версию
псевдонимов, когда она будет
построена только частично. Это
может случиться при двух условиях:
один процесс использует базу
данных, в то время как второй ее
перестраивает, или процесс,
занимающийся перестройкой базы
данных, умирает (из-за того, что его
убили, или система вдруг упала) до
полного завершения перестройки.</p>

<p>Sendmail имеет три метода, чтобы
попытаться избавиться от этих
проблем. Первый - он игнорирует
прерывания во время перестройки
базы данных; это позволяет избежать
случая, когда кто-нибудь прекращает
процесс, оставляя частично
перестроенную базу данных. Второй -
он блокирует исходный файл базы
данных во время перестройки - но это
может не работать поверх NFS или если
файл защищен на запись. Третий - в
конце перестройки он добавляет
псевдоним в виде</p>

<dir>
    <dir>
            <font color="#008000">@: @</font>
        </dir>
    
</dir>

<p>(что вообще-то нелегально). Перед
тем, как <u>sendmail</u> будет
использовать базу данных, он
произведет проверку на наличие
этого вхождения<a href="sendmail2.html#refer"><sup>6</sup></a>.<a name="b6"></a></p>

<dir>
    <dir>
            <dir>
                    <dir>
                            <a name="toc263"></a><b>2.6.3.
                                Владельцы Списков</b>
                        </dir>
                    
                </dir>
            
        </dir>
    
</dir>

<p>Если при посылке на определенный
адрес, скажем ,&quot;x&quot;, произойдет
ошибка, <u>sendmail</u> будет искать
псевдоним вида &quot;owner-<u>x</u>&quot; для
получения ошибки. Это обычно
полезно для списков рассылки, где
подписчик сам не имеет управления
поддержкой списка; в этом случае,
держатель списка может быть
владельцем списка. Например:</p>

<dir>
    <dir>
            <font color="#008000">unix-wizards: eric@ucbarpa,
                wnj@monet, nosuchuser, sam@matisse<p>
owner-unix-wizards: unix-wizards-request </p>
                <p>unix-wizards-request: eric@ucbarpa</font></p>
            
        </dir>
    
</dir>

<p>заставит &quot;eric@ucbarpa&quot; получать
ошибки, которые произойдут, когда
кто-нибудь посылает в unix-wizards и
попадает под вхождение &quot;nosuchuser&quot;
в списке.</p>

<p>Владельцы списков также изменяют
почтовый адрес отправителя.
Используется содержимое
псевдонима владельца, если оно
указывает на одного пользователя,
иначе будет использоваться само
имя псевдонима. По этой причине, и в
соответствии с соглашениями Internet,
адрес &quot;owner-&quot; обычно указывает
на адрес &quot;-request&quot;; это позволяет
сообщениям следовать типичным
соглашениям Internet об использовании
&quot;<u>list</u>request&quot; как обратный
адрес.</p>

<dir>
    <dir>
            <a name="toc27"></a><b>2.7. База
                Данных Пользовательской
                Информации</b>
        </dir>
    
</dir>

<p>Если вы имеете версию <u>sendmail</u> с
вкомпиллированной базой данных
пользовательской информации, и
определили одну или несколько баз
данных используя опцию <b>U</b>, базы
данных будут просмотрены в поисках
вхождения <u>user</u>:maildrop. Если такое
будет найдено, почта будет послана
по указанному адресу.</p>

<dir>
    <dir>
            <a name="toc28"></a><b>2.8.
                Пользовательская
                пересылка (файлы .forward)</b>
        </dir>
    
</dir>

<p>Как альтернативу базе данных
псевдонимов, каждый пользователь
может создать в своем домашнем
каталоге файл с именем &quot;.forward&quot;.
Если такой файл существует, <u>sendmail</u>
перенаправляет почту для этого
пользователя по списку адресов,
указанных в файле .forward. Например,
если домашний каталог пользователя
&quot;mckusick&quot; содержит файл .forward
содержащий:</p>

<dir>
    <dir>
            <font color="#008000">mckusick@ernie<p>
kirk@calder</font></p>
            
        </dir>
    
</dir>

<p>то любая почта, поступившая для
&quot;mckusick&quot; будет перенаправлена по
указанным адресам.</p>

<p>На самом деле, файл конфигурации
определяет последовательность
проверяемых имен файлов. По
умолчанию, это пользовательский
файл .forward, но может быть определен
по-другому, используя опцию <b>ForwardPath</b>.
Если вы ее измените, вы должны
будете проинформировать ваших
основных пользователей об
изменении; .forward очень хорошо вошло
в коллективное подсознание.</p>

<dir>
    <dir>
            <a name="toc29"></a><b>2.9.
                Специальные Строки
                Заголовка</b>
        </dir>
    
</dir>

<p>Несколько строк заголовка имеют
особые интерпретации, определенные
файлом конфигурации. Остальные
имеют интерпретации, которые
встроены в <u>sendmail</u> и не могут быть
изменены без изменения кода. Здесь
описаны эти встроенные
интерпретации.</p>

<dir>
    <dir>
            <dir>
                    <dir>
                            <a name="toc291"></a><b>2.9.1.
                                Errors-To:</b>
                        </dir>
                    
                </dir>
            
        </dir>
    
</dir>

<p>Если во время обработки
происходит ошибка, этот заголовок
заставит отослать сообщение об
ошибке по указанному адресу. Это
предназначено для списков
рассылки.</p>

<p>Заголовок Errors-To: был создан в
плохие старые времена, когда UUCP не
понимал различий между содержимым
и заголовком; Это было встроено для
того, чтобы указать, что должно быть
теперь пропущено как адрес
отправителя сообщения. Это должно
уйти, но пока еще используется, если
выставлена опция <b>UseErrorsTo</b>.</p>

<p>Заголовок Errors-To: официально уже
убран, и в последующих выпусках
должен отсутствовать.</p>

<dir>
    <dir>
            <dir>
                    <dir>
                            <a name="toc292"></a><b>2.9.2.
                                Apparently-To:</b>
                        </dir>
                    
                </dir>
            
        </dir>
    
</dir>

<p>RFC 822 требует в каждом сообщении
иметь по крайней мере одно поле
получателя (строку To:, Cc:, или Bcc:).
Если сообщение приходит без
указания какого-либо получателя в
сообщении, <u>sendmail</u> добавит
заголовок на основе опции
&quot;NoRecipientAction&quot;. Одним из возможных
действий будет добавка в заголовок
строки &quot;Apparently-To:&quot; для каждого
получателя, о котором он знает. </p>

<p>Заголовок Apparently-To: не стандартен и
удален.</p>

<dir>
    <dir>
            <dir>
                    <dir>
                            <a name="toc293"></a><b>2.9.3.
                                Precedence</b>
                        </dir>
                    
                </dir>
            
        </dir>
    
</dir>

<p>Заголовок Precedence: может быть
использован как грубое управление
приоритетом сообщения. Он
перестраивает порядок в очереди и
может быть сконфигурирован на
изменение значений таймаутов для
сообщения.</p>

<dir>
    <dir>
            <a name="toc210"></a><b>2.10.
                Поддержка Протокола IDENT</b>
        </dir>
    
</dir>

<p><u>Sendmail</u> поддерживает протокол
IDENT, определенный в RFC 1413. Хотя это
улучшает идентификацию автора
сообщения в электронной почте
посредством производства
&quot;обратного звонка&quot; в систему,
откуда исходит сообщение для
определения владельца соединения,
это не идеально; протокол IDENT можно
достаточно легко обмануть.
Следующее описание было взято из RFC
1413:</p>

<p align="center">6. Положения Безопасности</p>

<p>Информации, возвращаемой этим
протоколом можно доверять
настолько, насколько можно
доверять хосту ИЛИ организации, в
которой находится этот хост.
Например, PC в открытой лаборатории
имеет немного, если вообще имеет
вообще что-либо запрещающее
пользователю указать этому
протоколу возвращать любой
идентификатор, какой он захочет.
Точно так же, если хост был
скомпрометирован, возвращаемая им
информация может быть полностью
ошибочна и неверна. </p>

<p>Протокол Идентификации не
предназначен для авторизации или
управления доступом. В лучшем
случае, он обеспечивает некоторую
дополнительную проверочную
информацию в отношении соединения
TCP. В худшем, он обеспечит
дезориентирующую, неверную или
злобно некорректную информацию.</p>

<p>Использование информации,
полученной из этого протокола для
чего-либо иного, чем удостоверение,
очень не советуется. В особенности,
использование Идентификационного
Протокола для выноса решений о
доступе - как в качестве главного
метода (т.е. единственной проверки)
так и в качестве дополнения к
другим методам может привести к
ослаблению нормальной
безопасности хоста.</p>

<p>Сервер Идентификации может
обнаружить информацию о
пользователях, сущностях, объектах
или процессах, которая обычно может
быть рассмотрена как
конфиденциальная. Сервер
Идентификации обеспечивает сервис,
являющийся грубым аналогом
сервисов CallerID, обеспечиваемых
некоторыми телефонными компаниями,
а многие из таких же частных
определений и аргументов,
применяемых в сервисе CallerID,
подходят к Идентификации. Если вы
не будете запускать сервер
&quot;finger&quot; по причинам сохранения
тайны, то вы можете не захотеть
использовать этот протокол.</p>

<p>В некоторых случаях ваша система
может не работать нормально с
поддержкой IDENT из-за ошибки в
реализации TCP/IP. Симптомы будут
таковы: для некоторых хостов
соединение SMTP будет закрываться
почти емедленно. Если это
действительно так происходит, или
вы не хотите использовать IDENT, вы
должны установит таймаут IDENT равным
нулю; это отключит протокол IDENT.</p>

<hr>

<p><a name="refer"><font size="-1"></a>1.
Кроме Ultrix, не поддерживающего в syslog
различные средства. <a href="sendmail2.html#b1"> [назад] </a></p>

<p>2. Этот формат может быть
немного другим, если ваш поставщик
изменил синтаксис. <a href="sendmail2.html#b2"> [назад] </a></p>

<p>3. Это обычное значение
опции HostStatusDirectory; конечно же, если
вы этого захотите, она может
указывать на любое место в вашей
файловой системе. <a href="sendmail2.html#b3"> [назад] </a></p>

<p>4. На самом деле, любая
почтовая программа, имеющая
выставленный почтовый флаг &quot;A&quot;
будет позволять
псевдонимизирование; обычно это
ограничено локальной почтовой
программой. <a href="sendmail2.html#b4"> [назад] </a></p>

<p>5. Пакет gdbm не работает. <a
href="sendmail2.html#b5"> [назад] </a></p>

<p>6. Для того, чтобы можно
было произвести это действие, в
файле конфигурации требуется опция
AliasWait. Обычно она должна быть
определена. <a href="sendmail2.html#b6"> [назад] </a></p>
</body>
</html>
