<HTML>
<HEAD>
<!-- Created by texi2html 1.56k from texinfo.texi on 31 May 2000 -->

<TITLE>Texinfo 4.0 - Включаемые файлы</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="texinfo_1.html">first</A>, <A HREF="texinfo_25.html">previous</A>, <A HREF="texinfo_27.html">next</A>, <A HREF="texinfo_33.html">last</A> section, <A HREF="texinfo_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="SEC252" HREF="texinfo_toc.html#TOC252">Включаемые файлы</A></H1>
<P>
<A NAME="IDX994"></A>


<P>
Когда TeX или команда форматирования Info встречают в Texinfo-файле
команду <CODE>@include</CODE>, они обрабатывают содержимое указанного
командой файла и включают его в создаваемый DVI- или Info-файл.
Вхождения именных указателей из включаемых файлов вносятся в именные
указатели выходного файла.


<P>
Включаемые файлы позволяют вам держать большой документ в виде удобных
небольших частей.




<H2><A NAME="SEC253" HREF="texinfo_toc.html#TOC253">Как использовать включаемые файлы</A></H2>
<P>
<A NAME="IDX995"></A>


<P>
Чтобы включить в Texinfo-файл другой файл, напишите команду
<CODE>@include</CODE> в начале строки, и за ней имя включаемого файла на той
же строке.  Например:



<PRE>
@include buffers.texi
</PRE>

<P>
Включаемый файл должен быть просто сегментом текста, который вы
предполагаете вставить как есть в общий или <EM>внешний</EM> Texinfo-файл;
он не должен содержать стандартные начальную и завершающую части
Texinfo-файла.  В особенности, вы не должны начинать включаемый файл
строкой <SAMP>`\input texinfo'</SAMP>; если вы сделаете так, эта фраза вставится
во внешний файл буквально.  Аналогично, вы не должны завершать
включаемый файл командой <CODE>@bye</CODE>; текст после <CODE>@bye</CODE> не
форматируется.


<P>
Раньше в начале каждого включаемого файла нужно было обязательно писать
строку <CODE>@setfilename</CODE>, но теперь не нужно.  Теперь не имеет
значения, написали ли вы такую строку или нет.  Если строка
<CODE>@setfilename</CODE> существует во включаемом файле, она игнорируется.


<P>
По соглашению, включаемый файл начинается строкой <CODE>@node</CODE>, за
которой следует строка <CODE>@chapter</CODE>.  Каждый включаемый файл -- это
одна глава.  Это облегчает использование обычных команд создания и
обновления нод и меню внутри включаемого файла.  Однако, простые команды
Emacs для создания и обновления нод и меню не работают со множественными
Texinfo-файлами.  То есть вы не можете использовать эти команды для
заполнения указателей `Next', `Previous' и `Up' в строке <CODE>@node</CODE>,
которая начинает включаемый файл.  Также вы не можете использовать
обычные команды для создания главного меню полного файла.  Вы либо
должны заполнить меню и указатели `Next', `Previous' и `Up' вручную,
либо использовать команду режима Texinfo для GNU Emacs,
<CODE>texinfo-multiple-files-update</CODE>, разработанную для
<CODE>@include</CODE>-файлов.




<H2><A NAME="SEC254" HREF="texinfo_toc.html#TOC254"><CODE>texinfo-multiple-files-update</CODE></A></H2>
<P>
<A NAME="IDX996"></A>


<P>
Режим Texinfo в GNU Emacs предоставляет команду
<CODE>texinfo-multiple-files-update</CODE>.  Эта команда создает или обновляет
во включаемом файле указатели `Next', `Previous' и `Up', а также во
внешнем или общем Texinfo-файле; и создает или обновляет главное меню во
внешнем файле.  В зависимости от того, вызвали ли вы ее с
необязательными аргументами, эта команда обновляет либо только указатели
в первой строке <CODE>@node</CODE> включаемого файла, либо все указатели:


<DL COMPACT>

<DT><KBD>M-x texinfo-multiple-files-update</KBD>
<DD>
Вызванная без аргументов:


<UL>
<LI>

Создает или обновляет указатели `Next', `Previous' и `Up' в первой
строке <CODE>@node</CODE> в каждом файле, включенном во внешний или общий
Texinfo-файл.

<LI>

Создает или обновляет указатели первого уровня во внешнем или общем
файле.

<LI>

Создает или обновляет главное меню во внешнем файле.
</UL>

<DT><KBD>C-u M-x texinfo-multiple-files-update</KBD>
<DD>
Вызванная с <KBD>C-u</KBD> в качестве префиксного аргумента:


<UL>
<LI>

Создает или обновляет указатели в первой строке <CODE>@node</CODE> в каждом
включаемом файле.

<LI>

Создает или обновляет указатели первого уровня во внешнем файле.

<LI>

Создает и вставляет главное меню во внешнем файле.  Главное меню
составляется из всех меню всех включаемых файлов.
</UL>

<DT><KBD>C-u 8 M-x texinfo-multiple-files-update</KBD>
<DD>
Вызванная с числовым префиксным аргументом, например <KBD>C-u 8</KBD>:


<UL>
<LI>

Создает или обновляет <STRONG>все</STRONG> указатели `Next', `Previous' и `Up'
во всех включаемых файлах.

<LI>

Создает или обновляет <STRONG>все</STRONG> меню во всех включаемых файлах.

<LI>

Создает или обновляет указатели первого уровня во внешнем или общем
файле.

<LI>

И затем создает главное меню во внешнем файле.  Это похоже на вызов
<CODE>texinfo-master-menu</CODE> с аргументом, когда вы работаете только с
одним файлом.
</UL>

</DL>

<P>
Обратите внимание на применение префиксного аргумента при интерактивном
использовании: с обычным префиксным аргументом, просто <KBD>C-u</KBD>,
команда <CODE>texinfo-multiple-files-update</CODE> вставляет главное меню; с
числовым префиксным аргументом, таким как <KBD>C-u 8</KBD>, эта команда
обновляет <STRONG>все</STRONG> указатели и меню во <STRONG>всех</STRONG> файлах и затем
вставляет главное меню.




<H2><A NAME="SEC255" HREF="texinfo_toc.html#TOC255">Требования для включаемых файлов</A></H2>
<P>
<A NAME="IDX997"></A>
<A NAME="IDX998"></A>


<P>
Если вы планируете использовать команду
<CODE>texinfo-multiple-files-update</CODE>, то внешний Texinfo-файл,
перечисляющий включаемые файлы, не должен содержать ничего, кроме
начальной и завершающей частей Texinfo-файла и нескольких команд
<CODE>@include</CODE> для включаемых файлов.  Он не должен включать даже
именных указателей, которые должны быть перечислены в отдельном
включаемом файле.


<P>
Кроме того, каждый включаемый файл должен содержать ровно одну ноду
верхнего уровня (обычно это <CODE>@chapter</CODE> или эквивалент), и эта ноды
должна быть первой нодой во включаемом файле.  Более того, все эти нод
верхнего уровня из каждого включаемого файла должны быть на одном
иерархическом уровне в общей структуре.  Обычно все они являются нодами
<CODE>@chapter</CODE>, <CODE>@appendix</CODE> или <CODE>@unnumbered</CODE>.  Таким
образом, каждый включаемый файл содержит одну и только одну ноду с
главой или эквивалентного уровня.


<P>
Внешний файл должен содержать только <EM>одну</EM> ноду, ноду `Top'.  Он
не должен содержать <EM>никаких</EM> нод кроме одной ноды `Top'.  Команда
<CODE>texinfo-multiple-files-update</CODE> не будет их обрабатывать.




<H2><A NAME="SEC256" HREF="texinfo_toc.html#TOC256">Пример файла с <CODE>@include</CODE></A></H2>
<P>
<A NAME="IDX999"></A>
<A NAME="IDX1000"></A>
<A NAME="IDX1001"></A>


<P>
Вот пример законченного внешнего Texinfo-файла с
<CODE>@include</CODE>-файлами внутри, до запуска
<CODE>texinfo-multiple-files-update</CODE>, которая вставила бы главное меню:



<PRE>
\input texinfo @c -*-texinfo-*-
@setfilename  include-example.info
@settitle Include Example

@setchapternewpage odd
@titlepage
@sp 12
@center @titlefont{Include Example}
@sp 2
@center by Whom Ever

@page
@vskip 0pt plus 1filll
Copyright @copyright{} 1998 Free Software Foundation, Inc.
@end titlepage

@ifinfo
@node Top, First, , (dir)
@top Master Menu
@end ifinfo

@include foo.texinfo
@include bar.texinfo
@include concept-index.texinfo

@summarycontents
@contents

@bye
</PRE>

<P>
Включаемый файл, например <TT>`foo.texinfo'</TT>, может выглядеть так:



<PRE>
@node First, Second, , Top
@chapter First Chapter

Contents of first chapter ...
</PRE>

<P>
Полное содержание <TT>`concept-index.texinfo'</TT> может выглядеть так:



<PRE>
@node Concept Index
@unnumbered Concept Index

@printindex cp
</PRE>

<P>
Внешний исходный Texinfo-файл для <CITE>The GNU Emacs Lisp Reference
Manual</CITE> называется <TT>`elisp.texi'</TT>.  Этот внешний файл содержит
главное меню из 417 пунктов и список из 41 включаемого файла.




<H2><A NAME="SEC257" HREF="texinfo_toc.html#TOC257">История развития включаемых файлов</A></H2>

<P>
Когда Info была первоначально создана, было принято делать много
небольших Info-файлов на одну тему.  Каждый Info-файл форматировался из
отдельного исходного Texinfo-файла.  Этот обычай был предназначен для
того, чтобы в Emacs не нужно было создавать большой буфер для хранения
большого Info-файла целиком, когда кто-то хотел получить информацию;
вместо этого Emacs выделял ровно столько памяти, сколько нужно для
маленького Info-файла, содержащего нужную информацию.  Таким образом
Emacs избегал лишнего расхода памяти.


<P>
Ссылки из одного файла в другой делались путем указания и имени файла, и
имени ноды.  (See section <A HREF="texinfo_8.html#SEC82">Ссылки на другие Info-файлы</A>.
Также смотрите section <A HREF="texinfo_9.html#SEC90"><CODE>@xref</CODE> с четырьмя и пятью аргументами</A>.)


<P>
Включение файлов было разработано преимущественно как способ создания
единого, большого печатного руководства из нескольких меньших
Info-файлов.  В печатном руководстве все ссылки были внутри одного
документа, так что TeX мог автоматически определить для них номера
страниц.  Команды форматирования Info использовали включаемые файлы лишь
для создания объединенных именных указателей; каждый отдельный
Texinfo-файл нужно было форматировать для Info индивидуально.  (Каждый
из них, следовательно, должен был содержать свою строку
<CODE>@setfilename</CODE>.)


<P>
Однако, так как большие Info-файлы теперь автоматически разбиваются,
больше нет необходимости сохранять их маленькими.


<P>
Теперь множественные Texinfo-файлы используются преимущественно для
больших документов, таких как <CITE>The GNU Emacs Lisp Reference Manual</CITE>
и для проектов, в которых несколько человек одновременно пишут разные
разделы документа.


<P>
Кроме того, команды форматирования для Info были расширены для работы с
командой <CODE>@include</CODE> так, чтобы создавать единый большой Info-файл,
который разбивается при необходимости на меньшие файлы.  Это означает,
что вы можете писать меню и перекрестные ссылки не обращаясь к различным
Texinfo-файлам.
<P><HR><P>
Go to the <A HREF="texinfo_1.html">first</A>, <A HREF="texinfo_25.html">previous</A>, <A HREF="texinfo_27.html">next</A>, <A HREF="texinfo_33.html">last</A> section, <A HREF="texinfo_toc.html">table of contents</A>.
</BODY>
</HTML>
