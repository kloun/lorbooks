<HTML>
<HEAD>
<!-- Created by texi2html 1.56k from cvs-ru.texi on 11 April 2001 -->

<TITLE>CVS -- Система Управления Параллельными Версиями - Начинаем проект под CVS</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="cvs-ru_1.html">first</A>, <A HREF="cvs-ru_2.html">previous</A>, <A HREF="cvs-ru_4.html">next</A>, <A HREF="cvs-ru_24.html">last</A> section, <A HREF="cvs-ru_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="SEC38" HREF="cvs-ru_toc.html#TOC38">Начинаем проект под CVS</A></H1>
<P>
<A NAME="IDX214"></A>
<A NAME="IDX215"></A>
<A NAME="IDX216"></A>
<A NAME="IDX217"></A>


<P>
Так как переименование файлов и перемещение их между каталогами
слегка неудобно, первое, что вам следует сделать, когда вы
начинаете новый проект -- продумать организацию файлов.
Собственно, перемещать и переименовывать файлы можно, но это,
во-первых, увеличивает возможность недопонимания, а во-вторых, у
CVS есть некоторые неполадки, например, при переименовании
каталогов.  See section <A HREF="cvs-ru_7.html#SEC69">Перемещение и переименование файлов</A>


<P>
Дальнейшие действия зависят от конкретной ситуации.




<H2><A NAME="SEC39" HREF="cvs-ru_toc.html#TOC39">Помещение файлов в репозиторий</A></H2>

<P>
Первым шагом будет создание файлов в репозитории.  Это может быть 
сделано несколькими различными способами.




<H3><A NAME="SEC40" HREF="cvs-ru_toc.html#TOC40">Создание дерева каталогов из нескольких файлов</A></H3>
<P>
<A NAME="IDX218"></A>


<P>
Когда вы начнете использовать CVS, вы, скорее всего, уже
имеете несколько проектов, которые можно поместить под контроль
CVS.  В этих случаях самым простым методом будет
использование команды <CODE>import</CODE>.  Самым простым объяснением,
вероятно, будет привести пример.  Если файлы, которые вы хотите
поместить под CVS, находятся в <TT>`<VAR>wdir</VAR>'</TT>, а вы
хотите, чтобы они появились в репозитории в каталоге
<TT>`$CVSROOT/yoyodyne/<VAR>rdir</VAR>'</TT>, вы можете сказать:



<PRE>
$ cd <VAR>wdir</VAR>
$ cvs import -m "Imported sources" yoyodyne/<VAR>rdir</VAR> yoyo start
</PRE>

<P>
Если вы не укажете журнальное сообщение с помощью ключа командной
строки <SAMP>`-m'</SAMP>, то CVS запустит редактор, в котором можно
будет набрать это сообщение.  Строка <SAMP>`yoyo'</SAMP> -- это <EM>тэг
производителя</EM>, а <SAMP>`start'</SAMP> -- это <EM>тэг релиза</EM>.  В
данном контексте они могут не иметь назначения, но CVS
требует их присутствия.  See section <A HREF="cvs-ru_13.html#SEC103">Слежение за чужими исходными текстами</A>,
за дальнейшей информацией.


<P>
Теперь вы можете проверить, что все работает и удалить ваш
исходный каталог.



<PRE>
$ cd ..
$ mv <VAR>dir</VAR> <VAR>dir</VAR>.orig
$ cvs checkout yoyodyne/<VAR>dir</VAR>       # объяснение следует
$ diff -r <VAR>dir</VAR>.orig yoyodyne/<VAR>dir</VAR>
$ rm -r <VAR>dir</VAR>.orig
</PRE>

<P>
Было бы неплохо удалить изначальные файлы, чтобы случайно не
начать редактировать их в <VAR>dir</VAR> без использования CVS.
Конечно же, перед удалением хорошо было бы убедиться, что у вас
есть резервная копия исходных текстов.


<P>
Команда <CODE>checkout</CODE> получает в качестве аргумента имя модуля
(как в предыдущих примерах) или имя каталога относительно
<CODE>$CVSROOT</CODE>, как в вышеприведенном примере.


<P>
Хорошо было бы проверить, что права доступа на созданные CVS 
каталоги правильны, и что эти каталоги принадлежат должным
группам.  See section <A HREF="cvs-ru_2.html#SEC13">Права доступа к файлам</A>


<P>
Если какие-то из файлов, которые нужно импортировать, являются
бинарными, вам потребуется использовать <EM>обертки</EM>, чтобы
указать, какие именно.  See section <A HREF="cvs-ru_18.html#SEC160">Файл <TT>`cvswrappers'</TT></A>.




<H3><A NAME="SEC41" HREF="cvs-ru_toc.html#TOC41">Создание файлов из других систем контроля версий</A></H3>
<P>
<A NAME="IDX219"></A>


<P>
Если у вас есть проект, который обслуживается другой системой
контроля версий, например, RCS, вы можете захотеть поместить 
эти файлы под управление CVS и сохранить историю изменения
этих файлов.


<DL COMPACT>

<DT>Из RCS
<DD>
<A NAME="IDX220"></A>
 <A NAME="IDX221"></A>
 
Если вы использовали RCS, найдите все RCS-файлы, обычно
файлу <TT>`foo.c'</TT> будет соответствовать файл <TT>`RCS/foo.c,v'</TT>
(этот файл может также находиться в другом месте, обратитесь к
документации на RCS.  Затем создайте соответствующие
каталоги в CVS, если они еще не существуют.  Затем
скопируйте файл в соответствующие каталоги в репозитории (имя в
репозитории должно совпадать с именем исходного файла с
добавленным <SAMP>`,v'</SAMP>; файлы находятся прямо в соответствующем
каталоге репозитория, а не в подкаталоге <TT>`RCS/'</TT>.  Это ---
один из редких случаев, когда желателен прямой доступ к
репозиторию, без использования команд CVS.  Теперь вы можете
извлечь новый рабочий каталог.

RCS-файл не должен быть заблокирован, когда вы перемещаете
его под управление CVS, иначе у CVS будут проблемы при
работе с этим файлом.

<DT>Из другой системы контроля версий
<DD>
Многие системы контроля версий способны экспортировать
RCS-файлы в стандартном формате.  Если ваша система умеет
так делать, экспортируйте RCS-файлы и следуйте
вышеприведенным инструкциям.

Если это не так, вероятно, лучшим выходом будет написать скрипт,
который извлекает каждую ревизию файла, используя интерфейс
командной строки старой системы, а затем фиксирующий эти ревизии
в CVS.  Скрипт <TT>`sccs2rcs'</TT>, упомянутый ниже, является
хорошим примером.

<A NAME="IDX222"></A>
<A NAME="IDX223"></A>
<DT>Из SCCS
<DD>
В каталоге <TT>`contrib/'</TT> среди исходных текстов CVS есть
скрипт <TT>`sccs2rcs'</TT>, конвертирующий файлы SCCS в файлы
RCS.  Замечание: вы должны выполнить этот скрипт на машине,
на которой установлен как SCCS, так и RCS, и этот
скрипт не поддерживается.

<A NAME="IDX224"></A>
<A NAME="IDX225"></A>
<DT>Из PVCS
<DD>
В каталоге <TT>`contrib/'</TT> среди исходных текстов CVS есть
скрипт <TT>`pvcs_to_rcs'</TT>, конвертирующий архивы PVCS в
файлы RCS.  Вы должны выполнить этот скрипт на машине, на
которой установлены как PVCS, так и RCS, и как и все
прочее в каталоге <TT>`contrib/'</TT>, этот скрипт не
поддерживается.  Детали описаны в комментариях к скрипту.
</DL>



<H3><A NAME="SEC42" HREF="cvs-ru_toc.html#TOC42">Создание дерева каталогов с нуля</A></H3>

<P>
Для нового проекта самоым простым способом, вероятно, будет
создать пустую структуру каталогов, например:



<PRE>
$ mkdir tc
$ mkdir tc/man
$ mkdir tc/testing
</PRE>

<P>
Затем используйте команду <CODE>import</CODE>, чтобы создать
соответствующую (пустую) структуру каталогов внутри репозитория:



<PRE>
$ cd tc
$ cvs import -m "Created directory structure" yoyodyne/<VAR>dir</VAR> yoyo start
</PRE>

<P>
Затем используйте команду <CODE>add</CODE>, чтобы добавлять файлы и
новые каталог по мере их появления.


<P>
Убедитесь, что права доступа, которые CVS дает новым
каталогам в <SAMP>`$CVSROOT'</SAMP>, правильны.




<H2><A NAME="SEC43" HREF="cvs-ru_toc.html#TOC43">Определение модуля</A></H2>
<P>
<A NAME="IDX226"></A>
<A NAME="IDX227"></A>
<A NAME="IDX228"></A>
<A NAME="IDX229"></A>
<A NAME="IDX230"></A>


<P>
Следующим шагом будет определение модуля в файле <TT>`modules'</TT>.
Это необязательно, но модули удобны для группирования связанных
файлов и каталогов.


<P>
В простых случаях нижеследующих шагов достаточно для определения
модуля. 



<OL>
<LI>

извлеките рабочую копию файла <TT>`modules'</TT>:


<PRE>
$ cvs checkout CVSROOT/modules
$ cd CVSROOT
</PRE>

<LI>

отредактируйте этот файл, вставив в него строку, определяющую
модуль.  См. See section <A HREF="cvs-ru_2.html#SEC20">Административные файлы</A>.
See section <A HREF="cvs-ru_18.html#SEC154">Файл <TT>`modules'</TT></A> за полным описанием файла <TT>`modules'</TT>.
Например, для описания модуля <SAMP>`tc'</SAMP> можно использовать такую
строку:


<PRE>
tc   yoyodyne/tc
</PRE>

<LI>

зафиксируйте ваши изменения в файле <TT>`modules'</TT>


<PRE>
$ cvs commit -m "Added the tc module." modules
</PRE>

<LI>

Освободите модуль <CODE>CVSROOT</CODE>.


<PRE>
$ cd ..
$ cvs release -d CVSROOT
</PRE>

</OL>

<P><HR><P>
Go to the <A HREF="cvs-ru_1.html">first</A>, <A HREF="cvs-ru_2.html">previous</A>, <A HREF="cvs-ru_4.html">next</A>, <A HREF="cvs-ru_24.html">last</A> section, <A HREF="cvs-ru_toc.html">table of contents</A>.
</BODY>
</HTML>
