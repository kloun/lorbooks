<HTML>
<HEAD>
<!-- Created by texi2html 1.56k from cvs-ru.texi on 11 April 2001 -->

<TITLE>CVS -- Система Управления Параллельными Версиями - Слежение за чужими исходными текстами</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="cvs-ru_1.html">first</A>, <A HREF="cvs-ru_12.html">previous</A>, <A HREF="cvs-ru_14.html">next</A>, <A HREF="cvs-ru_24.html">last</A> section, <A HREF="cvs-ru_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="SEC103" HREF="cvs-ru_toc.html#TOC103">Слежение за чужими исходными текстами</A></H1>
<P>
<A NAME="IDX459"></A>
<A NAME="IDX460"></A>


<P>
Если вы изменяете программу, чтобы она лучше подходила к вашей
системе, вам, вероятно, захочется сделать те же самые
модификации, когда появляется новая версия программы.  CVS
поможет вам с этой задачей.


<P>
<A NAME="IDX461"></A>
<A NAME="IDX462"></A>
В терминологии, используемой в CVS, поставщик программы
называется <EM>производителем</EM>.  Неизмененный комплект поставки
помещается на отдельную ветку, которая называется <EM>ветка
производителя</EM>.  CVS резервирует для этой цели ветку с
номером 1.1.1.


<P>
Когда вы изменяете исходный текст и фиксируете его, ваши
изменения окажутся в основном стволе.  Когда поставщик выпускает
новую версию, вы помещаете её на ветку производителя и копируете
изменения в основной ствол.


<P>
Используйте команду <CODE>import</CODE> для создания и обновления ветки
производителя.  Когда вы импортируете новый файл, ветка
производителя становится "головной" ревизией (<CODE>HEAD</CODE>),
поэтому все, кто извлекает копию файла, получают эту ревизию.
Когда локальные модификации фиксируются, они помещаются в
основной ствол и становятся "головной" (<CODE>HEAD</CODE>) ревизией.




<H2><A NAME="SEC104" HREF="cvs-ru_toc.html#TOC104">Начальный импорт</A></H2>
<P>
<A NAME="IDX463"></A>


<P>
Используйте команду <CODE>import</CODE> для начального помещения
исходных текстов в репозиторий.  Для отслеживания чужих
исходников полезно использовать <EM>метки поставщика</EM> и
<EM>метки релизов</EM>.  <EM>Метка поставщика</EM> -- это
символическое имя ветки (всегда имеющей номер 1.1.1, если вы не
использовали флаг <SAMP>`-b <VAR>ветка</VAR>'</SAMP> (See section <A HREF="cvs-ru_13.html#SEC109">Несколько веток поставщика</A>).  <EM>Метки релизов</EM> -- это символические имена
конкретной версии продукта, например, <SAMP>`FSF_0_04'</SAMP>.


<P>
Заметьте, что <CODE>import</CODE> <EM>не</EM> изменяет каталог, в котором
вызвана эта команда.  В частности, этот каталог не становится
рабочим каталогом для CVS; если вы хотите работать с
исходными текстами, сначала импортируйте их, затем извлеките их в
другом каталоге (see section <A HREF="cvs-ru_1.html#SEC5">Получение исходного кода</A>).


<P>
<A NAME="IDX464"></A>
Предположим, что у вас имеются исходные тексты программы, которая
называется <CODE>wdiff</CODE>, находящиеся в каталоге
<TT>`wdiff-0.04'</TT>, и вы хотите сделать изменения для себя, и
сохранить их, когда появится новая версия.  Начните с импорта
исходных текстов в репозиторий:



<PRE>
$ cd wdiff-0.04
$ cvs import -m "Import of FSF v. 0.04" fsf/wdiff FSF_DIST WDIFF_0_04
</PRE>

<P>
В вышеприведенном примере метка поставщика называется
<SAMP>`FSF_DIST'</SAMP>, а единственная присвоенная метка релиза ---
<SAMP>`WDIFF_0_04'</SAMP>.




<H2><A NAME="SEC105" HREF="cvs-ru_toc.html#TOC105">Обновление с помощью импорта</A></H2>

<P>
Когда появляется новая версия исходных текстов, вы импортируете
их в репозиторий с помощью такой же команды <CODE>import</CODE>,
которую вы использовали для начального импорта в репозиторий.
Единственное различие -- теперь вы используете другую метку
релиза.



<PRE>
$ tar xfz wdiff-0.05.tar.gz
$ cd wdiff-0.05
$ cvs import -m "Import of FSF v. 0.05" fsf/wdiff FSF_DIST WDIFF_0_05
</PRE>

<P>
Для файлов, которые не были локально изменены, новые созданные
ревизии становятся головными ревизиями.  Если же локальные
изменения были сделаны, <CODE>import</CODE> предупредит вас, что вы
должны слить изменения в основной ствол и посоветует использовать 
для этого <SAMP>`checkout -j'</SAMP>.



<PRE>
$ cvs checkout -jFSF_DIST:yesterday -jFSF_DIST wdiff
</PRE>

<P>
Вышеуказанная команда извлечет последнюю версию <SAMP>`wdiff'</SAMP>,
объединяя в рабочую копию изменения, сделанные на ветке
поставщика <SAMP>`FSF_DIST'</SAMP> со вчерашнего дня.  Если в процессе
слияния появляются конфликты, то их нужно разрешить обычным
способом (see section <A HREF="cvs-ru_10.html#SEC85">Пример конфликта</A>), затем измененные файлы можно 
зафиксировать.


<P>
Использование даты, как предлагается выше, предполагает, что вы
импортируете не более одной версии продукта в день.  Если же это
не так, вы всегда можете использовать что-нибудь типа такого:



<PRE>
$ cvs checkout -jWDIFF_0_04 -jWDIFF_0_05 wdiff
</PRE>

<P>
В этом случае вышеприведенные команды эквивалентны.




<H2><A NAME="SEC106" HREF="cvs-ru_toc.html#TOC106">Возврат к последней версии от поставщика</A></H2>

<P>
Вы также можете полностью отменить локальные изменения и
вернуться к последней версии от поставщика, установив головную
ревизию в ветку поставщика для всех файлов.  Например, если у вас 
есть извлеченная копия исходников в <TT>`~/work.d/wdiff'</TT>, и вы
хотите вернуть все файлы в этом каталоге в то состояние, в
котором вам предоставил их поставщик, напечатайте:



<PRE>
$ cd ~/work.d/wdiff
$ cvs admin -bWDIFF .
</PRE>

<P>
Вы должны написать <SAMP>`-bWDIFF'</SAMP> без пробелов после <SAMP>`-b'</SAMP>.
See section <A HREF="cvs-ru_16.html#SEC119">Ключи команды admin</A>.




<H2><A NAME="SEC107" HREF="cvs-ru_toc.html#TOC107">Как обрабатывать двоичные файлы при импорте в CVS</A></H2>

<P>
Используйте опцию <SAMP>`-k'</SAMP>, чтобы сказать команде <SAMP>`import'</SAMP>, 
что файлы являются двоичными.  See section <A HREF="cvs-ru_18.html#SEC160">Файл <TT>`cvswrappers'</TT></A>.




<H2><A NAME="SEC108" HREF="cvs-ru_toc.html#TOC108">Как обрабатывать замену ключевых слов при импорте в CVS</A></H2>

<P>
Исходные тексты, которые вы импортируете, могут содержать
ключевые слова (see section <A HREF="cvs-ru_12.html#SEC97">Подстановка ключевых слов</A>).  Например,
поставщик мог использовать CVS или какую-нибудь другую
систему, которая использует похожий синтаксис подстановки
ключевых слов.  Если вы просто импортируете файлы, то содержимое
ключевых слов будет заменены вашим CVS.  Вероятно, более
удобно будет оставить ключевые слова в том виде, в котором они
были у вашего поставщика, чтобы сохранить информацию об исходных
текстах.


<P>
Чтобы сохранить содержимое ключевых слов, добавьте к команде
<CODE>cvs import</CODE> при первом импорте ключ <SAMP>`-ko'</SAMP>.  Это полностью
выключит замену ключевых слов для этого файла, поэтому если
хотите, то можете выборочно использовать разные ключи <SAMP>`-k'</SAMP> с 
командами <CODE>cvs update</CODE> и <CODE>cvs admin</CODE>.




<H2><A NAME="SEC109" HREF="cvs-ru_toc.html#TOC109">Несколько веток поставщика</A></H2>

<P>
Все примеры до этого момента подразумевали, что есть только один
поставщик, от которого вы получаете исходные тексты.  В некоторых 
ситуациях вы можете получать эти тексты из разных мест.
Например, предположим, что вы работаете в проекте, в котором
много различных людей и команд изменяют исходный код продукта.
Существуют различные способы работы в такой ситуации, но иногда у 
вас есть несколько деревьев исходников, лежащих рядом, и всё, что 
вы хотите сделать -- это положить их под CVS, чтобы они по
крайней мере находились в одном месте.


<P>
Для обработки ситуаций, в которых поставщиков больше одного, вы
можете задать команде <CODE>cvs import</CODE> ключ <SAMP>`-b'</SAMP>.  Этот
ключ принимает в качестве параметра номер ветки поставщика.  По
умолчанию это <SAMP>`-b 1.1.1'</SAMP>.


<P>
Например, предположим, что есть две команды: красная и синяя, и
обе посылают вам исходные тексты.  Вы хотите импортировать
результаты работы красной команды в ветку 1.1.1 и использовать
метку поставщика <SAMP>`RED'</SAMP>.  Вы также хотите импортировать
работу синей команды на ветку 1.1.3 и использовать метку
поставщика <SAMP>`BLUE'</SAMP>.  Вы можете использовать такие команды:



<PRE>
$ cvs import dir RED RED_1-0
$ cvs import -b 1.1.3 dir BLUE BLUE_1-5
</PRE>

<P>
Заметьте, что если метка поставщика не соответствует ключу
<SAMP>`-b'</SAMP>, то CVS не обнаружит этот случай!  Например,



<PRE>
$ cvs import -b 1.1.3 dir RED RED_1-0
</PRE>

<P>
Будьте осторожны; такие ошибки совершенно точно приведут, в
лучшем случае, к недоразумениям.  Не могу придумать полезной цели
для возможности намеренного несовпадения в этом месте, а если вы
придумаете такой способ, то не используйте его.  Скорее всего, в
следующих версиях CVS это станет ошибкой.


<P><HR><P>
Go to the <A HREF="cvs-ru_1.html">first</A>, <A HREF="cvs-ru_12.html">previous</A>, <A HREF="cvs-ru_14.html">next</A>, <A HREF="cvs-ru_24.html">last</A> section, <A HREF="cvs-ru_toc.html">table of contents</A>.
</BODY>
</HTML>
