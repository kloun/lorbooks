<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Мини-HOWTO: Ultra-DMA в Linux</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.57"></HEAD
><BODY
CLASS="ARTICLE"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="ARTICLE"
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
><A
NAME="AEN2"
>Мини-HOWTO: Ultra-DMA в Linux</A
></H1
><DIV
CLASS="AUTHORGROUP"
><A
NAME="AEN4"
></A
><H3
CLASS="AUTHOR"
><A
NAME="AEN5"
>Brion Vibber</A
></H3
><DIV
CLASS="AFFILIATION"
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
>&nbsp;&nbsp;&nbsp;&nbsp;     brion@pobox.com
    <br>
&nbsp;&nbsp;&nbsp;</P
></DIV
></DIV
><H3
CLASS="CORPAUTHOR"
> Перевод: <A
HREF="mailto:pax@asp-linux.com"
TARGET="_top"
>Павел Гашев</A
>,
 <A
HREF="http://www.asplinux.com"
TARGET="_top"
>SWSoft Pte Ltd.</A
>
 </H3
></DIV
><P
CLASS="PUBDATE"
>версия 3.0, 9 ноября 1999 года <BR></P
><DIV
><DIV
CLASS="ABSTRACT"
><A
NAME="AEN15"
></A
><P
></P
><P
>В этом документе объясняется, как использовать жесткие диски и интерфейсы Ultra-DMA, Ultra-ATA, Ultra33 и Ultra66 в Linux. Более свежую версию этого мини-HOWTO вы можете найти по адресу: <A
HREF="http://pobox.com/~brion/linux/Ultra-DMA.html"
TARGET="_top"
>http://pobox.com/~brion/linux/Ultra-DMA.html</A
>.</P
><P
></P
></DIV
></DIV
><HR></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Содержание</B
></DT
><DT
>1. <A
HREF="Ultra-DMA.html#MAIN-INTRO"
>Введение</A
></DT
><DD
><DL
><DT
>1.1. <A
HREF="Ultra-DMA.html#DISCLAIMER"
>Ответственность</A
></DT
><DT
>1.2. <A
HREF="Ultra-DMA.html#CREDITS"
>Благодарности</A
></DT
><DT
>1.3. <A
HREF="Ultra-DMA.html#HISTORY"
>История документа</A
></DT
><DT
>1.4. <A
HREF="Ultra-DMA.html#COPYING"
>Copying</A
></DT
><DT
>1.5. <A
HREF="Ultra-DMA.html#AEN68"
>Авторские права</A
></DT
></DL
></DD
><DT
>2. <A
HREF="Ultra-DMA.html#UDMA-INTRO"
>Что такое Ultra-DMA, и зачем мне это надо?</A
></DT
><DD
><DL
><DT
>2.1. <A
HREF="Ultra-DMA.html#CLASSIC"
>IDE, EIDE и ATAPI</A
></DT
><DT
>2.2. <A
HREF="Ultra-DMA.html#BM"
>Bus Master DMA</A
></DT
><DT
>2.3. <A
HREF="Ultra-DMA.html#UDMA"
>Ultra-DMA он же Ultra-ATA он же Ultra33 он же...</A
></DT
><DT
>2.4. <A
HREF="Ultra-DMA.html#SPEED"
>По крайней мере "Ultra"?</A
></DT
><DT
>2.5. <A
HREF="Ultra-DMA.html#UDMA-VS-SCSI"
>UDMA или SCSI?</A
></DT
></DL
></DD
><DT
>3. <A
HREF="Ultra-DMA.html#UDMA-ON-EIDE"
>Использование жестких дисков UDMA с интерфейсом EIDE</A
></DT
><DT
>4. <A
HREF="Ultra-DMA.html#USING-UDMA"
>Использование жестких дисков с интерфейсом UDMA</A
></DT
><DT
>5. <A
HREF="Ultra-DMA.html#PCI"
>Интерфейсы UDMA в виде PCI плат</A
></DT
><DD
><DL
><DT
>5.1. <A
HREF="Ultra-DMA.html#PROMISE"
>Promise Ultra33</A
></DT
><DT
>5.2. <A
HREF="Ultra-DMA.html#PROMISE66"
>Promise Ultra66</A
></DT
><DT
>5.3. <A
HREF="Ultra-DMA.html#ARTOP"
>Artop ATP850UF</A
></DT
><DT
>5.4. <A
HREF="Ultra-DMA.html#AEN216"
>Добавление файлов устройств</A
></DT
></DL
></DD
><DT
>6. <A
HREF="Ultra-DMA.html#ONBOARD"
>Встроенные интерфейсы UDMA</A
></DT
><DD
><DL
><DT
>6.1. <A
HREF="Ultra-DMA.html#INTEL"
>Intel FX, HX, VX, TX, LX, and BX</A
></DT
><DT
>6.2. <A
HREF="Ultra-DMA.html#VIA"
>VIA VP2 и похожие чипсеты</A
></DT
><DT
>6.3. <A
HREF="Ultra-DMA.html#AEN244"
>TX Pro и другие "Pro"</A
></DT
><DT
>6.4. <A
HREF="Ultra-DMA.html#HPT366"
>HPT 366</A
></DT
></DL
></DD
><DT
>7. <A
HREF="Ultra-DMA.html#UNIFIED"
>Унифицированные патчи IDE</A
></DT
><DT
>8. <A
HREF="Ultra-DMA.html#ACTIVATE"
>Активирование и деактивирование UDMA</A
></DT
><DD
><DL
><DT
>8.1. <A
HREF="Ultra-DMA.html#BOOTPARAM"
>Использование параметров запуска ядра</A
></DT
><DT
>8.2. <A
HREF="Ultra-DMA.html#HDPARM"
>Использование hdparm</A
></DT
></DL
></DD
><DT
>9. <A
HREF="Ultra-DMA.html#AEN316"
>Проблемы</A
></DT
><DD
><DL
><DT
>9.1. <A
HREF="Ultra-DMA.html#BLACKLIST"
>Черный список UDMA</A
></DT
><DT
>9.2. <A
HREF="Ultra-DMA.html#AEN330"
>Разгоняете?</A
></DT
><DT
>9.3. <A
HREF="Ultra-DMA.html#AEN335"
>У вас новый BIOS?</A
></DT
><DT
>9.4. <A
HREF="Ultra-DMA.html#HELP"
>Если вы все еще не можете заставить его работать!</A
></DT
></DL
></DD
><DT
>10. <A
HREF="Ultra-DMA.html#SUGGEST"
>Если у вас есть информация о UDMA, которой нет в этом mini-howto:</A
></DT
></DL
></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="MAIN-INTRO"
>1. Введение</A
></H1
><P
>В этом документе объясняется, как использовать жесткие диски с интерфейсом Ultra-DMA, Ultra-ATA, Ultra33, Ultra66 в Linux. Во многих случаях в их использовании нет ничего сложного, но некоторые действия могут повысить производительность. Однако, в некоторых случаях вам нужно сильно постараться, чтобы все это настроить. </P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="DISCLAIMER"
>1.1. Ответственность</A
></H2
><P
>Информация в этом документе, насколько я знаю, правильна и должна работать.
Тем не менее, здесь могут быть опечатки, здесь могут быть какие-нибудь
мистические ошибки, возникшие во время передачи, и здесь может быть
странная несовместимость именно с вашей системой, так что это может
работать не так, как надо. Так что... перед тем как вы начнете возиться со
своим жестким диском, <I
CLASS="EMPHASIS"
>СОХРАНИТЕ ВСЮ НЕОБХОДИМУЮ ИНФОРМАЦИЮ В ДРУГОМ МЕСТЕ!</I
>
Если вы нерегулярно сохраняете вашу информацию, то лучше сделать это
прямо сейчас.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="CREDITS"
>1.2. Благодарности</A
></H2
><P
><A
HREF="mailto:giovanni@sudfr.com"
TARGET="_top"
>Michel Aubry</A
> - Патч для включения UDMA на VIA для ядра &#60;=2.0.33 &#38; другая информация, большой унифицированный патч UDMA для 2.0.34+ </P
><P
><A
HREF="mailto:andrebalsa@altern.org"
TARGET="_top"
>Andrew Balsa</A
> - Предоставил некоторую важную информацию по UDMA и общий патч для UDMA для Intel TX, SiS и VP1 на ядрах &#60;=2.0.33; а также большой унифицированный патч UDMA для 2.0.34+ </P
><P
>Maxime Baudin - Французкий перевод</P
><P
>Bokonon - "Контроллер" на "интерфейс" </P
><P
><A
HREF="mailto:prefect@ipass.net"
TARGET="_top"
>John G.</A
> -
- Патч VIA VP2 для &#60;=2.0.33 &#38; информация</P
><P
>Martin Gaitan - Работа по установке Promise Ultra33 ide0/ide1 </P
><P
><A
HREF="mailto:andre@suse.com"
TARGET="_top"
>Andre M. Hedrick</A
> - текущий сопроводитель подсистемы IDE Linux </P
><P
>Hеvard Tautra Knutsen - Норвежский перевод</P
><P
>Norman Jacobowitz - Заставил меня добавить информацию о VP3 </P
><P
>John Levon - Информация о материнских платах TX Pro </P
><P
>Peter Monta - Информация по использованию двух карт Ultra33 </P
><P
>Masayoshi Nakano - Японский перевод</P
><P
><A
HREF="mailto:gadio@netvision.net.il"
TARGET="_top"
>Gadi Oxman</A
> - Патч для Promise Ultra33 для ядра &#60;=2.0.34 и нахождение "секретных чисел"</P
><P
>Andy Pearce - Предложено добавить информацию о дополнительных файлах устройств hde-h </P
><P
><A
HREF="mailto:pink@roedu.net"
TARGET="_top"
>Andrei Pitis</A
> - Патч для LILO </P
><P
><A
HREF="mailto:brion@pobox.com"
TARGET="_top"
>Brion Vibber</A
> - Сам документ</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="HISTORY"
>1.3. История документа</A
></H2
><P
>Версия 3.0, 9 ноября 1999: Наконец нашлось время произвести некоторые ключевые изменения, такие как указание архива патчей IDE на <A
HREF="http://www.kernel.org/pub/linux/kernel/people/hedrick"
TARGET="_top"
>Kernel.org archives</A
> надоедливая школа! Все ссылки sunsite обновлены на новые <A
HREF="ftp://metalab.unc.edu"
TARGET="_top"
>metalab.unc.edu</A
> или <A
HREF="http://www.linuxdoc.org"
TARGET="_top"
>www.linuxdoc.org</A
></P
><P
>v2.1, 27 мая 1999: Исправлены некоторые незначительные упущения и ошибки 2.0, и добавлена информация о Promise Ultra66 и ядрах 2.2/2.3. </P
><P
>v2.0, 7 августа 1998: Значительные изменения и почти полная реструктуризация документа на встроенные интерфейсы и дополнительные интерфейсные платы; Большой Унифицированный патч UDMA (часть Гигантского патча) для 2.0.35. Добавлены благодарности в алфавитном порядке по фамилии. "Контроллер" в большинстве случаев изменен на более технически правильный "интерфейс". Добавлена информация о включении/выключении UDMA, черный список, и еще кое-что!</P
><P
>v1.45, 6 июля 1998: Незначительные изменения - патч для Red Hat 5.1 и 2.0.34 для Promise Ultra33, патч LILO для загрузки с PCI интерфейса (Promise Ultra33)</P
><P
>v1.41, 3 мая 1998: Исправлена пара опечаток, добавлены благодарности переводчикам. </P
><P
>v1.4, 28 апреля 1998: UDMA-Generic patch, некоторая общая информация. Добавлен раздел Копирование. </P
><P
>v1.3, 5 марта 1998: Информация о VIA VP3, лучшие инструкции по выполнению патча, указатель на более свежий патч Promise. </P
><P
>v1.2, 27 января 1998: Дополнительная информация по работе с Promise. </P
><P
>v1.1, 21 января 1998: Новая информация о чипсете VIA, установка через интерфейс Promise Ultra33, и включение режимов передачи Bus Master &#38; UDMA. </P
><P
>v1.0, 19 января 1998: Более менее законченная первая версия в формате SGML. </P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="COPYING"
>1.4. Copying</A
></H2
><P
>This document may be freely copied and distributed for informational
purposes. It may not be modified, except for reformatting, without the
permission of the author. If you wish to translate this document into another
language you may do so, however you should contact the author first so that
updated versions of this document can be sent out to translators as well as
directly to the Linux Documentation Project.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN68"
>1.5. Авторские права</A
></H2
><P
>Авторские права на русский перевод этого текста принадлежат &copy; 2000 SWSoft Pte Ltd.
Все права зарезервированы.</P
><P
>Этот документ является частью проекта Linux HOWTO.</P
><P
>Авторские права на документы Linux HOWTO принадлежат их авторам, если явно
не указано иное. Документы Linux HOWTO, а также их переводы, могут
быть воспроизведены и распространены полностью или частично на любом
носителе, физическом или электронном, при условии сохранения этой заметки об
авторских правах на всех копиях. Коммерческое распространение разрешается и
поощряется; но, так или иначе, автор текста и автор перевода желали бы знать о
таких дистрибутивах.</P
><P
>Все переводы и производные работы, выполненные по документам Linux HOWTO,
должны сопровождаться этой заметкой об авторских правах. Это делается в
целях предотвращения случаев наложения дополнительных ограничений на
распространение документов HOWTO. Исключения могут составить случаи
получения специального разрешения у координатора Linux HOWTO, с которым
можно связаться по адресу приведенному ниже.</P
><P
>Мы бы хотели распространить эту информацию по всем возможным каналам. Но
при этом сохранить авторские права и быть уведомленными о всех планах
распространения HOWTO. Если у вас возникли вопросы, пожалуйста, обратитесь
к координатору проекта Linux HOWTO по электронной почте:
<TT
CLASS="EMAIL"
>&#60;<A
HREF="mailto:linux-howto@metalab.unc.edu"
>linux-howto@metalab.unc.edu</A
>&#62;</TT
> или к координатору русского
перевода Linux HOWTO компании SWSoft Pte Ltd. по адресу
<TT
CLASS="EMAIL"
>&#60;<A
HREF="mailto:linux-howto@asplinux.ru"
>linux-howto@asplinux.ru</A
>&#62;</TT
></P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="UDMA-INTRO"
>2. Что такое Ultra-DMA, и зачем мне это надо?</A
></H1
><P
>Вот краткий обзор технологий IDE дисков: </P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="CLASSIC"
>2.1. IDE, EIDE и ATAPI</A
></H2
><P
>Это старые технологии. Большинство жестких дисков и не-SCSI интерфейсов, которые вы можете купить сегодня или уже используете - EIDE, хотя множество винчестеров большой емкости - UDMA. </P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="BM"
>2.2. Bus Master DMA</A
></H2
><P
>Bus Master DMA - это технология, повышающая скорость обмена с жестким диском, требующая поддержки материнской платы, BIOS и, по крайней мере, какой-то поддержки от самого жесткого диска.</P
><P
>Подробнее смотрите на <A
HREF="http://developer.intel.com/design/pcisets/busmastr/FAQs.htm"
TARGET="_top"
>http://developer.intel.com/design/pcisets/busmastr/FAQs.htm</A
>.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="UDMA"
>2.3. Ultra-DMA он же Ultra-ATA он же Ultra33 он же...</A
></H2
><P
>Ultra-DMA может называться по-разному, но мы его будем называть просто UDMA. </P
><P
>UDMA - это более продвинутая технология, обеспечивающая передачу данных жесткого диска со скоростью до 33.3 Мб/сек в UDMA режиме 2 и 66.7 Мб/сек в режиме 4, что от двух до четырех раз быстрее, чем EIDE, и дешевле, чем SCSI. Много новых компьютеров уже поставляется с UDMA-дисками большого размера и UDMA-интерфейсами, однако возможна установка дополнительной карты UDMA-интерфейса (такой как Promise Ultra33 или Ultra66), чтобы увеличить скорость даже на старых не-UDMA дисках. </P
><P
>Подробнее о UDMA смотрите на 
<A
HREF="http://www.quantum.com/src/whitepapers/ultraata/"
TARGET="_top"
>http://www.quantum.com/src/whitepapers/ultraata/</A
></P
><P
>Замечу, что длина кабеля UDMA, по сравнению с простым DMA, желательно должна быть менее 30см, и не более 18 дюймов. Для скорости 66Мб/сек требуется специальный 80-жильный кабель не большей длины. Если у вас появляется большое количество CRC-ошибок, то попробуйте использовать кабель покороче.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="SPEED"
>2.4. По крайней мере "Ultra"?</A
></H2
><P
>Прежде, чем пойдем дальше, давайте проясним заблуждение. Эти 33 и 66 MB/сек
- <I
CLASS="EMPHASIS"
>максимальная скорость передачи (burst transfer rate)</I
>, а это встречается
не очень часто. Вот кусок из UDMA.txt:</P
><P
>&#13;<PRE
CLASS="SCREEN"
>Быстрый (burst) (немедленный) режим передачи предполагает от 16.6МБ/сек
(PIO режим 4) до 16.6МБ/сек (DMA режим 2) и до 33МБ/сек (UDMA).
Kim-Hoe Pang в своем патче ядра 2.1.55 логически проверил скорость передачи
в максимальном режиме UDMA: 60 нс/слово, что означает 33МБ/сек.

Замечу, что скоростной (burst) режим передачи влияет только на данные,
передаваемые из кэша EIDE винчестера (476Кб на IBM 6.4Гб),
а это IMHO не особенно актуально для большинства пользователей Linux.

Ядро Linux использует для кэширования доступа к винчестеру столько
оперативной памяти, насколько это возможно, и если данные не находятся в
кэше ядра, то мало шансов, что они будут в меньшем по размеру кэше
винчестера.</PRE
>&#13;</P
><P
>Намного большее значение имеет <I
CLASS="EMPHASIS"
>устойчивая скорость передачи (sustained
transfer rate)</I
> - скорость, на которой данные передаются с винчестера в
память. Проще всего использовать <TT
CLASS="LITERAL"
>hdparm</TT
>, чтобы измерить устойчивую скорость
передачи, например "<TT
CLASS="LITERAL"
>hdparm -t /dev/hda</TT
>", для измерения скорости первого IDE
диска.</P
><P
>&#13;<PRE
CLASS="SCREEN"
>Вот некоторые данные, собранные после большого количества испытаний, с
использованием утилиты hdparm (Mark Lord):

PIO в режиме 4 под Linux дает скорость передачи:   +/- 5.2MB/s

DMA в режиме 2 под Linux дает скорость передачи:   +/- 7.2MB/s

UDMA в режиме 2 под Linux дает скорость передачи:  +/- 9.8MB/s</PRE
>&#13;</P
><P
>Как вы можете видеть, UDMA все еще в два раза быстрей обычного EIDE, и все еще значительно быстрей Bus Master DMA. Большинство современных UDMA-дисков дают от 10 до 15 МБ/сек с использованием UDMA в режиме 2 (33 MB/s) или 4 (66 МБ/сек). </P
><P
>Кроме того, использование DMA, в отличии от PIO, значительно сокращает использование процессора во время обмена с диском.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="UDMA-VS-SCSI"
>2.5. UDMA или SCSI?</A
></H2
><P
>Я не могу дать вам точные цифры, но, по общему мнению, SCSI может дать лучшую производительность, чем UDMA. Тем не менее, если вы посмотрите на цены винчестеров, то заметите, что UDMA значительно дешевле. В большинстве случаев, коэффициент цена/производительность говорит в пользу UDMA.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="UDMA-ON-EIDE"
>3. Использование жестких дисков UDMA с интерфейсом EIDE</A
></H1
><P
>Это просто. Все жесткие диски UDMA полностью совместимы с EIDE, просто
включите винчестер в EIDE интерфейс, и у Linux не должно быть проблем с его
определением и использованием .</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="USING-UDMA"
>4. Использование жестких дисков с интерфейсом UDMA</A
></H1
><P
>У меня есть две новости. Одна плохая, другая хорошая. Хорошая новость - UDMA-интерфейс работает как UDMA-винчестерами, так и с EIDE-винчестерами, причем, в любом случае, намного быстрее, чем на обычном EIDE.</P
><P
>Плохая новость - старые версии ядра (2.0.x) полностью не поддерживают UDMA. Новые версии (2.0.x) поддерживают UDMA33. Однако, имеются патчи, включающие поддержку UDMA для ядер, которые этого не делают.</P
><P
>К тому же, некоторые интерфейсы UDMA, выполненные в виде PCI-карт, в отличие от встроенных в материнскую плату, также требуют патч, и, более того, работа с ними достаточно сложна. Собственно для этого и существует данный документ.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="PCI"
>5. Интерфейсы UDMA в виде PCI плат</A
></H1
><P
>Существуют интерфейсы UDMA, выполненные в виде PCI-плат, позволяющие установить поддержку UDMA без замены материнской платы, или для установки четырех дополнительных устройств. К тому же, они изначально устанавливаются на некоторые виды компьютеров (Gateway 2000, Dell).</P
><P
>Большинство из них не поддерживаются старыми ядрами (2.0.x), но многие из них должны работать с ядром 2.2.x и, соответственно, с дистрибутивами, основанными на этих версиях (RedHat 6.0, SuSE 6.1). Тем не менее, некоторые последние платы (например Promise Ultra66) не работают даже с текущими ядрами версий 2.2.x. Если у вас есть такая плата, то либо надо произвести патч ядра, либо установить свежий дистрибутив. В случае, если вам надо установить Linux на жесткий диск, подключенный к такой интерфейсной плате, то придется использовать пару фокусов:</P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="PROMISE"
>5.1. Promise Ultra33</A
></H2
><P
>Это PCI-карта с двумя UDMA-каналами, поддерживающая до четырех устройств 
<A
HREF="http://www.promise.com"
TARGET="_top"
>http://www.promise.com</A
>.
Она поставлялась с ранними моделями компьютеров Gateway 2000 Pentium II. 
&#13;</P
><P
>Ядра 2.0.35 и выше, и все 2.2.x поддерживают Ultra33, и у вас не должно быть проблем с установкой дистрибутивов. Тем не менее, старые версии (2.0.34) не имеют такой поддержки, и вам будет сложно установить старый дистрибутив, если не можете или не хотите использовать новый (например, если это утвержденная версия в вашей организации).</P
><P
><I
CLASS="EMPHASIS"
>Установка Linux и Ultra33 </I
></P
><P
>Хотя существует патч для Ultra33, не так уж просто его применить и пересобрать ядро, если нет инсталлированного Linux. Так что вам понадобятся следующее (спасибо Gadi Oxman'у):</P
><P
>&#13;<PRE
CLASS="SCREEN"
>Если во время инсталляции у вас есть доступ к консоли, использовуйте
команду "cat /proc/pci", чтобы посмотреть установки Promise Ultra33:


    RAID bus interface: Promise Technology Unknown device (rev 1).
      Vendor id=105a. Device id=4d33.
      Medium devsel.  IRQ 12.  Master Capable.  Latency=32.
      I/O at 0xe000.   (a)
      I/O at 0xd804.   (b)
      I/O at 0xd400.   (c)
      I/O at 0xd004.   (d)
      I/O at 0xc800.   (e)

и использовать параметры "ide2=a,b+2 ide3=c,d+2" при запуске ядра.</PRE
>&#13;</P
><P
>В нашем случае это будет "<TT
CLASS="LITERAL"
>ide2=0xe000,0xd806 ide3=0xd400,0xd006</TT
>". Замечу,
что в вашем случае цифры могут отличаться. Если у вас только один винчестер
или два на одном кабеле, то можете не указывать <TT
CLASS="LITERAL"
>ide3</TT
>.</P
><P
><I
CLASS="EMPHASIS"
>Red Hat 5.1:</I
> Загрузитесь с загрузочной дискеты и нажмите "Enter", когда
появится приглашение. Когда запустится ядро, выберите язык, тип клавиатуры
и вид инсталляции. Выберите, откуда будет производиться установка (пока это
не имеет значения). Когда появится "Выберите путь к дистрибутиву", нажмите
Alt-F2, и вы попадете в командный режим. Запустите "<TT
CLASS="LITERAL"
>cat /proc/pci</TT
>", запишите
цифры и снова загрузитесь с загрузочной дискеты. Наберите "<TT
CLASS="LITERAL"
>linux ide2=</TT
>
(цифры как в примере выше) <TT
CLASS="LITERAL"
> ide3=</TT
><I
CLASS="EMPHASIS"
>(еще цифры)</I
>". Теперь можете без проблем
поставить дистрибутив на винчестер. Тем не менее, вы не сможете поставить
LILO. Вместо этого сделайте загрузочную дискету и загрузитесь с нее с теми
же параметрами. Затем вы можете произвести патч ядра.</P
><P
><I
CLASS="EMPHASIS"
>Red Hat 5.0</I
> и <I
CLASS="EMPHASIS"
>Slackware 3.4:</I
> Примерно так же, но программа
инсталляции этих
дистрибутивов не позволяет устанавливать Linux на <TT
CLASS="LITERAL"
>/dev/hde-h</TT
> (устройства на
<TT
CLASS="LITERAL"
>ide2</TT
> и <TT
CLASS="LITERAL"
>ide3</TT
>). В этом случае необходимо использовать <TT
CLASS="LITERAL"
>ide0</TT
> и <TT
CLASS="LITERAL"
>ide1</TT
>, вместо
<TT
CLASS="LITERAL"
>ide2</TT
> и <TT
CLASS="LITERAL"
>ide3</TT
>. Только не забудьте про устройства, необходимые для
инсталляции. Например, если мы хотим поставить Linux c CD-ROM /dev/hdd
(интерфейс ide1 на материнской плате) на винчестер <TT
CLASS="LITERAL"
>/dev/hdd</TT
> (ide2 -
Ultra33), то должны использовать свободный ide0, а ide1 оставить без
изменения. В нашем случае мы должны загрузится с параметром
"ide0=0xe000,0xd806". В Red Hat 5.0 в командный режим можно попасть,
используя "аварийный диск" (rescue disk). В Slackware в командный режим
можно попасть в процессе стандартной установки. Тем не менее, в Red Hat 5.0
трудно загрузить Linux после окончания установки. Если у вас появились
проблемы с загрузкой, попробуйте использовать загрузочный диск из Slackware
                         
<A
HREF="ftp://ftp.cdrom.com/pub/linux/slackware-3.5/bootdsks.144/"
TARGET="_top"
>ftp://ftp.cdrom.com/pub/linux/slackware-3.5/bootdsks.144/</A
>&#13;</P
><P
>С другими дистрибутивами Linux вам придется немного поимпровизировать, но процесс должен быть похож на вышеописанный.
&#13;</P
><P
><I
CLASS="EMPHASIS"
><I
CLASS="EMPHASIS"
>ВАЖНО: </I
></I
>
Без патча (описываемого в разделе "<A
HREF="Ultra-DMA.html#UNIFIED"
><I
>Унифицированные патчи IDE</I
></A
>"),  ядру
<I
CLASS="EMPHASIS"
>необходимы</I
> эти параметры, чтобы иметь доступ к диску! Следовательно, вы
должны сконфигурировать LILO, вне зависимости, находится ли оно на
винчестере или на флоппи-диске. Вы должны указать <I
CLASS="EMPHASIS"
>те же самые параметры</I
>,
что и во время инсталляции, иначе система не загрузится! И
придется указывать эти параметры вручную для LILO. Также вы можете, как
можно быстрее, произвести патч ядра, и больше не придется беспокоится о
параметрах загрузки. И еще, не существует возможности передать параметры
ядру, находящемуся на флоппи-диске (сделанному при помощи "<TT
CLASS="LITERAL"
>make zdisk</TT
>"),
т.е. вы <I
CLASS="EMPHASIS"
>должны</I
> использовать LILO (или LOADLIN).&#13;</P
><P
>В случае, если ядра без патча и программы инсталляции не могут использовать
ide2 и ide3, даже если устройства определились правильно, попробуйте
указать ide0 или ide1, вместо ide2 и ide3. Это, по сути, отключает IDE
интерфейс материнской платы, и можете следовать инструкциям так, как
если бы физически заменили интерфейс. Замечу, что если вы используете IDE
CD-ROM, подключенный к материнской плате, но должны убедиться, что не
перекрыли этот интерфейс. Если CD-ROM на hda или hdb, используйте ide1.
Если он на hdc или hdd, используйте ide0.</P
><P
><I
CLASS="EMPHASIS"
>Другой вариант установки Linux и Ultra33 </I
></P
><P
>Если вы не можете добиться желаемого результата программным путем, то
попробуйте более грубый метод. Этот альтернативный метод
практически должен сработать, но придется залезть в компьютер, со
всеми выходящими отсюда последствиями. <I
CLASS="EMPHASIS"
>ВНИМАНИЕ:</I
> Если процесс
подключения/отключения IDE устройств вам не знаком, то, перед тем как
начать, <I
CLASS="EMPHASIS"
>прочитайте руководства</I
>, идущие вместе с компьютером, винчестером
и/или с Promise Ultra33! Если вы что-нибудь открутите и не будете знать, как
это поставить обратно, то останется лишь сожалеть об этом!</P
><P
>Как было сказано, все очень просто. В большинство современных материнских
плат встроены IDE-интерфейсы. Отключите винчестер от Ultra33 и подключите
его к материнской плате. Если к материнской плате подключены другие IDE
устройства, такие как CD-ROM или ZIP, то очень просто подключить винчестер
к свободному разъему кабеля IDE или временно отключить устройство, которое
сейчас вам не нужно (стриммер или ZIP). Установите Linux. Скачайте и
примените патч для Promise UDMA (см. следующий раздел).</P
><P
>Теперь вы готовы (почти) к тому, чтобы подключить винчестер обратно к
Promise. Чтобы обезопасить себя, сделайте загрузочный диск с ядром (cd
/usr/src/linux ; make zdisk), с которого можете загрузиться, если не
получится с винчестера. На самом деле, лучше всего сделать два диска и один
спрятать.</P
><P
>Хорошо, теперь настало время немного подумать: если у вас только один
жесткий диск, и он будет подключен к Promise, то скорее всего он будет
<TT
CLASS="LITERAL"
>/dev/hde</TT
> (<TT
CLASS="LITERAL"
>a</TT
> и <TT
CLASS="LITERAL"
>b</TT
> - это первичный интерфейс, <TT
CLASS="LITERAL"
>c</TT
> и <TT
CLASS="LITERAL"
>d</TT
> - это вторичный интерфейс
материнской платы). Если вы хотите подключить другие устройства к
первичному интерфейсу Promise, это будет <TT
CLASS="LITERAL"
>/dev/hdf</TT
>, к вторичному - <TT
CLASS="LITERAL"
>/dev/hdg</TT
>
и <TT
CLASS="LITERAL"
>/dev/hdh</TT
>.</P
><P
>Отредактируйте <TT
CLASS="LITERAL"
>/etc/fstab</TT
>, сменив все разделы на винчестерах, отключаемых
от материнской платы (<TT
CLASS="LITERAL"
>/dev/hda</TT
>, <TT
CLASS="LITERAL"
>hdb</TT
>, и т.д.), на соответственные значения в
Promise (<TT
CLASS="LITERAL"
>/dev/hde</TT
>, <TT
CLASS="LITERAL"
>hdf</TT
>, и т.д.). Если вы хотите переподключить другие
устройства (такие как CD-ROM или ZIP), смените и их. Например, если CD-ROM
сначала был на <TT
CLASS="LITERAL"
>/dev/hda</TT
>, а туда вы подключали жесткий диск, и он теперь на
<TT
CLASS="LITERAL"
>/dev/hdb</TT
> или <TT
CLASS="LITERAL"
>/dev/hdc</TT
>, поставьте обратно <TT
CLASS="LITERAL"
>/dev/hda</TT
>.</P
><P
>Если вы используете LILO, настройте его на загрузку с правильного
устройства (если не знаете как, прочитайте <A
HREF="http://www.linuxdoc.org/HOWTO/mini/LILO.html"
TARGET="_top"
>LILO mini-HOWTO</A
>), иначе
не удастся загрузиться даже с загрузочной дискеты, которая у вас есть, т.к.
ее тоже нужно настроить на загрузку с нового раздела. Это можно сделать при
помощи команды <TT
CLASS="LITERAL"
>rdev</TT
>. Вставьте диск в дисковод и наберите "<TT
CLASS="LITERAL"
>rdev /dev/fd0 /dev/hde1</TT
>". Только, конечно, вам нужно указать правильный корневой раздел
(у меня, например, <TT
CLASS="LITERAL"
>/dev/hde7</TT
>)!
&#13;</P
><P
>Перезагрузитесь. Система должна работать нормально. </P
><P
><I
CLASS="EMPHASIS"
>Патч для Ultra33 </I
></P
><P
>Ядра 2.0.35 и выше поддерживают Promise Ultra33; скачайте и установите ядро из вашего дистрибутива или с  <A
HREF="http://www.kernel.org"
TARGET="_top"
>http://www.kernel.org</A
>.</P
><P
>В качестве инструкции по сборке ядра, прочитайте <A
HREF="http://www.linuxdoc.org/HOWTO/Kernel╜HOWTO.html"
TARGET="_top"
>Kernel HOWTO</A
>.</P
><P
><I
CLASS="EMPHASIS"
>Использование других карт Ultra33 на одной машине </I
></P
><P
>&#13;В данный момент это не поддерживается: не делайте это прямо сейчас, если вы только не хотите возиться с ядром, чтобы заставить их работать.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="PROMISE66"
>5.2. Promise Ultra66</A
></H2
><P
>По сути это та же Ultra33, но поддерживающая UDMA в режиме 4 со скоростью передачи 66МБ/сек</P
><P
>Патч для ядер 2.0.x и 2.2.x доступен на 
<A
HREF="http://www.kernel.org/pub/linux/kernel/people/hedrick"
TARGET="_top"
>http://www.kernel.org/pub/linux/kernel/people/hedrick</A
>К тому же поддержка этих карт включена в серию 2.3.x (начиная с 2.3.3). 
&#13;</P
><P
>Тем не менее, чтобы произвести патч или заменить ядро, вам нужно использовать те же фокусы, как и для Ultra33 в предыдущем разделе. Или использовать загрузочный диск,  <A
HREF="http://www.promise.com/latest/latedrivers.htm#linuxu66"
TARGET="_top"
>provided by Promise</A
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="ARTOP"
>5.3. Artop ATP850UF</A
></H2
><P
>Эта карта поддерживается унифицированным кодом IDE. Инсталляция Linux на жесткий диск, подключенный к этой плате, потребует того же, что и для Promise Ultra33. </P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN216"
>5.4. Добавление файлов устройств</A
></H2
><P
>Третий и четвертый интерфейс IDE (ide2 and ide3) используют файлы от
<TT
CLASS="LITERAL"
>/dev/hde*</TT
> до <TT
CLASS="LITERAL"
>/dev/hdh*</TT
>. В старых дистрибутивах они автоматически не
создаются, так что вам придется создать их вручную.</P
><P
>Это можно довольно просто сделать, если у вас установлены исходные тексты
ядра. Просто запустите <TT
CLASS="LITERAL"
>/usr/src/linux/scripts/MAKEDEV.ide</TT
>, и он создаст все
необходимые файлы устройств.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="ONBOARD"
>6. Встроенные интерфейсы UDMA</A
></H1
><P
>Существуют UDMA-совместимые интерфейсы, встроенные в материнские платы. Они используют стандартные порты и могут спокойно работать на медленных не-UDMA скоростях на старых 2.0.x ядрах. Таким образом, во время инсталляции не должно быть никаких проблем, а установка патча превращается из необходимого шага в роскошь. Некоторые платы поддерживаются последними ядрами 2.0.x, а в 2.2.x добавлена поддержка чипсетов Intel.</P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="INTEL"
>6.1. Intel FX, HX, VX, TX, LX, and BX</A
></H2
><P
>Еще раз благодарю Gadi за информацию: </P
><P
>&#13;<PRE
CLASS="SCREEN"
>Поддержка Bus Master DMA support для чипсета Intel TX
реализована в 2.0.31 и выше.</PRE
>&#13;</P
><P
>В старых ядрах (таких как 2.0.30 в Slackware 3.4), интерфейс работает в медленном EIDE режиме. Однако интерфейс автоматически распознается ядром и проблем в работе быть не должно.</P
><P
>Полная поддержка второго режима UDMA для этих чипсетов включена в ядра 2.2.x и унифицированный IDE патч; см. раздел "<A
HREF="Ultra-DMA.html#UNIFIED"
><I
>Унифицированные патчи IDE</I
></A
>".</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="VIA"
>6.2. VIA VP2 и похожие чипсеты</A
></H2
><P
>Этот интерфейс тоже определяется автоматически и работает в режиме EIDE на старых ядрах. Если у вас такая плата, то можете скачать патч, повышающий пропускную способность, и избавитесь от надоевшего сообщения "неизвестное устройство PCI"</P
><P
>Он доступен на 
<A
HREF="http://www.ipass.net/~prefect"
TARGET="_top"
>http://www.ipass.net/~prefect/</A
>; он разработан для чипсета VIA VP2/97, находящегося на материнских платах FIC PA-2007 и PA-2011, но работает на похожих чипсетах. Известно, что он работает на новых чипсетах VIA VP3. &#13;</P
><P
>Замечу, что патч поддерживает только режим Bus Master, а это не полный UDMA, но это все-таки лучше, чем простой EIDE. Чтобы включить режим BMDMA, следуйте инструкциям, расположенным на сайте.</P
><P
>Существует патч, полностью поддерживающий UDMA 
<A
HREF="http://www.pyreneesweb.com/Udma/udma.html"
TARGET="_top"
>http://www.pyreneesweb.com/Udma/udma.html</A
>Он разработан для VIA VT82C586B, но должен работать на чипсетах VP2, VP3, VPX, P6 и AGP Apollo. Следуйте рекомендациям на сайте, но я рекомендую вам сохранить все файлы где-нибудь в другом месте, т.к. возможны проблемы с совместимостью с материнской платой. Но, если это работает, то это работает без проблем. 
&#13;</P
><P
>Замечу, что чипсет VP1 не поддерживается этими патчами, но работает с драйверами,
входящими в "<A
HREF="Ultra-DMA.html#UNIFIED"
><I
>Унифицированные патчи IDE</I
></A
>".</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN244"
>6.3. TX Pro и другие "Pro"</A
></H2
><P
>В данный момент для плат TX Pro поддержка UDMA не реализована. Они не похожи на платы TX: Я слышал, кто-то работает над этим, так что в будущем появится патч, но пока его нет. </P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="HPT366"
>6.4. HPT 366</A
></H2
><P
>Этот чипсет популярен на материнских платах Abit BP-6 и др. и содержит в
себе поддержку четвертого режима UDMA (66МБ/сек) на двух каналах, в
дополнении к двум другим каналам во втором режиме (33МБ/сек). Он
поддерживается как драйверами, описанными в разделе "<A
HREF="Ultra-DMA.html#UNIFIED"
><I
>Унифицированные патчи IDE</I
></A
>", так и текущими версиями
ядра. На старых (2.0.x) версиях ядра инсталляция может потребовать работы,
похожей на ту, что описана в разделе "<A
HREF="Ultra-DMA.html#PROMISE"
><I
>Promise Ultra33</I
></A
>"</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="UNIFIED"
>7. Унифицированные патчи IDE</A
></H1
><P
>Унифицированные IDE патчи для ядер 2.0.x, 2.2.x и 2.3.x предоставляют поддержку множетва чипсетов и PCI плат. Если ваш чипсет не поддерживается текущим ядром, то можно использовать эти патчи.</P
><P
>Унифицированный IDE код поддерживает <A
HREF="mailto:andre@suse.com"
TARGET="_top"
>Andre Hedrick</A
>, он доступен на <A
HREF="http://www.kernel.org/pub/linux/kernel/people/hedrick"
TARGET="_top"
>your local kernel archive mirror</A
>.</P
><P
>Поддержка UDMA предоставляется, как минимум, для следующих чипсетов, и вероятно работает на других: </P
><P
>&#13;<P
></P
><UL
><LI
><P
>Все чипсеты Intel: FX, HX, VX, TX, LX </P
></LI
><LI
><P
>Все чипсеты SiS (тестирован только SiS5598, но все семейство чипсетов содержит один и тот же контроллер 5513). </P
></LI
><LI
><P
>Чипсеты VIA (тестирован только 82C586B, но опять-таки все семейство имеет одну структуру). Для интерфейсов VIA имеется поддержка специальной диагностики. </P
></LI
><LI
><P
>PCI карты Promise и Artop. </P
></LI
><LI
><P
>Чипсет Aladdin V (ALi15x3) </P
></LI
><LI
><P
>Плата HPT343 и чипсет HPT366 (осторожно! см. раздел "<A
HREF="Ultra-DMA.html#HPT366"
><I
>HPT 366</I
></A
>")</P
></LI
></UL
>&#13;</P
><P
>Он также разработан для легкой установки поддержки других чипсетов.</P
><P
>Вот несколько замечаний Andre Balsa, автора первых патчей:</P
><P
>&#13;<PRE
CLASS="SCREEN"
>На хороших материнских платах с жесткими дисками UDMA IBM достигается
максимальная скорость - около 10Мб/сек (hdparm -T)

Чипсеты Intel TX имеют один буфер FIFO на два IDE интерфейса,
так что использование двух жестких дисков UDMA не даст большего
быстродействия, чем один UDMA жесткий диск.
Тем не менее, SiS5598 имеет два полностью разделенных интерфейса,
каждый со своим буфером FIFO. Теоретически, каждый может дать
66Мб/сек, используя драйвер md и разделяя данные по двум
жестким дискам. Я думаю, SiS5571 имеет ту же архитектуру.
У меня нет данных о чипсетах VIA, не могу ничего о них сказать.

Драйвер IDE (U)DMA, (автор Mark Lord) переключается особенно
быстро, что влияет на задержку в передаче данных.
Он идеален для передачи множества мелких данных (например, на
сервере новостей), что в некоторых случаях может быть идеальней
SCSI.</PRE
>&#13;</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="ACTIVATE"
>8. Активирование и деактивирование UDMA</A
></H1
><P
>Обычно ядро, поддерживающее UDMA, автоматически включает режим UDMA на
устройстве, поддерживающем его. В большинстве случаев, когда это не
происходит, ядро просто не знает, как управлять чипсетом (используйте "<A
HREF="Ultra-DMA.html#UNIFIED"
><I
>Унифицированные патчи IDE</I
></A
>")
или считает небезопасным активизировать его.
&#13;</P
><P
>Тем не менее, в некоторых случаях устройство поддерживает UDMA, но BIOS говорит, что это не так. В этом случае возможно включение вручную.</P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="BOOTPARAM"
>8.1. Использование параметров запуска ядра</A
></H2
><P
>В ядрах 2.1.113 и выше можно включить DMA для обоих устройств на данном
интерфейсе IDE, используя параметр <TT
CLASS="LITERAL"
>ideX=dma</TT
>, где X - номер интерфейса
(первый - 0). Однако, это может не сработать.</P
><P
>Параметры могут быть установлены через LILO, LOADLIN или большинством других загрузчиков Linux. Для более подробной информации см. <A
HREF="http://www.linuxdoc.org/HOWTO/Bootdisk-HOWTO.html"
TARGET="_top"
>Bootdisk HOWTO</A
>.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="HDPARM"
>8.2. Использование hdparm</A
></H2
><P
><TT
CLASS="LITERAL"
>hdparm</TT
> - это программа, используемая для изменения параметров жестких дисков под Linux. Среди других ее функций есть и включение, и выключение UDMA для устройства, а также проверка скорости передачи данных. </P
><P
>На данный момент текущая версия <TT
CLASS="LITERAL"
>hdparm</TT
> - 3.6. Старые версии могут не
правильно показывать и изменять параметры UDMA. Вы можете получить исходный
тексты hdparm 3.6 на
<A
HREF="http://metalab.unc.edu/pub/Linux/system/hardware/hdparm-3.6.tar.gz"
TARGET="_top"
>http://metalab.unc.edu/pub/Linux/system/hardware/hdparm-3.6.tar.gz</A
>.</P
><P
>Компиляция и инсталляция выглядит примерно так:</P
><P
>&#13;<PRE
CLASS="SCREEN"
>tar zxvf /tmp/download/hdparm-3.6.tar.gz
cd hdparm-3.5
make
su root
(type password when prompted)
make install
cp /usr/local/sbin/hdparm /sbin/hdparm
exit</PRE
>&#13;</P
><P
><I
CLASS="EMPHASIS"
>Чтобы включить DMA для жесткого диска: </I
> <TT
CLASS="LITERAL"
>hdparm -d1 /dev/hda</TT
></P
><P
><I
CLASS="EMPHASIS"
>Чтобы выключить DMA для жесткого диска: </I
> <TT
CLASS="LITERAL"
>hdparm -d0 /dev/hda</TT
></P
><P
><I
CLASS="EMPHASIS"
>Чтобы измерить скорость передачи:</I
> <TT
CLASS="LITERAL"
>hdparm -Tt /dev/hda</TT
></P
><P
><I
CLASS="EMPHASIS"
>Чтобы посмотреть какие опции включены:</I
> <TT
CLASS="LITERAL"
>hdparm /dev/hda</TT
></P
><P
><I
CLASS="EMPHASIS"
>Чтобы узнать больше информации: </I
>: (показывает, какие режимы UDMA поддерживаются/включены) 
<TT
CLASS="LITERAL"
>hdparm -i /dev/hda</TT
></P
><P
>Для более детальной информации (как, например, выбрать нужный режим UDMA)
читайте руководство

(``<TT
CLASS="LITERAL"
>man 8 hdparm</TT
>'').</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN316"
>9. Проблемы</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="BLACKLIST"
>9.1. Черный список UDMA</A
></H2
><P
>Следующие устройства включены в ``черный список''. Вы <I
CLASS="EMPHASIS"
>не</I
> должны
использовать UDMA с этими устройствами, т.к. это может привести к потере
данных. Чтобы избежать этого, драйвер должен автоматически выключить DMA
для этих устройств.</P
><P
>&#13;<P
></P
><UL
><LI
><P
>Western Digital WDC AC11000H, AC22100H, AC32500H, AC33100H, AC31600H - всех версий </P
></LI
><LI
><P
>Western Digital WDC AC32100H revision 24.09P07</P
></LI
><LI
><P
>Western Digital WDC AC23200L revision 21.10N21</P
></LI
></UL
>&#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN330"
>9.2. Разгоняете?</A
></H2
><P
>Если вы это делаете, будьте осторожны. Вот цитата из старой документации по UDMA:</P
><P
>&#13;<PRE
CLASS="SCREEN"
>Не превышайте частоту шины PCI. 37.5МГц - это максимальная частота
для шины PCI. Некоторые UDMA устройства не возьмут даже 37.5МГц,
хотя будут работать на 33.3МГц.

В любом случае, НИКОГДА. Слышите? НИКОГДА не устанавливайте
частоту шины PCI на 41.5МГц.

РЕКОМЕНДУЕМОЕ безопасное значение - 33МГц.</PRE
>&#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN335"
>9.3. У вас новый BIOS?</A
></H2
><P
>Вот другой кусок из документации по UDMA:</P
><P
>&#13;<PRE
CLASS="SCREEN"
>Задача установки устройств для передачи данных через DMA
выполняется в основном BIOS-ом конкретной материнской платы.
Это в том случае, если BIOS запрограммирован правильно:

Например, с материнской платой ASUS SP-97V с оригинальным BIOS-ом
(Rev. 1.03) в Linux возможен сбой и во втором режиме DMA и UDMA;
она работает нормально только в четвертом PIO режиме или под
Windows 95 во всех режимах. Я скачал последнюю версию BIOS
(Rev. 1.06) с веб-сервера ASUS и загрузил ее в EPROM.
С тех пор все работает просто прекрасно (на частоте шины в 66МГц).

Это говорит о том, что BIOS устанавливает специфические
синхронизирующие параметры (active pulse, recovery clock).
В моей версии, возможно, эти параметры были неправильны.
Драйвер Windows 95 устанавливал собственные параметры
(не основываясь на BIOS), поэтому с самого начала у меня были проблемы
с драйвером под Linux, когда как Windows 95 работал нормально.

Таким образом, еще раз: (U)DMA драйвер Linux зависит от параметров
(U)DMA контроллера BIOS-а. Если у вас проблемы, сначала проверьте,
нет ли более свежей версии BIOS для этой материнской платы.

...

Свежие версии BIOS могут быть загружены с веб-сайта производителя
материнской платы. Операция загрузки BIOS довольно проста, но
должна быть выполнена строго по руководству материнской платы.

Последние версии Award BIOS работают стабильно с UDMA.</PRE
>&#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="HELP"
>9.4. Если вы все еще не можете заставить его работать!</A
></H2
><P
>Если ничего в этом документе вам не помогло или, как минимум, помогло не достаточно, лучший выход - это написать письмо, полностью описывающее ваши трудности, какой у вас интерфейс UDMA, на материнской плате или в виде карты, жесткий диск на самом деле UDMA или обычный EIDE, какую конфигурацию имеют ваши диски, версия (дистрибутив и ядро) Linux и что-нибудь еще, что может помочь, и послать его в конферецию 
<A
HREF="news:comp.os.linux.hardware"
TARGET="_top"
>comp.os.linux.hardware</A
>.
Возможно, вы вскоре получите необходимые разъяснения.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="SUGGEST"
>10. Если у вас есть информация о UDMA, которой нет в этом mini-howto:</A
></H1
><P
>Круто! Если вы располагаете информацией, которую я не знаю, во что бы то ни стало пошлите ее мне 
(<A
HREF="mailto:brion@pobox.com"
TARGET="_top"
>brion@pobox.com</A
>),
и вскоре я помещу ее в эту документацию.</P
></DIV
></DIV
></BODY
></HTML
>