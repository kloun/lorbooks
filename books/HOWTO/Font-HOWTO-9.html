<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>Font HOWTO: TeX / LaTeX</TITLE>
 <LINK HREF="Font-HOWTO-10.html" REL=next>
 <LINK HREF="Font-HOWTO-8.html" REL=previous>
 <LINK HREF="Font-HOWTO.html#toc9" REL=contents>
</HEAD>
<BODY>
<A HREF="Font-HOWTO-10.html">Далее</A>
<A HREF="Font-HOWTO-8.html">Назад</A>
<A HREF="Font-HOWTO.html#toc9">Оглавление</A>
<HR>
<H2><A NAME="s9">9. TeX / LaTeX</A></H2>

<H2><A NAME="ss9.1">9.1 Обзор файлов фонтов для LaTeX/TeX</A>
</H2>

<P>Добавление фонтов к TeX и LaTeX является довольно сложной процедурой. 
Однако, как и во многих других вещах, все просто, если Вы знаете, как 
это сделать. Некоторые фонты распространяются в формате Метафонт, а 
некоторые - в формате Type1. Обычно, фонты формата Type1 более доступны. 
Однако фонты Метафонт имеют то очевидное преимущество, что они 
меняют форму изображения в соответствии с размером, в то время как фонты  
Type1 и TrueType при различных размерах просто увеличивают или уменьшают 
изображения символов, не изменяя формы. Главная причина того, что это 
качество желательно, состоит в том, что в идеале шрифт должен быть 
(относительно) узким при больших размерах и более широким при малых размерах.

<P>В нижеследующем изложении мы сконцентрируем внимание на фонтах 
Type1, поскольку они более доступны и порождают больше проблем при 
инсталляции.
<P>Вот небольшой обзор файлов фонтов в LaTeX. LaTeX использует 
следующие типы файлов при обработке фонтов Type1:
<UL>
<LI> <CODE>.pl</CODE> -- список свойств (property list). 
Это версия файла метрик фонта для tex, приспособленная для чтения человеком.</LI>
<LI> <CODE>.vpl</CODE> -- виртуальный список свойств (virtual property list). 
Ориентированная на чтение человеком версия виртуального файла фонта.
</LI>
<LI> <CODE>.fd</CODE> -- определение фонта (font definition). Используется для 
задания семейства фонтов.
</LI>
<LI> <CODE>.tfm</CODE>  -- метрика фонта tex (tex font metric). Это файл метрик, 
как это объясняется в глоссарии. Этот файл полностью аналогичен файлу <CODE>.afm</CODE>, 
используемому для фонтов типа Type1. TeX нуждается в файле метрик для того, чтобы 
правильно расположить текст на странице.
</LI>
<LI> <CODE>.vf</CODE> -- виртуальный фонт (virtual font). Эти файлы содержат детали 
кодирования и действуют как интерпретаторы. TeX обращается с ними как с фонтами. 
Например, представьте, что существует некий фонт foobar-exp.pfb, который состоит 
из небольшого числа (скажем 20) альтернативных символов, и имеется виртуальный фонт, 
который использует некоторые из этих альтернативных символов (и использует 
остальные символы из фонта foobar.pfb). Dvips может сказать "Мне нужен 
символ 65 из виртуального фонта foo.vf". Dvips знает, что 65 всегда соответствует 
"a" в схеме TeX. Тогда виртуальный фонт переадресует запрос TeX'а в запрос символа 
14 в фонте foobar.pfb типа Type1 (который может замещать "a" в Type1 фонте foobar.pfb). 
Механизм виртуальных фонтов очень гибок и позволяет конструировать фонт из нескольких 
различных файлов фонтов. Это очень полезно, когда используются такие фонты как 
фонты "expert" от Adobe.
</LI>
<LI> <CODE>.pk</CODE> -- аппаратно-зависимый растровый (bitmap) фонт. Эти фонты 
обычно конструируются по мере необходимости (они содержат готовые изображения 
символов, создаваемые с помощью фонтов Type1 и метафонта). Они обычно имеют 
высокое разрешение (около 300-1200dpi) и предназначены для того, чтобы организовать 
вывод на принтер. Из-за высокого разрешения и того факта, что для вывода символов 
каждого размера требуется <CODE>.pk</CODE>-файл, они требуют очень много дискового 
пространства, поэтому обычно сохраняются в кэше, а не записываются на диск.
</LI>
<LI><CODE>.mf</CODE> -- файлы метафонтов (metafont files). Метафонт - это 
язык программирования графики (a graphics programming language), широко используемый 
для создания фонтов (хотя он может быть использован для любой графики). 
Он имеет много преимуществ по сравнению со схемами, использованными в TrueType и 
Type1. Его главной слабостью является то, что он не так вездесущ, как TrueType или 
Type1 (и он не очень хорош для WYSIWYG-приложений. Конечно, это главный недостаток, 
если Вы используете для печати TeX.)
</LI>
</UL>
<P>
<P>Неплохо знать кое-что о структуре каталогов TeX. Основные каталоги, о которых 
Вы дожны знать, следующие:
<UL>
<LI> <CODE>$TEXMF/fonts</CODE>  -- главный каталог для фонтов</LI>
<LI> <CODE>$TEXMF/fonts/type1</CODE> -- директория для фонтов type1</LI>
<LI> <CODE>$TEXMF/fonts/type1/foundry</CODE> -- каталог для файлов фонтов от конкретного 
производителя (foundry)</LI>
<LI> <CODE>$TEXMF/fonts/type1/foundry/fontname</CODE> -- содержит фонт с именем 
<EM>name</EM>. Это имя (<EM>name</EM>) обычно представляет собой произвольное английское 
название и не обязано следовать довольно загадочной схеме формирования имен фонтов, 
принятой в TeX.</LI>
<LI> <CODE>$TEXMF/fonts/afm/foundry/fontname</CODE> -- каталог, содержащий 
<CODE>afm</CODE>-файлы, соответствующие фонту <CODE>name</CODE>, принадлежащему 
производителю <CODE>foundry</CODE>.</LI>
<LI>  <CODE>$TEXMF/fonts/tfm/foundry/fontname</CODE> -- аналогичный каталог, 
содержащий файлы <CODE>tfm</CODE> (вместо <CODE>afm</CODE>-файлов).</LI>
<LI><CODE>$TEXMF/fonts/vf/foundry/fontname</CODE> -- аналогичный каталог для виртуальных 
фонтов.
</LI>
<LI><CODE>$TEXMF/fonts/source/foundry/fontname</CODE> -- аналогичный каталог, содержащий 
файлы метафонта.</LI>
<LI><CODE>$TEXMF/dvips/config/psfonts.map</CODE> -- файл, определяющий соответствия 
между названиями фонтов и именами файлов, содержащими эти фонты, для dvips. Этот 
файл по своим функциям и структуре подобен файлу Fontmap из пакета ghostscript.</LI>
<LI><CODE>$TEXMF/tex/latex/psnfss</CODE> -- здесь находятся все файлы определений 
фонтов (.fd).
</LI>
</UL>
<P>
<H2><A NAME="ss9.2">9.2 Добавление фонтов Type1</A>
</H2>

<H3>Именование фонтов</H3>

<P>Во-первых, Вы должны соответствующим образом назвать Ваши фонты.
Инструкции о том, как именуются фонты, ищите в документации на fontinst 
в Вашей системе (она должна находиться в подкаталоге fontinst каталога, 
содержащего документацию по tetex). Очень кратко схема именования 
фонтов такова:
<CODE>FNW{V}E{N}</CODE> где:
<UL>
<LI>F - однобуквенное сокращение для производителя фонта (m = monotype, p = adobe, 
b = bitstream, f = free )</LI>
<LI>N - двух-буквенное сокращение от имени фонта
(например, ag = "avant garde")</LI>
<LI>W - это толщина фонта (r = regular, b = bold, l = light d = demibold )</LI>
<LI>V - необязательные указание на вариант наклона (i = italic, o = oblique)</LI>
<LI>E - сокращение для кодирования (почти всегда <CODE>8a</CODE>, что означает 
стандартную схему кодирования adobe).</LI>
<LI>N - необязательное указание на ширину символов (n = narrow)</LI>
</UL>

Например, фонт Adobe Garamond demibold именуется как <CODE>pgad8a</CODE>.

<H3>Создание виртуальных фонтов и метрик фонта для tex</H3>

<P>Теперь Вы можете запустить <CODE>fontinst</CODE> следующим образом:
<PRE>
        latex `kpsewhich fontinst.sty`
</PRE>
после чего ввести на запрос программы:
<PRE>
        \latinfamily{font_name}{}\bye
</PRE>

где <CODE>font_name</CODE> - это три первых буквы имени файла Вашего фонта 
(например, <CODE>pad</CODE> для adobe garamond). 
После этого <CODE>fontinst</CODE> создаст множество файлов -- 
файлы описания фонта, файлы списка свойств и файлы виртуальных списков свойств. 
Будет сгенерировано также множество <CODE>.mtx</CODE>-файлов. Они создаются 
программой  <CODE>fontinst</CODE>, но Вам нет необходимости использовать их. 
Вам необходимо конвертировать списки свойств и виртуальные списки свойств в 
метрики и виртуальные фонты. Это делается с помощью утилит 
<CODE>vptovf</CODE> и <CODE>pltotf</CODE>.
<PRE>
        for X in *.pl; do pltotf $X; done
        for X in *.vpl; do vptovf $X; done
</PRE>

Затем удалите старые <CODE>vpl</CODE>, <CODE>pl</CODE> и <CODE>mtx</CODE> файлы.

<H3>Конфигурирование dvips</H3>

<P>Вы должны отредактировать конфигурационный файл dvips, <CODE>psfonts.map</CODE>.
Лучший способ объяснить формат файла - это привести пример.
<PRE>
     marr8r          ArialMT &lt;8r.enc &lt;farr8a.pfa
     marbi8r         Arial_BoldItalicMT &lt;8r.enc &lt;farbi8a.pfa
     marb8r          Arial_BoldMT &lt;8r.enc &lt;farb8a.pfa
     marri8r         Arial_ItalicMT &lt;8r.enc &lt;farri8a.pfa
     marr8rn         Arial_Narrow &lt;8r.enc &lt;farr8an.pfa
</PRE>

Здесь <CODE>8r.enc</CODE> служит просто для информирования dvips об используемой 
схеме кодирования (во всех наших примерах это 8r, в силу способа, которым 
<CODE>fontinst</CODE> конструирует виртуальные фонты). Самый левый столбец - 
это имя фонта, который использует TeX. Второй столбец - это реальное имя фонта, 
которое содержащееся в файле фонта (это имя можно узнать, открыв <CODE>afm</CODE>-файл 
в текстовом редакторе и найдя директиву <CODE>FontName</CODE>). Последний столбец 
это имя файла контуров, соответствующего данному фонту. Указывать имя каталога 
нет необходимости -- tex знает, где искать.

<H3>Тестирование фонта</H3>

<P>Попытайтесь запустить latex на документе следующим образом:
<PRE>
\documentclass{article}
\begin{document}
        \usefont{T1}{pga}{m}{n}\selectfont
        \huge
        Testing a new font \dots the quick red fox jumped over the lazy brown dogs
\end{document} 
</PRE>

где нужно заменить <CODE>pga</CODE> на указание на Ваш фонт. Если это работает, 
Вы почти у цели. Все, что Вам еще необходимо сделать - это разместить все файлы 
в соответствующих каталогах (как это объяснено выше), после чего запустить
run 
<PRE>
         texconfig rehash
</PRE>

с тем, чтобы tex мог обновить список каталогов.

<H3>Создание  .sty-файла</H3>

<P>Вы можете создать файл .sty для того, чтобы легче было использовать фонты. 
Используйте в качестве образцов (или шаблонов) файлы из 
<CODE>$TEXMF/tex/latex/psnfss</CODE>.
<HR>
<A HREF="Font-HOWTO-10.html">Далее</A>
<A HREF="Font-HOWTO-8.html">Назад</A>
<A HREF="Font-HOWTO.html#toc9">Оглавление</A>
</BODY>
</HTML>
