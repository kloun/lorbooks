<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE> Text-Terminal-HOWTO : Поиск неисправностей (программное обеспечение)</TITLE>
 <LINK HREF="Text-Terminal-HOWTO-16.html" REL=next>
 <LINK HREF="Text-Terminal-HOWTO-14.html" REL=previous>
 <LINK HREF="Text-Terminal-HOWTO.html#toc15" REL=contents>
</HEAD>
<BODY>
<A HREF="Text-Terminal-HOWTO-16.html">Next</A>
<A HREF="Text-Terminal-HOWTO-14.html">Previous</A>
<A HREF="Text-Terminal-HOWTO.html#toc15">Contents</A>
<HR>
<H2><A NAME="s15">15. Поиск неисправностей (программное обеспечение)</A> </H2>

<P>Если вы предполагаете, что проблема - аппаратная, см. раздел "Ремонт и 
диагностика".
<P>Вот список возможных проблем:
<UL>
<LI>  ``Терминал работает хорошо?" Предположим, что терминал нет.</LI>
<LI>  ``Отсутствует текст" Или пропущен текст, или текст отображается правильно и 
терминал зависает</LI>
<LI>  ``Getty Respawning Too Rapidly'' (console error message)</LI>
<LI>  ``Getty Перепорождение Слишком Быстро " (пультовое сообщение об ошибках)</LI>
<LI>  ``Сбои после входа в систему"</LI>
<LI>  ``Нельзя войти в систему, но приглашение входа в систему есть.</LI>
<LI>  ``Искаженное приглашение входа в систему"</LI>
<LI>  ``Нет приглашения входа в систему"</LI>
</UL>

Имеются два случая, когда терминал ломается. Один - он только что работал хорошо 
и внезапно перестал работать. Это обсуждено в следующем разделе. Другой случай - 
неправильная работа терминала, когда вы его устанавливаете. Этот случай описан 
через раздел.
<P>
<P>
<H2><A NAME="ss15.1">15.1 Терминал работал хорошо</A>
 </H2>

<P>Когда прежде рабочий терминал внезапно ломается зачастую поиск проблемы прост. 
Проблема может быть очевидной типа сообщения об ошибках, когда терминал включен 
первый раз. Если он шумит, вероятно требуется ремонт. См. ``Ремонт и 
Диагностика". Сначала, подумайте от том, что было сделано или изменено недавно, 
поскольку вероятно это и есть причина проблемы.
<P>Проблема случалась только после того, как было установлено новое программное 
обеспечение системы или после изменения в конфигурации?
<P>
<P>
<H2><A NAME="ss15.2">15.2 Терминал недавно установлен</A>
 </H2>

<P>Если вы только что соединили терминал с компьютером по инструкции, и он не 
работает, то этот раздел - для вас. Если терминал, который прежде работал 
хорошо, не работает теперь, тогда см. ``Терминал работал хорошо''.
<P>Если вы предполагаете, что последовательный порт на вашем компьютере 
может быть испорчен, то вы можете попробовать выполнить диагностическую 
программу для него, возможно из MS DOS.
<P>Один из подходов, чтобы сначала увидеть, будет ли терминал работать, состоит в
попытке скопировать файл на терминал (cp my_file /dev/ttyS?) в наиболее 
простой ситуации. Это значит с заблокированными линиями управления модема и на
такой скорости, когда не нужно управление потоком данных (удостоверитесь, что 
любое аппаратное управление потоком данных заблокировано). Если копирование 
было успешным, то усложните ситуацию, и см., работает ли это все еще и т.д., и 
т.д. Когда проблема появляется только после того, как вы сделали изменение, 
то вероятно, что это изменение и есть источник проблемы. Фактически, более 
эффективный (но более сложный) метод состоит в переходе от простой ситуации к 
приблизительно половине конечной конфигурации так, чтобы тест устранил 
приблизительно половину остающихся возможных причин проблемы. Затем повторите 
эту методологию для следующего теста. При этом способе достаточно сделать
с десяток тестов, чтобы найти причину из тысячи возможных причин. вы должны 
отклониться немного из этого метода, основанного на догадках и сведениях.
<P>
<P>
<H2><A NAME="ss15.3">15.3 Терминал работает хорошо?</A>
 </H2>

<P>Исправный терминал обычно будет при запуске выдавать слова на экране.
<P>Если эти слова не передают сообщение об ошибках, он видимо исправен. Если не
видно признаков подачи питания (не светятся никакие лампочки и т.д.) заново 
подключите оба конца шнура питания компьютера. Удостоверьтесь, что имеется 
ток в стенной розетке (или на удлинителе). Попробуйте другой шнур питания, если 
он у вас есть.
<P>Удостоверьтесь, что терминал включен и что его плавкий предохранитель не 
перегорел.
<P>Пустой (или тусклый) экран можно иногда исправить использованием кнопок 
управления яркостью и контрастностью, или нажатием клавиш в режиме установки. 
Переведите терминал в автономный режим, если это возможно, и попробуйте 
попечатать. Если он все еще не будет работать, см. ``Ремонт и диагностика" 
для советов по починке терминала.
<P>
<P>
<H2><A NAME="ss15.4">15.4 Отсутствует текст</A>
 </H2>

<P>Если некоторый текст отображается на терминале хорошо, а затем он 
останавливается незаконченным (на середине слова и т.д.), или если куски текста 
отсутствуют, то вы вероятно имеете проблему с управлением потоком данных. Если
вы не можете выяснить сразу же, чем это вызвано, уменьшите скорость. Если это 
помогло, то вероятно проблема с управлением потоком данных. Может быть, что
управление потоком данных не работает полностью из-за ошибок настройки, или 
из-за неправильной распайки кабеля (для аппаратного потока управления). См. 
``Управление потоком данных"
<P>Если одиночные символы отсутствуют, возможно последовательный порт - переполнен
слишком быстрым потоком данных. Попробуйте более медленную скорость.
<P>Если вы используете скорость 1200 (очень медленно, обычно используемый для 
старых терминалов и принтеров) и текст остается усеченным, то проблема 
вероятно в драйвере последовательного устройства. См. Printing HOWTO  
"Последовательные устройства" для информации о том, как это устанавливается.
<P>
<P>
<H2><A NAME="ss15.5">15.5 getty восстанавливается слишком быстро</A>
 </H2>

<P>
<H3>Нет напряжений управления модемом </H3>

<P>Если getty не может открыть и/или использовать порт из-за недостатка 
положительного напряжения управления модемом на одном из выводов, то getty может 
уничтожиться. Затем командой в inittab, getty повторно порождается и 
пробует снова, уничтожается снова и т.д., и т.д. Пробуйте использовать 
опцию "local" с getty и/или проверить установки управления модема и напряжения.
<P>
<P>
<H3>Клавиша закорочена </H3>

<P>Другая возможная причина перепорождения getty - клавиша клавиатуры закорочена, 
давая тот же самый результат, словно клавиша непрерывно нажата. Если разрешено
автоповторение, то в подсказке входа в систему "печатаются" тысячи символов. 
Экран заполняется одинаковыми символами (в некоторых случаях 2 или более 
различными символами).
<P>
<P>
<H2><A NAME="ss15.6">15.6 Сбои сразу после входа в систему</A>
 </H2>

<P>Если вы можете войти в систему, но не можете использовать терминал, то возможно
что при запуске шелл терминал реконфигурируется (неправильно) командой, которую 
кто-то поместил в один из файлов, которые выполняются, когда вы входите в 
систему. Это файлы - /etc/profile и /.bashrc. Ищите команду, начинающуюся с 
"stty" или "setserial", и удостоверьтесь, что она правильная. Даже если она 
выполняется хорошо в одном файле инициализации, ее действие может быть 
неправильно отменено в другом файле инициализации, который вы не знаете. вы 
можете загрузиться со спасательной дискеты, чтобы войти в систему для 
фиксирования проблемы.
<P>
<P>
<H2><A NAME="ss15.7">15.7 Нельзя войти в систему</A>
 </H2>

<P>Если вы получаете приглашение ко входу в систему, но не получаете ответа
(или возможно искаженный ответ) на вашу попытку войти в систему, то возможная
причина этого, что связь является плохой односторонней от терминала к 
компьютер. Если вы еще не используете опцию "local" с getty, сделайте так, 
чтобы отключить линии управления модемом. вы могли бы также отключить 
аппаратное управление потоком данных (stty -crtscts), если оно разрешено. Если 
теперь все работает, то ваши линии управления модемом вероятно или не проводят,
или не устанавлены правильно. Некоторые терминалы позволяют устанавливать 
различные значения (типа скорости) для передачи и приема, так что прием может
осуществляться хорошо, а передача - плохо.
<P>Если вы получили сообщение, говорящее что-то типа "login failed", то, если вы 
не ошиблись при наборе слов или в пароле, дейтвительно могут иметься некоторые 
ограничения на вход в систему. См. ``Ограничение входа в систему"
<P>
<P>
<H2><A NAME="ss15.8">15.8 Искаженная подсказка входа в систему</A>
 </H2>

<P>Такое может быть из-за использования неправильного символьного набора, ошибок
передачи из-за слишком высокой скорости, несовместимых скоростей или 
несовместимого контроля по четности. Если это выглядит как набор странных 
символов, то у вас установлен неправильный символьный набор, или бит старшего 
разряда устанавливается ошибочно.
<P>Если слова появляются с орфографическими ошибками, попробуйте более низкую 
скорость. При несовместимости скорости или контроля по четности вы увидите 
много одинаковых "символов ошибки", который представляет собой реальный символ, 
который не может отобразиться правильно из-за ошибок в контроле по четности 
или скорости.
<P>Если вы используете agetty (часто именуемый getty), то программа agetty 
обнаружит и установит контроль по четности, если вы что-то печатаете. 
Пробуйте его с возвратом, чтобы увидеть, исправляет ли она возможные ошибки 
контроля по четности.
<P>
<H2><A NAME="ss15.9">15.9 Нет признаков приглашения входа в систему</A>
 </H2>

<P>Если на терминале ничего не происходит, то произошло самое страшное. Одна из 
первых вещей, которые надо сделать это удостовериться, что все кабельные 
соединенители плотно вставлены и соединены правильно. Другие возможные проблемы:
несоответствие скоростей в бодах, неисправные аппаратные средства или не 
запущен getty.
<P>В этой точке два различных направления подхода (вы можете следовать 
больше одному):
<UL>
<LI>  Диагностика проблемы с консоли</LI>
<LI>  Измерение напряжений </LI>
</UL>
<P>
<H3>Диагностика проблемы с консоли </H3>

<P>В консоли (или другом рабочем терминале) используйте "top" или "ps -al", чтобы 
увидеть выполняется ли getty на порту. Не путайте ее с программами getty, 
выполняющимися на других портах или на виртуальных косолях. вы не получите 
подсказку входа в систему, если getty не запущена. Если она запущена, то вы 
можете запретить ее, чтобы попробовать скопировать файл на терминал как тест.
<P>Чтобы запретить getty, отредактируйте /etc/inittab, и закомментируйте команду
getty значком # в начале строки, чтобы она не порождалась повторно после того,
как вы уничтожите ее. Затем уничтожьте старую getty, используя клавишу k
в программе "top".
<P>Чтобы cкопировать короткий файл на терминал (Хорошо бы попробовать это 
сделать перед тем, как начать процесс установки перед настройкой getty) 
используйте команду cp Linux: cp file_name /dev/ttyS1.
<P>Если это не работает, используйте stty, чтобы сделать упростить интерфейс 
насколько возможно, отключив все что можно (типа аппаратного управления 
потоком данных: -crtscts; контроль по четности, и управляющие сигналы модема: 
clocal). Убедитесь, что скорости и биты/байты - одинаковы. Если ничего не 
случается, проверьте порт вольтметром (см. следующий раздел).
<P>
<P>
<H3>Измерение напряжений</H3>

<P>                             
Если у вас есть удобный вольтметр, проверьте уровень -12 V (от -5 до -15) на
выводе 3 (прием данных) на терминальном конце нуль-модемного кабеля. 
Положительный вывод измерителя должен быть хорошо заземлен (металлические 
соединители на концах кабелей часто незаземлены). Если отрицательного 
напряжения нет, то проверьте его в выводе 2 на компьютере. Если оно есть там,
но нет в выводе 3 на терминале, то неисправен кабель (потеря контакта, порван 
провод, или это не нуль-модемный кабель с выводом 2 соединенным с выводом 3). 
Если напряжение отсутствует, то не работает последовательный порт на компьютере.
Проверьте его диагностическим программным обеспечением или замените это.
<P>Если последовательный порт действует, то вы можете посылать файл в него (с 
заблокированными средствами управления модема) и посмотрите, принимается ли 
что-нибудь на него. Чтобы проверить переданный сигнал, посмотрите на индикатор 
вольтметра в -12 V, когда линия неактивна. Затем начните посылать файл (или 
запустите getty). вы должны увидеть, что индикаттор приближается к 0 и 
дрожит около 0, поскольку он измеряет короткие импульсы потока битов. вы можете 
увидеть это также на шкале AC, если ваш измеритель имеет конденсатор, чтобы 
блокировать внешнее напряжение DC, когда измеряют на AC. Если его нет, то
задержка DC -12 V вызовет большую ошибку чтения AC. Без измерителя, вы могли бы 
подсоединить хорошее устройство (типа другого терминала или внешнего модема) 
на последовательный порт, и посмотреть работает ли оно хорошо.
<P>
<P>
<H2><A NAME="ss15.10">15.10 Испытательное оборудование для последовательных устройств  </A>
</H2>

<P>
<H3>Breakout устройства, и т.д. </H3>

<P>Хотя воможно, что для нескольких терминалов, вам может понадобиться только 
мультиметр (используемый как вольтметр), для тестирования линий связи 
последовательного порта было создано специальное испытательное оборудование. 
Некоторые называются "breakout ... ", где breakout означает - break out
проводники кабеля. Эти устройства имеют два разъема и вставляются
в последовательный кабель. Некоторые имеют тестовые точки для подключения
вольтметра. Другие имеют светодиодные индикаторы, которые светятся, когда 
на некоторых линиях управления модемом есть сигнал.
<P>Кроме того они могут иметь джамперы для соединения любого провода с любым 
проводом. Некоторые имеют переключатели. Radio Shack продает "RS-232 
troubleshooter" и "RS-232 serial jumper box".
<P>
<P>
<H3>Измерение напряжений </H3>

<P>Любой вольтметр или мультиметр, даже самый дешевый, который продается за $10, 
должен прекрасно работать. Попытки использовать другие методы для проверки 
напряжения сложны. Не используйте светодиоды, если они не имеют шунтирующего 
резистора. 470 ohm резистор используется для 20 ma светодиодов (но не все 
светодиоды - 20 ma). Светодиод светит только при соблюдении полярности 
напряжения на нем, так что вы можете проверить + или - напряжение. Каждый 
делал такое устройство для тестирования автомобильной схемы?? Логические зонды 
могут повреждиться, если вы пробуете использовать их для напряжений больше, 
чем в ТТЛ-схемах, для которых они разработаны - только 5 вольт. Попытка 
использовать 12-вольтовую лампочку - тоже не слишком хорошая идея. Она не 
будет показывать полярность и из-за ограниченного выходного уровня в UART, 
вероятно, даже не будет светиться.
<P>Чтобы измерить напряжение на розеточном разъеме, вы можете воткнуть 
изогнутый отрезок бумаги. Диаметр должен быть не больше, чем вывода так, чтобы 
это не повредило контакт.
<P>
<P>
<H3>Напряжение на вкус </H3>

<P>В качестве последнего средства, если у вас нет никакого испытательного 
оборудования и вы желаете рискнуть получить электрошок (или помереть от 
электричества), вы всегда можете попробовать напряжение на вкус. Перед 
касанием одного из проверяемых проводников вашим языком, проверьте их, чтобы 
удостовериться, что по ним не идет высокое напряжение. Коснитесь обоими 
проводниками (однирвеменно) к одной руке, чтобы увидеть есть ли в них ток. 
Затем, если вы не получили удар, лизните кожу, чтобы она стала влажной и 
повторите. Если этот тест даст вам удар, вы конечно не захотите использовать 
ваш язык.
<P>Для проверки 12 V оближите палец и проведите одним выводом по нему. 
<P>Поместите другой проверяемый вывод на ваш язык. Если вывод на вашем языке 
положительный, то вы ощутите значительный вкус. Вы можете попробовать 
сначала с батарейками от фонариrа, так что вы будете знать какой вкус ожидать.
<P>
<P>
<HR>
<A HREF="Text-Terminal-HOWTO-16.html">Next</A>
<A HREF="Text-Terminal-HOWTO-14.html">Previous</A>
<A HREF="Text-Terminal-HOWTO.html#toc15">Contents</A>
</BODY>
</HTML>
