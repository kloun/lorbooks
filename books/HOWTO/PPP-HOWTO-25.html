<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>PPP HOWTO: Маршрутизация в LAN</TITLE>
 <LINK HREF="PPP-HOWTO-26.html" REL=next>
 <LINK HREF="PPP-HOWTO-24.html" REL=previous>
 <LINK HREF="PPP-HOWTO.html#toc25" REL=contents>
</HEAD>
<BODY>
<A HREF="PPP-HOWTO-26.html">Next</A>
<A HREF="PPP-HOWTO-24.html">Previous</A>
<A HREF="PPP-HOWTO.html#toc25">Contents</A>
<HR>
<H2><A NAME="s25">25. Маршрутизация в LAN</A></H2>

<P>Если вы соединены с LAN, но также хотите использовать PPP на вашей персональной
машине Linux, то вы должны адресовать одни пакеты в LAN (через ваш интерфейс 
ethernet), а другие на удаленный PPP сервер и дальше него (в Интернет).
<P>Этот раздел не пытается обучить вас  маршрутизации - он имеет дело 
только с простым, специальным случаем (статической) маршрутизации!
<P>Я настойчиво прошу вас прочесть Руководство Сетевого Администратора Linux 
(NAG), если вы НЕ знакомы с маршрутизацией. Также книга O'Reilly "Сетевая 
Администрация TCP/IP" раскрывает эту тему в очень понятной форме.
<P>Основное правило статической маршрутизации - ЗАДАННЫЙ ПО УМОЛЧАНИЮ маршрут 
должен быть тот, который указывает на НАИБОЛЕЕ число сетевых адресов. 
Для других сетей, введите специфические маршруты в таблицу маршрутизации.
<P>Единственая ситуация, которую я собираюсь раскрыть здесь - это, когда ваш 
Linux PC находится в LAN, которая не соединена с Интернет - и вы хотите 
позвонить наружу в Интернет для персонального использования, сохраняя 
соединение с LAN.
<P>Прежде всего удостоверитесь, что ваш маршрут Ethernet установлен так, чтобы
специфические сетевые адреса были доступны в вашей LAN  НЕ по маршруту
по умолчанию!
<P>Проверьте это, дав команду route. Вы должны увидеть что-то вроде следующего:
<PRE>
[root@hwin /root]# route -n
Kernel routing table
Destination     Gateway         Genmask         Flags MSS    Window Use Iface
loopback        *               255.255.255.0   U     1936   0       50 lo
10.0.0.0        *               255.255.255.0   U     1436   0      565 eth0
</PRE>

Если ваш интерфейс ethernet (eth0) указывает на маршрут по умолчанию, (первый 
столбец будет показывать "default" в строке eth0), то вы должны изменить ваши 
скрипты инициализации ethernet, чтобы заставить его указать на специфические 
сетевые адреса раньше, чем на заданный по умолчанию маршрут (проконсультируйтесь
с Net2 HOWTO и NAG).
<P>Это позволит pppd устанавливать ваш заданный по умолчанию маршрут как показано 
ниже:
<PRE>
[root@hwin /root]# route -n
Kernel routing table
Destination     Gateway         Genmask         Flags MSS    Window Use Iface
10.144.153.51   *               255.255.255.255 UH    488    0        0 ppp0
127.0.0.0       *               255.255.255.0   U     1936   0       50 lo
10.1.0.0        *               255.255.255.0   U     1436   0      569 eth0
default         10.144.153.51   *               UG    488    0        3 ppp0
</PRE>

Как вы видите, мы имеем главный маршрут к PPP серверу (10.144.153.51) через ppp0
и также заданный по умолчанию сетевой маршрут, который использует PPP сервер 
как шлюз.
<P>Если ваши установки должны быть более сложными, чем эта - читайте документацию
по маршрутизации, упомянутую выше и проконсультируютесь с экспертом на вашем 
сайте!
<P>Если в вашей LAN уже есть маршрутизатор, то вы уже будете иметь шлюз в 
глобальные сети, доступные вашему сайту. ТЕМ НЕ МЕНЕЕ вы должны указать ваш 
заданный по умолчанию маршрут на интерфейс PPP - и сделайте другие маршруты 
специфическими для сетей, которые они обслуживают.
<P>
<P>
<H2><A NAME="ss25.1">25.1 Обратите внимание на защиту</A>
</H2>

<P>Когда вы настриваете компьютер с Linux в существующей LAN, чтобы подключаться к
Интернет, то вы потенциально открываете вашу всю LAN Интернет - и взломщикам, 
которые постоянно находятся там. Прежде, чем вы сделаете это, я настойчиво
прошу вас проконсультироваться с вашим сетевым администратором и стратегией 
защиты сайта. Если ваше PPP соединение с Интернетом будет использовано при 
успешной атаке на ваш сайт, то на вас по крайней мере обрушится гнев ваших 
пользователей, сетевых и системных администраторов. Также для вас могут 
возникнуть более серьезные проблемы!
<P>Прежде, чем вы соедините LAN с Интернет, вы должны рассмотреть вопросы 
защиты даже для ДИНАМИЧЕСКОГО соединения - следовательно сначала обратитесь к
O'Reilly "Построение файерволов Интернет"!
<HR>
<A HREF="PPP-HOWTO-26.html">Next</A>
<A HREF="PPP-HOWTO-24.html">Previous</A>
<A HREF="PPP-HOWTO.html#toc25">Contents</A>
</BODY>
</HTML>
