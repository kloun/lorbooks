<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>Linux Security HOWTO: Что делать во время и после взлома?</TITLE>
 <LINK HREF="Security-HOWTO-11.html" REL=next>
 <LINK HREF="Security-HOWTO-9.html" REL=previous>
 <LINK HREF="Security-HOWTO.html#toc10" REL=contents>
</HEAD>
<BODY>
<A HREF="Security-HOWTO-11.html">Следующий</A>
<A HREF="Security-HOWTO-9.html">Предыдущий</A>
<A HREF="Security-HOWTO.html#toc10">Содержание</A>
<HR>
<H2><A NAME="s10">10. Что делать во время и после взлома?</A></H2>

<P>Итак, вы следуете советам этого (или какого-либо еще) документа и
обнаружили вторжение. Перво-наперво нужно оставаться
спокойным. Поспешные действия могут принести больше вреда нежели сам
взломщик. 
<P>
<P>
<H2><A NAME="ss10.1">10.1 Нарушение безопасности в процессе</A>
</H2>

<P>Обнаружение процесса нарушения безопасности может быть напряженным
предприятием. Поскольку ваши ответные действия могут иметь большие
последствия. 
<P>Если нарушение, которое вы обнаружили имеет физическую природу, есть
шансы, что вы обнаружите того, кто вломился в ваш дом, офис или
лабораторию. Вы должны предупредить своих представителей власти. В
лаборатории вы можете обнаружить кого-либо, пытающегося открыть
дипломат или перезапустить машину. В зависимости от ваших полномочий и
инструкций, вы можете сами приказать ему остановиться или сообщить
службе безопасности.
<P>Если вы обнаружили локального пользователя, пытающегося нарушить систему
безопасности, перво-наперво сообщите ему все, что вы о нем
думаете. Проверьте систему, с которой он зарегистрировался. Та ли это
система, с которой он обычно регистрируется? нет? Тогда используйте
уже не электронные средства общения. Например, позвоните ему по
телефону или посетите его офис/дом и поговорите с ним. Если он
признает, что это был он, потребуйте с него объяснений, что он делал в
вашей системе, и убедите его не делать больше этого. Если это был не
он и не может понять о чем идет речь, то скорее всего этот инцидент
требует дальнейшего расследования. Тщательно исследуйте инцидент и
прежде чем выдвигать обвинения, соберите побольше доказательств.
<P>Если вы обнаружили вторжение в сеть, перво-наперво (если вы можете)
отсоедините вашу сеть. Если вторжение произошло через модем,
отсоедините модемный кабель, тогда взломщик вероятнее всего подумает о
проблемах связи, а не об обнаружении.
<P>Если вы не можете отсоединить сеть (идет интенсивная работа, или вы не
имеете физического контроля над системой), то наилучшим будет
использовать что-то наподобие tcp_wrapper или ipfwadm для запрещения
доступа из системы взломщика.
<P>Если вы не можете запретить доступ всем из сети взломщика, то нужно
заблокировать счета пользователей. Помните, что блокирование счетов
дело не легкое. Вы должны помнить о файлах .rhosts, ftp доступе и
черных входах.
<P>После того, как вы сделаете что-либо из вышеперечисленного
(отсоедините сеть, запретите доступ из сети взломщика и/или
заблокируете их счета), вы должны убить все его пользовательские
процессы. 
<P>Некоторое время после этого вы должны очень внимательно отслеживать
состояние вашей системы, поскольку взломщик может попробовать
повторить вторжение. Вероятнее всего используя другой счет и/или с
другого сетевого адреса.
<P>
<H2><A NAME="ss10.2">10.2 Нарушение безопасности уже произошло</A>
</H2>

<P>Итак, вы либо обнаружили нарушение безопасности, которое уже
произошло, либо обнаружили его и заблокировали деятельность взломщика
в вашей системе (короче, выдворили его). Что же теперь?
<P>
<H3>Закрыть дыру</H3>

<P>Если вы можете определить, что использовал взломщик для внедрения в
вашу систему, вы должны попытаться закрыть эту дыру. Например,
возможно вы увидите несколько ftp входов, прежде чем
пользователь зарегистрировался. Выключите FTP сервис и проверьте
существует ли его обновленная версия или какой-либо список заплаток
известных ошибок.
<P>Проверьте все ваши журнальные файлы, а затем посетите ваши списки
безопасности и web-узлы на предмет наличия каких-либо новых
обнаруженных ошибок, которые вы можете исправить. Исправления для
системы безопасности Caldera вы можете найти по адресу 
<A HREF="http://www.caldera.com/tech-ref/security/">http://www.caldera.com/tech-ref/security/</A>. Red Hat еще не
имеет отдельной страницы по ошибкам безопасности от общих ошибок, но
их дистрибутив errata доступен по адресу 
<A HREF="http://www.redhat.com/errata">http://www.redhat.com/errata</A>  Очень вероятно, что если один
поставщик выпустит обновление в области безопасности, то большинство
остальных поставщиков Linux сделают тоже самое.
<P>Если вы не локализовали и не заблокировали взломщика, вероятнее всего
он вернется. Не обязательно на ваш компьютер, может на какой-то другой,
но в вашей сети. Если взломщик использовал пакетные ищейки, большие
шансы, что он имел доступ и к другим локальным машинам.
<P>
<H3>Оценка повреждений</H3>

<P>Перво-наперво нужно оценить повреждения. Что было нарушено? Если вы
используете тестер целостности такой как Tripwire - запустите его и он
вам все расскажет. Если нет, просмотрите все - особенно важные данные.
<P>Так как системы Linux становиться все легче и легче инсталировать, вы
можете скопировать куда-то ваши конфигурационные файлы, а затем
полностью очистить диск и переинсталировать систему, восстановить
файлы пользователей с резервных копий и скопировать назад
конфигурационные файлы. Это будет гарантировать полностью чистую
систему. Если вам нужно сделать резервную копию взломанной системы,
будьте особенно внимательны к выполняемым файлам, которые вы
резервируете, поскольку они могут быть "троянами", оставленными
взломщиком. 
<P>
<H3>Резервируйте, резервируйте и еще резервируйте!</H3>

<P>Лучшим решением в плане безопасности является регулярное
резервирование. Если ваша система подверглась вторжению, вы всегда
сможете восстановиться с резервных копий. Конечно, некоторые данные
могут быть ценны и для взломщика, и он могут не столько удалять их, но
и воровать, делая себе копии, но в конце концов вы по крайнем мере
сохраните эти данные. 
<P>Прежде чем восстановить поврежденный файл вы должны проверить
несколько прошлых резервных копий, а не только последнюю. Может быть,
что взломщик орудовал некоторое время назад, и вы успешно сделали
несколько резервных копий уже поврежденных файлов!!!
<P>Конечно, существует также понятие безопасности резервных
копий. Убедитесь, что вы храните их в надежном месте. Знаете, кто имеет
туда доступ. (Если взломщик получит ваши резервные копии, он будет
иметь все ваши данные, а вы даже знать об этом не будете.)
<P>
<H3>Выслеживание взломщика</H3>

<P>Хорошо, вы заблокировали взломщика, восстановили вашу систему, но это
еще не все. Поскольку маловероятно, что все взломщики будут пойманы,
вы должны сообщить об атаке.
<P>Вы должны сообщить об атаке администратору системы, с которой была
атакована ваша система. Вы можете найти этого администратора с помощью
"whois" или базы internic. Вы можете послать ему по электронной почте
содержимое системных журналов с датой и временем событий. Если вы
заметили еще что-либо отличающее вашего взломщика, вы можете также
сообщить об этом. После посылки сообщения по e-mail, вы должны (если
вы к этому склонны) связаться по телефону. Если обнаружиться, что система
того администратора была только проходным звеном, он может отследить и
связаться с администратором системы, с которой взломщик проник к нему,
и т.д.
<P>Опытные взломщики часто используют большое количество посреднических
систем. Некоторые (или многие) из которых, могут даже и не знать, что
они были взломаны. Отследить обратно путь взломщика аж до его домашней
системы может быть очень трудно. Будьте очень вежливы с
администраторами других систем при выслеживании и они вам много в чем
помогут. 
<P>Вы можете сообщить также в организацию безопасности, членом которой вы
являетесь (CERT или подобную). 
<P>
<HR>
<A HREF="Security-HOWTO-11.html">Следующий</A>
<A HREF="Security-HOWTO-9.html">Предыдущий</A>
<A HREF="Security-HOWTO.html#toc10">Содержание</A>
</BODY>
</HTML>
