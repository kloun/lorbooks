<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>ISP-Connectivity-mini-HOWTO: Подключение к внешнему миру</TITLE>
 <LINK HREF="ISP-Connectivity-HOWTO-3.html" REL=next>
 <LINK HREF="ISP-Connectivity-HOWTO-1.html" REL=previous>
 <LINK HREF="ISP-Connectivity-HOWTO.html#toc2" REL=contents>
</HEAD>
<BODY>
<A HREF="ISP-Connectivity-HOWTO-3.html">Next</A>
<A HREF="ISP-Connectivity-HOWTO-1.html">Previous</A>
<A HREF="ISP-Connectivity-HOWTO.html#toc2">Contents</A>
<HR>
<H2><A NAME="s2">2. Подключение к внешнему миру</A></H2>

<P>В этом документе, мы объясним сделать это с помощью PPP (Point to
Point Protocol), популярного протокола, почти всегда используемого для
работы в Internet. Он позволяет вашему модему связываться с внешним миром.
Это делается с помощью приложений типа Trumpet Winsock в Windows 3.x, или
многих других программ, которые вы вероятно никогда не видели.
<P>В Linux, мы используем вещь, называемую chat, чтобы звонить ISP, а затем
используем утилиту, называемую pppd, чтобы 'пользоваться' соединением. В
общем, chat - это ваша звонилка, а pppd - это ваш протокол. Ниже мы расскажем
как настроить их обоих.
<P>
<H2><A NAME="ss2.1">2.1 Переговоры и соединение с помощью pppd и chat</A>
</H2>

<P>Пожалуй наилегчайший путь настройки состоит в создании скрипта shell в
домашнем каталоге root, называемого ppp-connect, и вызове этого скрипта, когда
вам потребуется создать соединение. Мы обсудим этот метод.
<P>Запустите ваш любимый редактор от root для файла /ppp-connect. Затем вам 
надо указать ваши параметры.
<PRE>
  pppd connect 'chat -v "" "ваша_строка_инициализации" "" ATDTisp_номер CONNECT
  "" ogin: ваш_логин word: ваш_пароль' /dev/tty(0/1/2) скорость modem
</PRE>

pppd - на моей системе это программа /usr/sbin/pppd, которая запускает 
chat, чтобы набрать номер и дозвониться до провайдера. Chat отправляет на
модем вашу_строку_инициализации, затем звонит по isp_номеру. Затем он ожидает
появление строки CONNECT, затем ожидает строку ogin: (l не ставится, так как
первый символ иногда может потеряться), отправляет ваш_пароль, после чего
chat завершается и передает управление обратно pppd.
<P>Следующая команда указывает порт модема (обычно /dev/ttyS1). В большинстве
случаев это порт ttyS1 (COM2: в DOS), ttyS0 (COM1: в DOS), или же, если вы
используете Slackware, cua1 или cua0. Скорость - это значение скорости модема.
Я использую значение 115200 для своего модема (33.6k). Если ваш компьютер
недавно куплен (на нем стоит 16550 UART), тогда я вам советую ставить не 
ниже, чем 57600. Для 14.4k можно поставить 38400. Слово modem говорит
pppd, что это соединение по последовательной линии связи через модем. Можете
удалить опцию -v, если вы не желаете иметь подробные записи в вашем логфайле.
<P>Ниже приведен сценарий для тех, кто звонит тем ISP, которые автоматически
запускают PPP для них, например, им не дается shell. Вот команда для их
скрипта /ppp-connect:
<PRE>
  pppd connect 'chat "" "ATZ" "" ATDT555-1800 CONNECT "" ogin: johnny
  word: blackjak' /dev/ttyS1 115200 modem
</PRE>

Но для некоторых людей, у которых ISP запускает shell, а PPP не стартует
автоматически, такой скрипт может вызвать проблемы. К счастью, тут может 
помочь chat. Вам нужно всего лишь добавить другую строку в ваш скрипт chat. 
Например, в указанной ниже команде johnny звонит ISP, который запускает 
shell, а для установления ppp связи надо напечатать ppp. Строка приглашения 
его shell заканчивается на $.
<PRE>
  pppd connect 'chat "" "ATZ" "" ATDT555-1800 CONNECT "" ogin: johnny 
  word: blackjak $ ppp' /dev/ttyS1 115200 modem
</PRE>

Если требуется ввести более одного слова, то их надо заключить в кавычки.
Я надеюсь, что вы сможете сами это сделать, а также написать скрипт для
вашего варианта соединения. Просто исправьте или первый скрипт запуска pppd,
или второй.
<P>Сейчас, когда вы сделали ваш файл, удостоверьтесь, что только root может его
выполнять, читать или писать в него. Это исключительно важно. Также будьте 
уверены, что никто не может читать ваши логи, если вы решили оставить опцию
-v, так как ваш пароль в них виден непосредственно (я не вижу особой нужды в
этой опции, и если вы не знаете о чем я говорю, то выкиньте -v).
<P>
<P>
<H2><A NAME="ss2.2">2.2 IP адреса, доменные имена и подсети</A>
</H2>

<P>Большинство людей, использующих вышеприведенные возможности, смена IP адреса
мало беспокоит. Эти люди - пользователи с базовым или слегка продвинутым 
уровнем знаний, которые имеют только аккаунты для входа по коммутируемым
телефонным линиям, и они не склонны углубляться в технические вопросы.
Для этих людей  я расскажу важные вещи, которые надо знать, чтобы правильно
установить систему. Новички, пропутите раздел о постоянных IP адресах,
доменных именах и подсетях и только читайте последнюю часть раздела.
<P>Получение постоянного IP адреса не должно быть затруднительно для вашего ISP,
так что если есть сомнения, то спросите их. Лично я заплатил за постоянный
IP адрес. Он позволяет вам отправлять и принимать электронную почту,
используя уникальный IP адрес или домен, итд. Если вы хотите получить
постоянный IP адрес, напишите на адрес root@yourisp.com, и спросите может ли
он выделить вам постоянный IP адрес.
<P>Когда вы получили ваш постоянный IP адрес, выполните grep по каталогу /etc
и отыщите все ваши старые IP адреса. Мне понадобилось изменить файлы в
каталоге sendmail и /etc/hosts. Есть еще некоторые другие ключевые файлы,
коорые можно найти только используя grep. Откройте /etc/hosts, и добавьте
ваш новый IP адрес в стандартном формате. Перегрузите ваш компьютер и вы
готовы идти дальше.
<P>Теперь вам надо изменить ваш chat-скрипт, чтобы он соответствовал новым 
установкам. Если вы сразу после соединения переходите в PPP, вам нужно
сказать системному администратору вашего ISP, чтобы он удостоверился, что их 
система PPP распознает, что у вас постоянный IP адрес и устанавливает вам 
ваш адрес. Если вы получаете командную строку shell, и вам нужно напечатать 
ppp или что-то еще, чтобы запустить соединение, то вместо того, чтобы 
набирать эти слова, измените ваш скрипт /ppp-connect, чтобы он отправлял то, 
что нужно, когда видит $ или другой признак командной строки shell.
<PRE>
  /usr/sbin/pppd :Ваш_IP_адрес
</PRE>

Замените Ваш_IP_адрес на адрес, который ваш ISP дал вам. Убедитесь, что
вы не забываете применять " " (кавычки) в вашем сценарии chat. Если это не 
работает, спросите вашего ISP, где расположен PPP демон, и спросите какие 
команды ему давать. Вы могли бы оставить все как есть и посмотреть, может 
сервер распознает вас и даст вам ваш правильный адрес.
<P>Следующая вещь, которую вам вероятно захочется сделать - это получить
доменное имя. Я знаю, что в Австралии домены .asn.au и .org.au свободны.
В США вы можете получить домен .us , но они имеют тенденцию у удлинению. 
Если вы выбрали австралийский домен, то вам надо зарегистрировать его на
<A HREF="http://www.aunic.net/">http://www.aunic.net/</A>. 
В США это 
<A HREF="http://www.internic.net/">http://www.internic.net/</A> .
<P>Для регистрации домена вам нужно иметь возможность обслуживать DNS, and
gorey stuff like that. Если ваш ISP не может обеспечить их, выбросьте
официальный домен .asn.au или другой в окно, и возьмите Monolith
Internet Domain.
<P>Monolith предлагает беплатные домены всем кто захочет в любой точке мира.
Все делается автоматически через web интерфейс с помощью вашего браузера. 
Ваш домен приходит в форме Your_Choice.ml.org. Monolith будет управлять
DNS для вас. Если вы хотите отправлять и принимать почту с этого домена,
попросите вашего ISP настроить обмен почты для вашего домена.
<P>Идите на 
<A HREF="http://www.ml.org/">http://www.ml.org/</A> и заполните приложение, введите NIC
с вашим именем и паролем, и создайте домен FREED. Вам нужно ввести ваш
IP адрес, поэтому будьте готовы. Выш домен появится в DNS в течении 
нескольких дней.
<P>А сейчас, мы займемся новичками, или теми, кто не может получить постоянный 
IP адрес или доменное имя. Все, что нужно сделать - отредактирровать 
/etc/hosts от пользователя root, присвоив вашему сайту какие-нибудь 
неконфликтующие имя и адрес (типа 10.10.10) и перегрузить машину.
<P>Вы только что настроили у себя pppd и chat. На это ушло порядка десятка минут.
Сейчас давайте перейдем в следующий раздел, который посвящен электронной
почте.
<HR>
<A HREF="ISP-Connectivity-HOWTO-3.html">Next</A>
<A HREF="ISP-Connectivity-HOWTO-1.html">Previous</A>
<A HREF="ISP-Connectivity-HOWTO.html#toc2">Contents</A>
</BODY>
</HTML>
