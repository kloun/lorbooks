<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Мини-HOWTO: Настройка шрифтов TrueType Fonts в Debian </TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.57"></HEAD
><BODY
CLASS="ARTICLE"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="ARTICLE"
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
><A
NAME="AEN2"
>Мини-HOWTO: Настройка шрифтов TrueType Fonts в Debian</A
></H1
><DIV
CLASS="AUTHORGROUP"
><A
NAME="AEN4"
></A
><H3
CLASS="AUTHOR"
><A
NAME="AEN5"
>Bear Giles</A
></H3
><DIV
CLASS="AFFILIATION"
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
>&nbsp;&nbsp;&nbsp;&nbsp;     bgiles@coyotesong.com
    <br>
&nbsp;&nbsp;&nbsp;</P
></DIV
></DIV
><H3
CLASS="CORPAUTHOR"
> Перевод: <A
HREF="mailto:sam@asp-linux.com"
TARGET="_top"
>Станислав Рогин</A
>,
 <A
HREF="http://www.asplinux.com"
TARGET="_top"
>SWSoft Pte Ltd.</A
>
 </H3
></DIV
><P
CLASS="PUBDATE"
>версия 0.3, 10 января 2000 года<BR></P
><DIV
><DIV
CLASS="ABSTRACT"
><A
NAME="AEN15"
></A
><P
></P
><P
>В этом документе дается описание настройки Debian GNU/Linux на
использование TrueType-шрифтов для вывода на экран и принтер. Последнюю
версию этого документа можно найти по адресу
<TT
CLASS="LITERAL"
><A
HREF="http://www.dimensional.com/~bgiles/debian-tt.html"
TARGET="_top"
>http://www.dimensional.com/~bgiles/debian-tt.html</A
></TT
></P
><P
></P
></DIV
></DIV
><HR></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Содержание</B
></DT
><DT
>1. <A
HREF="TT-Debian.html#AEN19"
>Введение</A
></DT
><DD
><DL
><DT
>1.1. <A
HREF="TT-Debian.html#AEN50"
>Ответственность</A
></DT
><DT
>1.2. <A
HREF="TT-Debian.html#AEN54"
>Благодарности</A
></DT
><DT
>1.3. <A
HREF="TT-Debian.html#AEN73"
>Дополнительные ссылки</A
></DT
><DT
>1.4. <A
HREF="TT-Debian.html#AEN94"
>История изменений</A
></DT
><DT
>1.5. <A
HREF="TT-Debian.html#AEN104"
>Отзывы</A
></DT
><DT
>1.6. <A
HREF="TT-Debian.html#AEN108"
>Связанные проекты</A
></DT
><DT
>1.7. <A
HREF="TT-Debian.html#AEN117"
>Распространение</A
></DT
></DL
></DD
><DT
>2. <A
HREF="TT-Debian.html#AEN124"
>Дисплей (то, что вам никто не рассказывал)</A
></DT
><DD
><DL
><DT
>2.1. <A
HREF="TT-Debian.html#AEN153"
>Будущее XFree86 4.0</A
></DT
><DT
>2.2. <A
HREF="TT-Debian.html#AEN157"
>Общий обзор: приготовления перед правкой файлов конфигурации <TT
CLASS="LITERAL"
>X</TT
>.</A
></DT
></DL
></DD
><DT
>3. <A
HREF="TT-Debian.html#AEN165"
>Дисплей (<TT
CLASS="LITERAL"
>X</TT
>-серверы и серверы шрифтов)</A
></DT
><DD
><DL
><DT
>3.1. <A
HREF="TT-Debian.html#AEN171"
>Настройка сервера шрифтов <TT
CLASS="LITERAL"
>xfs</TT
></A
></DT
><DT
>3.2. <A
HREF="TT-Debian.html#AEN239"
>Настройка сервера шрифтов <TT
CLASS="LITERAL"
>xfstt</TT
> и установка шрифтов TrueType</A
></DT
><DT
>3.3. <A
HREF="TT-Debian.html#AEN294"
>Использование шрифтов TrueType</A
></DT
><DT
>3.4. <A
HREF="TT-Debian.html#AEN301"
>Установка дополнительных шрифтов TrueType</A
></DT
><DT
>3.5. <A
HREF="TT-Debian.html#AEN314"
>Интернационализация</A
></DT
><DT
>3.6. <A
HREF="TT-Debian.html#AEN426"
>Вопросы безопасности</A
></DT
></DL
></DD
><DT
>4. <A
HREF="TT-Debian.html#AEN436"
>Печать (<TT
CLASS="LITERAL"
>ghostscript</TT
>)</A
></DT
><DD
><DL
><DT
>4.1. <A
HREF="TT-Debian.html#AEN449"
>Настройка <TT
CLASS="LITERAL"
>Ghostscript</TT
> на использование шрифтов TrueType</A
></DT
><DT
>4.2. <A
HREF="TT-Debian.html#AEN480"
>Печать образцов шрифтов TrueType</A
></DT
></DL
></DD
><DT
>5. <A
HREF="TT-Debian.html#AEN494"
>Настройка программ</A
></DT
><DD
><DL
><DT
>5.1. <A
HREF="TT-Debian.html#AEN496"
>Генерация метрик шрифтов AFM <TT
CLASS="LITERAL"
>AFM</TT
></A
></DT
><DT
>5.2. <A
HREF="TT-Debian.html#AEN513"
>Создание файлов <TT
CLASS="LITERAL"
>font.map</TT
></A
></DT
><DT
>5.3. <A
HREF="TT-Debian.html#AEN532"
>Работа с изображениями: <TT
CLASS="LITERAL"
>GIMP</TT
></A
></DT
><DT
>5.4. <A
HREF="TT-Debian.html#AEN538"
>Преобразование ASCII в PostScript: <TT
CLASS="LITERAL"
>enscript</TT
></A
></DT
><DT
>5.5. <A
HREF="TT-Debian.html#AEN559"
>Форматирование и обработка текста: <TT
CLASS="LITERAL"
>groff</TT
></A
></DT
><DT
>5.6. <A
HREF="TT-Debian.html#AEN609"
>Набор и форматирование текстов: <TT
CLASS="LITERAL"
>TeX</TT
></A
></DT
></DL
></DD
><DT
>6. <A
HREF="TT-Debian.html#AEN617"
>Незаданные вопросы</A
></DT
><DT
>7. <A
HREF="TT-Debian.html#AEN629"
>Где найти шрифты TrueType</A
></DT
><DD
><DL
><DT
>7.1. <A
HREF="TT-Debian.html#AEN648"
>Небольшое дополнение по использованию бесплатных TrueType шрифтов Microsoft</A
></DT
></DL
></DD
><DT
>8. <A
HREF="TT-Debian.html#AEN669"
>Legalities</A
></DT
><DT
>9. <A
HREF="TT-Debian.html#AEN676"
>Авторские права</A
></DT
></DL
></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN19"
>1. Введение</A
></H1
><P
>Любая инсталляция Linux обычно содержит несколько независимых наборов шрифтов или их метрик. Если бросить быстрый взгляд на шрифты в Linux, то он пройдет по следующим каталогам: </P
><P
>&#13;<P
></P
><UL
><LI
><P
><TT
CLASS="LITERAL"
>XFree86</TT
> хранит свои шрифты в <TT
CLASS="LITERAL"
>/usr/X11R6/lib/X11/fonts/</TT
></P
></LI
><LI
><P
><TT
CLASS="LITERAL"
>Ghostscript</TT
> содержит свои шрифты в <TT
CLASS="LITERAL"
>/usr/lib/ghostscript/fonts/</TT
></P
></LI
><LI
><P
>Шрифты <TT
CLASS="LITERAL"
>TeX</TT
> находятся в <TT
CLASS="LITERAL"
>/usr/lib/texmf/fonts/</TT
></P
></LI
><LI
><P
>Пакет <TT
CLASS="LITERAL"
>kbd</TT
> дистрибутива Debian содержит шрифты в <TT
CLASS="LITERAL"
>/usr/share/consolefonts/</TT
></P
></LI
><LI
><P
><TT
CLASS="LITERAL"
>Groff</TT
> содержит метрики шрифтов в <TT
CLASS="LITERAL"
>/usr/share/font/devps/</TT
></P
></LI
><LI
><P
><TT
CLASS="LITERAL"
>Enscript</TT
> (конвертер из ASCII в PostScript) содержит метрики в <TT
CLASS="LITERAL"
>/usr/share/enscript/*.afm</TT
></P
></LI
></UL
>&#13;</P
><P
>Не надо говорить, что шрифты не скоординированы между собой. </P
><P
>Шрифты TrueType существуют для того, чтобы исключить эту проблему, путем использования одних и тех же шрифтов для вывода на экран и печать. В этом документе мы попытаемся показать, как использовать шрифты TrueType для вывода на экран, принтер и для подготовки документов в дистрибутиве Debian GNU/Linux. </P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN50"
>1.1. Ответственность</A
></H2
><P
>В этом документе приведена, насколько я могу судить об этом, верная информация. Однако этот HOWTO до сих пор находится на стадии разработки, поэтому то, что работает у меня, может не работать у вас. Если даже у вас все работает, то помните, что я не профессиональный автор технических текстов, и я известен тем, что люблю упускать критические детали. 
&#13;</P
><P
>Поэтому веселитесь, но с опаской, и почаще делайте резервные копии. </P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN54"
>1.2. Благодарности</A
></H2
><P
>Автор этого документа - Bear Giles, <TT
CLASS="LITERAL"
><A
HREF="mailto:bgiles@coyotesong.com"
TARGET="_top"
>&#60;bgiles@coyotesong.com&#62;</A
></TT
></P
><P
>Большая благодарность: 

<P
></P
><UL
><LI
><P
> Brion Vibber, 
<TT
CLASS="LITERAL"
><A
HREF="mailto:brion@pobox.com"
TARGET="_top"
>&#60;brion@pobox.com&#62;</A
></TT
>, написавшему  
<TT
CLASS="LITERAL"
><A
HREF="http://pobox.com/~brion/linux/TrueType-HOWTO.html"
TARGET="_top"
>(preliminary) TrueType HOW-TO (http://pobox.com/~brion/linux/TrueType-HOWTO.html)</A
></TT
></P
></LI
><LI
><P
> Doug Holland, 
<TT
CLASS="LITERAL"
><A
HREF="mailto:meldroc@frii.com"
TARGET="_top"
>&#60;meldroc@frii.com&#62;</A
></TT
>, написавшему 
<TT
CLASS="LITERAL"
><A
HREF="http://www.frii.com/~meldroc/Font-Deuglification.html"
TARGET="_top"
>XFree86 Font Deuglification HOW-TO  (http://www.frii.com/~meldroc/Font-Deuglification.html)</A
></TT
></P
></LI
></UL
>&#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN73"
>1.3. Дополнительные ссылки</A
></H2
><P
>Ниже приведены ссылки на документы, не описывающие напрямую систему Debian или ее пакеты, но которые все-таки могут быть интересны читателям этого документа. </P
><P
>&#13;<P
></P
><UL
><LI
><P
>Использование TrueType шрифтов в RedHat Linux 
<TT
CLASS="LITERAL"
><A
HREF="http://www.kegel.com/linux/tt.html"
TARGET="_top"
>(http://www.kegel.com/linux/tt.html)</A
></TT
>&#13;</P
></LI
><LI
><P
>Утилиты для работы со шрифтами в X 
<TT
CLASS="LITERAL"
><A
HREF="http://www.hex.net/~cbbrowne/xfonts.html"
TARGET="_top"
>(http://www.hex.net/~cbbrowne/xfonts.html)</A
></TT
>&#13;</P
></LI
><LI
><P
>Улучшение внешнего вида шрифтов в GNU/Linux в различных приложениях (например StarOffice) <TT
CLASS="LITERAL"
><A
HREF="http://king.ccrc.wustl.edu/~zubin/fonts.html"
TARGET="_top"
>(http://king.ccrc.wustl.edu/~zubin/fonts.html)</A
></TT
>&#13;</P
></LI
><LI
><P
>Как использовать True Type c шрифты в StarOffice в Linux 
<TT
CLASS="LITERAL"
><A
HREF="http://www.mindspring.net/~john_mcl/adding_fonts.html"
TARGET="_top"
>(http://www.mindspring.net/~john_mcl/adding_fonts.html)</A
></TT
>&#13;</P
></LI
></UL
>&#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN94"
>1.4. История изменений</A
></H2
><P
>&#13;<P
></P
><UL
><LI
><P
>Версия 0.1. 16 сентября 1999: Исходная версия. </P
></LI
><LI
><P
>0.2. 16 сентября 1999: добавлен раздел "Дополнительные ссылки". </P
></LI
><LI
><P
>0.3. 10 января 2000: отзывы читателей! Добавлено разъяснение некоторых деталей. </P
></LI
></UL
>&#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN104"
>1.5. Отзывы</A
></H2
><P
>Комментарии, исправления, дополнения и критика только приветствуются. Меня можно найти по адресу <A
HREF="mailto:bgiles@coyotesong.com"
TARGET="_top"
>bgiles@coyotesong.com</A
>.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN108"
>1.6. Связанные проекты</A
></H2
><P
>&#13;<P
></P
><UL
><LI
><P
> FreeType 
<A
HREF="http://www.freetype.org/"
TARGET="_top"
>http://www.freetype.org/</A
></P
><P
>FreeType - это бесплатная библиотека обработки и вывода TrueType шрифтов,
адаптируемая на различные системы. Ее код представляет из себя полностью
независимую реализацию "с чистого листа", абсолютно независимую от
вариантов Apple и Microsoft. (Однако поднимался вопрос о возможном
использовании <I
CLASS="EMPHASIS"
>патента</I
> Apple.) FreeType - это только библиотека, а не сервер
шрифтов или полноразмерная библиотека работы с обработкой или выводом
текста.&#13;</P
></LI
></UL
>&#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN117"
>1.7. Распространение</A
></H2
><P
>Это первый пробный черновик этого документа, и я предполагаю внести в него значительные изменения после первого издания - наиболее новую версию вы можете найти по адресу <TT
CLASS="LITERAL"
><A
HREF="http://www.dimensional.com/~bgiles/debian-tt.html"
TARGET="_top"
>http://www.dimensional.com/~bgiles/debian-tt.html</A
></TT
>.
В конце концов финальная версия этого документа будет находиться по адресу
<TT
CLASS="LITERAL"
><A
HREF="http://www.coyotesong.com/"
TARGET="_top"
>http://www.coyotesong.com/</A
></TT
></P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN124"
>2. Дисплей (то, что вам никто не рассказывал)</A
></H1
><P
>Перед тем, как мы углубимся в настройку шрифтов TrueType в X, мы должны еще раз объяснить разницу между пунктами (point) и пикселями (pixel)... и почему это важно для нас. </P
><P
>Все выводимые на экран шрифты измеряются в <I
CLASS="EMPHASIS"
>пунктах</I
>. Один дюйм равен ровно
72 пунктам. Почему именно 72? Частично из-за ограничений механических
печатных машин, частично потому, что это число делится на 2, 3, 4, 6, 8, 9,
12, 18 и 24. Ну и конечно надо упомянуть, что пункт является основной
единицей измерения в PostScript.&#13;</P
><P
>(Историческая справка: Тут я немного приврал. До введения PostScript дюйм
равнялся 72,27 пункта, но этот размер пункта был установлен в эру
механических печатающих машин. При помощи дисплеев и лазерных принтеров,
любому шрифту легко можно придать любой размер, и число 72 <I
CLASS="EMPHASIS"
>значительно</I
> более
удобно по причинам, упомянутым выше).</P
><P
>В основном любой текст имеет размер от 7 до 12 пунктов. Все, что меньше 6, называется буквально - "точная печать". Построчные принтеры печатали шрифтами размером 9 или 12 (для того, чтобы было 8 или 6 строк на дюйм соответственно). </P
><P
>В противоположность этому, все видеодрайверы повсеместно измеряют шрифты в
<I
CLASS="EMPHASIS"
>пикселях</I
>. Для вашего видеодрайвера экран имеет размер 1024x768 пикселей, а
не 10 на 8 дюймов (или 720 на 576 пунктов).</P
><P
>Чтобы произвести преобразование из пунктов (в которых мы измеряем размер
шрифта) в пиксели (в которых мы измеряем видеопамять) нужно знать
разрешение экрана. Обычно оно измеряется в точках на дюйм (dots per inch
(dpi)), что на самом деле есть пиксели на дюйм. Эти единицы используются в
двух наборах растровых шрифтов, поставляемых вместе с XFree86: <TT
CLASS="LITERAL"
>fonts-75</TT
>
используются на недорогих дисплеях с разрешением около 75 dpi, <TT
CLASS="LITERAL"
>fonts-100</TT
>
используются на мониторах среднего качества с разрешением примерно 100 dpi.
К сожалению, в поставку не входят шрифты для высококачественных дисплеев с
разрешением 120 dpi и выше.</P
><P
>В качестве конкретного примера можно привести экран с диагональю 13 дюймов (видимая область изображения 11.1 дюйма), выводит изображение размером 640x480 пикселей с разрешением 72.0 dpi. Это Не Совпадение. На самом деле многие web-страницы (и приложения фирмы Microsoft) рассчитаны на стандартные дисплеи с разрешением именно 72 dpi. Стандартная конфигурация XFree86 предполагает наличие дисплея с разрешением 75 dpi. </P
><P
>Однако в настоящее время никто уже практически не пользуется разрешением 640x480. Никто больше не использует 13-дюймовые мониторы. Так как видеокарты обогнали в своем развитии мониторы, то можно нередко встретить следующую конфигурацию: 19-дюймовый монитор (диагональ изображения больше 17 дюймов), 1600x1200 пикселей, разрешение - 117 точек на дюйм. </P
><P
>Если я запущу стандартную конфигурацию X, то все мои шрифты будут равны примерно 2/3 нормального размера. Не будет преувеличением сказать, что все шрифты будут уменьшены на порядок - большие шрифты (12 пунктов) станут средними (9). Средние шрифты (9) станут маленькими (6). </P
><P
>Существует три вещи, которые надо сделать, чтобы исправить это несоответствие. Во-первых, мы должны указать X-серверу настоящее разрешение экрана: </P
><P
>&#13;<I
CLASS="EMPHASIS"
>/etc/X11/xdm/Xservers</I
>

<PRE
CLASS="PROGRAMLISTING"
>#:0 local /usr/X11R6/bin/X -bpp 16
:0 local /usr/X11R6/bin/X -bpp 16 -dpi 120</PRE
>&#13;</P
><P
>Во-вторых, мы должны использовать по умолчанию сначала растровые шрифты с разрешением 100 dpi, и только после них шрифты 75 dpi. </P
><P
>&#13;<I
CLASS="EMPHASIS"
>/etc/X11/XF86Config</I
>

<PRE
CLASS="PROGRAMLISTING"
>Section "Files"
    RgbPath    "/usr/X11R6/lib/X11/rgb"
    FontPath   "/usr/X11R6/lib/X11/fonts/100dpi/"
    FontPath   "/usr/X11R6/lib/X11/fonts/75dpi/"
    FontPath   "/usr/X11R6/lib/X11/fonts/misc/"
    FontPath   "/usr/X11R6/lib/X11/fonts/Type1/"
    FontPath   "/usr/X11R6/lib/X11/fonts/Speedo/"
EndSection</PRE
>&#13;</P
><P
>И еще одно. Если ни один из наших растровых шрифтов не совпадает по
разрешению с требуемым, то <TT
CLASS="LITERAL"
>X</TT
>-сервер попытается "растянуть" похожий шрифт
через простое копирование пикселей. Результаты такого "растягивания" всегда
оставляют желать лучшего. Предположив, что у нас достаточно
быстродействующий компьютер, мы можем указать серверу использовать по
умолчанию векторные шрифты, затем подходящие "один-к-одному" растровые
шрифты и только затем "растянутые" растровые шрифты.</P
><P
>&#13;<I
CLASS="EMPHASIS"
>/etc/X11/XF86Config</I
>

<PRE
CLASS="PROGRAMLISTING"
>Section "Files"
    RgbPath    "/usr/X11R6/lib/X11/rgb"
    FontPath   "/usr/X11R6/lib/X11/fonts/Type1/"
    FontPath   "/usr/X11R6/lib/X11/fonts/Speedo/"
    FontPath   "/usr/X11R6/lib/X11/fonts/100dpi/:unscaled"
    FontPath   "/usr/X11R6/lib/X11/fonts/75dpi/:unscaled"
    FontPath   "/usr/X11R6/lib/X11/fonts/misc/"
    FontPath   "/usr/X11R6/lib/X11/fonts/100dpi/"
    FontPath   "/usr/X11R6/lib/X11/fonts/75dpi/"
EndSection</PRE
>&#13;</P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN153"
>2.1. Будущее XFree86 4.0</A
></H2
><P
>Мне совсем недавно сказали, что XFree86 версии 4.0 будет поддерживать DDC, если его поддерживают и видеокарта, и монитор. Это позволит X-серверу узнавать его физические размеры, и сервер сможет автоматически рассчитывать разрешение экрана. </P
><P
>Но вам, в любом случае, придется исправлять установки fontpath в файле XF86Config, так как сервер не может угадать требования вашей конкретной конфигурации. &#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN157"
>2.2. Общий обзор: приготовления перед правкой файлов конфигурации <TT
CLASS="LITERAL"
>X</TT
>.</A
></H2
><P
>Каждый раз, когда мы вносим изменения в файлы конфигурации X11, неплохо
запрещать запуск <TT
CLASS="LITERAL"
>XDM</TT
>, указанием команды <TT
CLASS="LITERAL"
>exit 0</TT
> где-нибудь в начале этого
файла. Если вы этого не сделаете, и <TT
CLASS="LITERAL"
>X</TT
> не запустится по каким-либо причинам,
то <TT
CLASS="LITERAL"
>XDM</TT
> зациклится таким образом, что перегрузит систему, и это достаточно
сложно исправить. Я вас предупредил.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN165"
>3. Дисплей (<TT
CLASS="LITERAL"
>X</TT
>-серверы и серверы шрифтов)</A
></H1
><P
>Строго говоря, абсолютно не обязательно настраивать серверы шрифтов для
использования шрифтов TrueType с <TT
CLASS="LITERAL"
>X</TT
>-серверами. Если вы хотите использовать
статические файлы, вместо сервера шрифтов, то смотрите инструкции по
настройке использования шрифтов TrueType в <TT
CLASS="LITERAL"
>ghostscript</TT
>.</P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN171"
>3.1. Настройка сервера шрифтов <TT
CLASS="LITERAL"
>xfs</TT
></A
></H2
><P
>С этого момента, я предполагаю, что у вас имеется работающий файл
<TT
CLASS="LITERAL"
>/etc/X11/XF86Config</TT
>, загружающий шрифты из четко определенных в разделе
<TT
CLASS="LITERAL"
>FontPath</TT
> каталогов. Мы его исправим таким образом, чтобы он использовал
сервер шрифтов <TT
CLASS="LITERAL"
>xfs</TT
>.</P
><P
>&#13;<P
></P
><UL
><LI
><P
>Установка <TT
CLASS="LITERAL"
>XFS</TT
></P
><P
>Если вы еще этого не сделали, установите пакет  <TT
CLASS="LITERAL"
>main/binary-*/x11/xfs_*.deb</TT
>.</P
></LI
><LI
><P
>Настройка <TT
CLASS="LITERAL"
>XFS</TT
></P
><P
>Откройте файл <TT
CLASS="LITERAL"
>/etc/X11/xfs/config</TT
> и измените опцию <TT
CLASS="LITERAL"
>catalogue</TT
> так, чтобы она
соответствовала секции <TT
CLASS="LITERAL"
>FontList</TT
> из файла /etc/X11/XF86Config. Вам также,
возможно, надо будет изменить значение опции <TT
CLASS="LITERAL"
>default-resolutions</TT
>.</P
><P
>&#13;<I
CLASS="EMPHASIS"
>/etc/X11/xfs/config</I
>

<PRE
CLASS="PROGRAMLISTING"
># paths to search for fonts
catalogue = 
    /usr/X11R6/lib/X11/fonts/100dpi/:unscaled,
    /usr/X11R6/lib/X11/fonts/75dpi/:unscaled,
    /usr/X11R6/lib/X11/fonts/misc/,
    /usr/X11R6/lib/X11/fonts/Speedo/,
    /usr/X11R6/lib/X11/fonts/Type1/,
    /usr/X11R6/lib/X11/fonts/100dpi/,
    /usr/X11R6/lib/X11/fonts/75dpi/
# x1,y1,x2,y2,...
default-resolutions = 100,100,75,75</PRE
>&#13;</P
></LI
><LI
><P
>Перезапуск <TT
CLASS="LITERAL"
>XFS</TT
></P
><P
>Перезапуск <TT
CLASS="LITERAL"
>XFS</TT
> обычным для Debian образом: </P
><P
>&#13;<I
CLASS="EMPHASIS"
>root shell</I
>

<PRE
CLASS="PROGRAMLISTING"
># /etc/init.d/xfs restart</PRE
>&#13;</P
></LI
><LI
><P
>Проверка работы <TT
CLASS="LITERAL"
>XFS</TT
></P
><P
>Перед тем, как мы начнем исправлять файл <TT
CLASS="LITERAL"
>XF86Config</TT
>, необходимо проверить
работоспособность сервера <TT
CLASS="LITERAL"
>xfs</TT
>. Для этого мы выведем на экран список
доступных через него шрифтов:</P
><P
>&#13;<I
CLASS="EMPHASIS"
>user shell</I
>

<PRE
CLASS="PROGRAMLISTING"
>$ fslsfonts -server unix/:7100
-adobe-courier-bold-i-normal--0-0-0-0-m-0-iso8859-1
-adobe-courier-bold-o-normal--0-0-100-100-m-0-iso8859-1
-adobe-courier-bold-o-normal--0-0-75-75-m-0-iso8859-1
....</PRE
>&#13;</P
></LI
><LI
><P
>Исправление <TT
CLASS="LITERAL"
>/etc/X11/XF86Config</TT
> </P
><P
>Теперь мы готовы указать X-серверу использовать сервер шрифтов <TT
CLASS="LITERAL"
>xfs</TT
>.
Оставим путь к одному каталогу со шрифтами на тот случай, если у нас
возникнут проблемы с <TT
CLASS="LITERAL"
>xfs</TT
>. (Оставляем каталог "misc". потому что в нем
содержится шрифт <TT
CLASS="LITERAL"
>fixed</TT
>, который используется в X по умолчанию.)</P
><P
>&#13;<I
CLASS="EMPHASIS"
>/etc/X11/XF86Config</I
>

<PRE
CLASS="PROGRAMLISTING"
>Section "Files"
    FontPath   "unix/:7100"
    FontPath   "/usr/X11R6/lib/X11/fonts/misc/"
EndSection</PRE
>&#13;</P
></LI
><LI
><P
>Перезапуск <TT
CLASS="LITERAL"
>X</TT
></P
><P
>Перезапустите <TT
CLASS="LITERAL"
>X</TT
> командой <TT
CLASS="LITERAL"
>startx</TT
>, в случае, если вы не любите острые
ощущения. Если любите - то трижды назовите имя компании, которая вас
застраховала на большую сумму, и затем, скрестив пальцы, перезапустите <TT
CLASS="LITERAL"
>xdm</TT
>.</P
></LI
><LI
><P
>Проверка работоспособности шрифтов <TT
CLASS="LITERAL"
>XFS</TT
></P
><P
>Как только у нас загрузился сеанс работы <TT
CLASS="LITERAL"
>X</TT
>, мы можем проверить, видит ли
наш сервер шрифты <TT
CLASS="LITERAL"
>xfs</TT
>, выведя список шрифтов экран командой:</P
><P
>&#13;<I
CLASS="EMPHASIS"
>user shell</I
>

<PRE
CLASS="PROGRAMLISTING"
>$ xlsfonts
-adobe-courier-bold-i-normal--0-0-0-0-m-0-iso8859-1
-adobe-courier-bold-o-normal--0-0-100-100-m-0-iso8859-1
-adobe-courier-bold-o-normal--0-0-75-75-m-0-iso8859-1
....</PRE
>&#13;</P
></LI
></UL
>&#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN239"
>3.2. Настройка сервера шрифтов <TT
CLASS="LITERAL"
>xfstt</TT
> и установка шрифтов TrueType</A
></H2
><P
>К этому моменту, я предполагаю, что вы имеете работающий сервер шрифтов <TT
CLASS="LITERAL"
>xfs</TT
>
и хотите установить поддержку шрифтов TrueType при помощи <TT
CLASS="LITERAL"
>xfstt</TT
>.</P
><P
>&#13;<P
></P
><UL
><LI
><P
>Установка <TT
CLASS="LITERAL"
>XFSTT</TT
></P
><P
>Установите <TT
CLASS="LITERAL"
>main/binary-*/x11/xfstt_*.deb</TT
>, если вы еще этого не сделали. </P
></LI
><LI
><P
>Установка шрифтов TrueType</P
><P
>Скопируйте ваши шрифты TrueType в каталог <TT
CLASS="LITERAL"
>/usr/share/fonts/truetype</TT
>. Эти
файлы обычно имеют расширение <TT
CLASS="LITERAL"
>.ttf</TT
>, и на них должны быть установлены права
с маской <TT
CLASS="LITERAL"
>0444</TT
>.</P
></LI
><LI
><P
>Перезапуск сервера шрифтов <TT
CLASS="LITERAL"
>XFSTT</TT
></P
><P
>Перезапустите сервер <TT
CLASS="LITERAL"
>xfstt</TT
> с опцией <TT
CLASS="LITERAL"
>force-reload</TT
> flag</P
><P
>&#13;<I
CLASS="EMPHASIS"
>root shell</I
>

<PRE
CLASS="PROGRAMLISTING"
># /etc/init.d/xfstt force-reload</PRE
>&#13;</P
></LI
><LI
><P
>Проверка работы <TT
CLASS="LITERAL"
>XFSTT</TT
></P
><P
>Перед тем, как мы изменим файл <TT
CLASS="LITERAL"
>XF86Config</TT
> необходимо проверить, работает ли вообще сервер <TT
CLASS="LITERAL"
>xfstt</TT
>. </P
><P
><I
CLASS="EMPHASIS"
>Важно: Сервер <TT
CLASS="LITERAL"
>xfstt</TT
> в дистрибутиве Debian использует порт 7101, вместо 7100. Права на его использование установлены по умолчанию так, что этот запрос доступен только root-у. </I
></P
><P
>&#13;<I
CLASS="EMPHASIS"
>user and root shells</I
>

<PRE
CLASS="PROGRAMLISTING"
>$ fslsfonts -server unix/:7101
_FSTransSocketUNIXConnect: Can't connect: errno = 111
fslsfonts:  unable to open server "unix/:7101"

# fslsfonts -server unix/:7101
-ttf-arial black-medium-r-normal-regular-0-0-0-0-p-0-iso8859-1
-ttf-arial mt black-medium-r-normal-regular-0-0-0-0-p-0-iso8859-1
-ttf-arial narrow-bold-i-normal-bold italic-0-0-0-0-p-0-iso8859-1</PRE
>&#13;</P
></LI
><LI
><P
>Включение в <TT
CLASS="LITERAL"
>/etc/X11/XF86Config</TT
> использования <TT
CLASS="LITERAL"
>xfstt</TT
></P
><P
>Теперь мы готовы к тому, чтобы указать X-серверу использовать сервер
шрифтов <TT
CLASS="LITERAL"
>xfstt</TT
>. Мы хотим, чтобы шрифты TrueType имели наибольший приоритет.</P
><P
>&#13;<I
CLASS="EMPHASIS"
>/etc/X11/XF86Config</I
>

<PRE
CLASS="PROGRAMLISTING"
>Section "Files"
    FontPath   "unix/:7101"
    FontPath   "unix/:7100"
    FontPath   "/usr/X11R6/lib/X11/fonts/misc/"
EndSection</PRE
>
&#13;</P
></LI
><LI
><P
>Проверка работы шрифтов сервера <TT
CLASS="LITERAL"
>XFSTT</TT
> </P
><P
>Как только у нас загрузился сеанс работы X, мы можем проверить, видит ли наш сервер шрифты TrueType, выведя их список на экран командой:</P
><P
>&#13;
<PRE
CLASS="PROGRAMLISTING"
>$ xlsfonts | grep ttf
-ttf-arial black-medium-r-normal-regular-0-0-0-0-p-0-iso8859-1
-ttf-arial mt black-medium-r-normal-regular-0-0-0-0-p-0-iso8859-1
-ttf-arial narrow-bold-i-normal-bold italic-0-0-0-0-p-0-iso8859-1
....</PRE
>
&#13;</P
></LI
></UL
>&#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN294"
>3.3. Использование шрифтов TrueType</A
></H2
><P
>С этого момента у вас появилась возможность использовать шрифты TrueType в
различных приложениях, например, <TT
CLASS="LITERAL"
>GIMP</TT
>, <TT
CLASS="LITERAL"
>Netscape</TT
> или <TT
CLASS="LITERAL"
>StarOffice</TT
>. Так как у
шрифтов TrueType ширина нефиксирована, то вам наверно не стоит использовать
их в <TT
CLASS="LITERAL"
>xterm</TT
> - эти программы выделяют под символы фиксированное пространство,
равное размеру самого большого символа.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN301"
>3.4. Установка дополнительных шрифтов TrueType</A
></H2
><P
>Установить новые шрифты TrueType очень просто, если вы используете сервер шрифтов <TT
CLASS="LITERAL"
>xfstt</TT
>: </P
><P
>&#13;<P
></P
><UL
><LI
><P
>Скопируйте новые шрифты в каталог <TT
CLASS="LITERAL"
>/usr/share/fonts/truetype/</TT
></P
></LI
><LI
><P
>Перезапустите <TT
CLASS="LITERAL"
>xfs</TT
> командой <TT
CLASS="LITERAL"
>/etc/init.d/xfs restart</TT
></P
></LI
></UL
>&#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN314"
>3.5. Интернационализация</A
></H2
><P
><TT
CLASS="LITERAL"
>xfstt</TT
> имеет возможность генерировать различные кодовые страницы шрифтов в
том случае, если в шрифте TrueType содержатся соответствующие образы
символов. Чтобы разрешить использование кодовых страниц, отличных от
iso8859-1/unicode-1, вы должны вручную исправить скрипт <TT
CLASS="LITERAL"
>/etc/init.d/xfstt</TT
>:</P
><P
>&#13;<I
CLASS="EMPHASIS"
>/etc/init.d/xfstt</I
>

<PRE
CLASS="PROGRAMLISTING"
>- start-stop-daemon --start --quiet --exec $XFSTT -- \
      --port $portno --daemon 
+ start-stop-daemon --start --quiet --exec $XFSTT -- \
      --port $portno --encoding iso8859-1,koi8-r,windows-1252,symbol-0 \
      --daemon </PRE
>
&#13;</P
><P
>В Debian 2.1 распознаются следующие кодовые таблицы: </P
><P
>&#13;<P
></P
><UL
><LI
><P
>iso8859-1 (Latin 1 - Западная Европа) </P
></LI
><LI
><P
>iso8859-2 (Latin 2 - Центральная и Восточная европа) </P
></LI
><LI
><P
>iso8859-3 (Latin 3 - Эсперанто и Мальтийский) </P
></LI
><LI
><P
>iso8859-4 (Latin 4 - заменена Latin 6) </P
></LI
><LI
><P
>iso8859-5 (Кириллица) </P
></LI
><LI
><P
>iso8859-6 (Арабский) </P
></LI
><LI
><P
>iso8859-7 (Греческий) </P
></LI
><LI
><P
>iso8859-8 (Иврит) </P
></LI
><LI
><P
>iso8859-9 (Latin 5 - Latin 1 с турецким вместо Исландского) </P
></LI
><LI
><P
>iso8859-10 (Latin 6 - Северные языки, заменяют Latin 4) </P
></LI
><LI
><P
>koi8-r (Кириллица) </P
></LI
><LI
><P
>windows-1250 (Центральная Европа) </P
></LI
><LI
><P
>windows-1251 (Кириллица) </P
></LI
><LI
><P
>windows-1252</P
></LI
><LI
><P
>windows-1253 (Греческий) </P
></LI
><LI
><P
>windows-1254</P
></LI
><LI
><P
>windows-1255</P
></LI
><LI
><P
>windows-1256</P
></LI
><LI
><P
>windows-1257</P
></LI
><LI
><P
>symbol-0</P
></LI
><LI
><P
>wingding-0</P
></LI
><LI
><P
>wingreek-0</P
></LI
><LI
><P
>cp-437 (различные кодовые страницы IBM) </P
></LI
><LI
><P
>cp-737</P
></LI
><LI
><P
>cp-850</P
></LI
><LI
><P
>cp-851</P
></LI
><LI
><P
>cp-852</P
></LI
><LI
><P
>cp-853</P
></LI
><LI
><P
>cp-855</P
></LI
><LI
><P
>cp-857</P
></LI
><LI
><P
>cp-860</P
></LI
><LI
><P
>cp-861</P
></LI
><LI
><P
>cp-862</P
></LI
><LI
><P
>cp-863</P
></LI
><LI
><P
>cp-864</P
></LI
><LI
><P
>cp-865</P
></LI
><LI
><P
>cp-866</P
></LI
><LI
><P
>cp-869</P
></LI
><LI
><P
>cp-895</P
></LI
><LI
><P
>atari-st</P
></LI
><LI
><P
>unicode-2</P
></LI
></UL
>&#13;</P
><P
>Первые 128 символов в страницах <TT
CLASS="LITERAL"
>iso8859-x</TT
> - это всегда ASCII. Страницы
<TT
CLASS="LITERAL"
>windows-</TT
> расширяют и дополняют <TT
CLASS="LITERAL"
>iso8859-1</TT
> дополнительными символами,
например "умными кавычками." (Так как этих расширений нет в <TT
CLASS="LITERAL"
>iso8859-1</TT
>, то
они обычно бывают представлены вопросительными знаками.)</P
><P
>Чтобы более подробно узнать о кодовых страницах символов, читайте:

<P
></P
><UL
><LI
><P
><TT
CLASS="LITERAL"
><A
HREF="http://ppewww.ph.gla.ac.uk/%7Eflavell/iso8859/iso8859-pointers.html"
TARGET="_top"
>http://ppewww.ph.gla.ac.uk/%7Eflavell/iso8859/iso8859-pointers.html</A
></TT
>,</P
></LI
><LI
><P
><TT
CLASS="LITERAL"
><A
HREF="http://anubis.dkuug.dk/i18n/"
TARGET="_top"
>http://anubis.dkuug.dk/i18n/</A
></TT
> и</P
></LI
><LI
><P
><TT
CLASS="LITERAL"
><A
HREF="http://czyborra.com/charsets/iso8859.html"
TARGET="_top"
>http://czyborra.com/charsets/iso8859.html</A
></TT
>.</P
></LI
></UL
>&#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN426"
>3.6. Вопросы безопасности</A
></H2
><P
>Я использовал в вышеприведенных примерах гнезда Unix, но стандартные пакеты
в Debian настроены так, что <TT
CLASS="LITERAL"
>xfs</TT
> и <TT
CLASS="LITERAL"
>xfstt</TT
> слушают порты 7100 и 7101, так же и
по TCP/IP. Доступ к этим портам должен контролироваться полем
<TT
CLASS="LITERAL"
>trusted-clients</TT
> в файле <TT
CLASS="LITERAL"
>/etc/X11/xfs/config</TT
>, но эта опция все еще не
реализована в XFree86 версии 3.3.2.3a.</P
><P
>Это означает, что кто угодно, когда угодно, может подключиться к вашему
серверу шрифтов. Так как <TT
CLASS="LITERAL"
>xfs</TT
> (и, скорее всего, <TT
CLASS="LITERAL"
>xfstt</TT
>), по-видимому,
поддерживают большое количество пользователей, то против подобных систем
может быть применена стандартная форма атаки "отказ в предоставлении
сервиса". Использовать серверы шрифтов по телефонным линиям, наверно,
достаточно безопасно (так как вы в реальном режиме времени решаете
проблемы), но пользователи DSL и кабельных модемов должны использовать
firewall.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN436"
>4. Печать (<TT
CLASS="LITERAL"
>ghostscript</TT
>)</A
></H1
><P
>Начиная с версии 4, в <TT
CLASS="LITERAL"
>ghostscript</TT
> встроена внутренняя поддержка шрифтов
TrueType. <TT
CLASS="LITERAL"
>ghostscript</TT
> представлен в Debian двумя пакетами:
<P
></P
><UL
><LI
><P
><TT
CLASS="LITERAL"
>main/binary-*/text/gs_*.deb</TT
> - это DFSG-совместимая версия 5.10, </P
></LI
><LI
><P
><TT
CLASS="LITERAL"
>non-free/binary-*/gs-aladdin_*.deb</TT
> - это не-DFSG-совместимая версия 5.50.   </P
></LI
></UL
>

Обе версии поддерживают шрифты TrueType. </P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN449"
>4.1. Настройка <TT
CLASS="LITERAL"
>Ghostscript</TT
> на использование шрифтов TrueType</A
></H2
><P
>Если у вас есть работающий сервер <TT
CLASS="LITERAL"
>xfstt</TT
>, то настроить <TT
CLASS="LITERAL"
>ghostscript</TT
> на
использование шрифтов TrueType достаточно просто. Выполните
следующую команду:</P
><P
>&#13;
<PRE
CLASS="PROGRAMLISTING"
># xfstt --gslist --sync &#62;&#62; /etc/gs.Fontmap</PRE
>
&#13;</P
><P
>На самом деле, я счел необходимым внести небольшие изменения в определения
шрифтов, созданные <TT
CLASS="LITERAL"
>xfstt</TT
>. Во-первых, если стандартное название шрифта не
содержит пробелов, то я изменяю имя файла на стандартное название. Если в
названии шрифта есть пробелы, то я меняю все пробелы в имени на тире, а
исходное название включаю в виде алиаса на новое.</P
><P
>Затем я добавляю к именам шрифтов префикс <TT
CLASS="LITERAL"
>TTF-</TT
> (или <TT
CLASS="LITERAL"
>MS-</TT
>) для того, чтобы
минимизировать риск пересечения имен шрифтов TrueType с уже установленными.</P
><P
>Таким образом,</P
><P
>&#13;
<PRE
CLASS="PROGRAMLISTING"
>(Arial)               (/usr/share/fonts/truetype/arial.ttf)   ;
(Arial Bold Italic)   (/usr/share/fonts/truetype/arialbi.ttf) ;</PRE
>
&#13;</P
><P
>Станет </P
><P
>&#13;
<PRE
CLASS="PROGRAMLISTING"
>/MS-Arial             (/usr/share/fonts/truetype/arial.ttf)   ;
/MS-Arial-Bold-Italic (/usr/share/fonts/truetype/arialbi.ttf) ;
(Arial Bold Italic)   /MS-Arial-Bold-Italic                   ;
/Arial                /MS-Arial                               ;</PRE
>
&#13;</P
><P
>Алиасы существуют для того, чтобы и <TT
CLASS="LITERAL"
>ghostscript</TT
> и <TT
CLASS="LITERAL"
>xfstt</TT
> смогли найти шрифт по его стандартному имени. </P
><P
>Значительно более важен тот факт, что с подобной сменой имен можно
заставить <TT
CLASS="LITERAL"
>ghostscript</TT
> использовать шрифты TrueType, вместо обычных. В
документации сказано, что это возможно сделать и при помощи вводной
нотации, но я так и не смог этого сделать.</P
><P
>Мы можем, например, указать <TT
CLASS="LITERAL"
>ghostscript</TT
> заменить шрифт Helvetica на
бесплатный шрифт Microsoft Arial, добавив в файл <TT
CLASS="LITERAL"
>/etc/gs.Fontmap</TT
> следующие
строки:</P
><P
>&#13;
<PRE
CLASS="PROGRAMLISTING"
>/Helvetica               /MS-Arial              ;
/Helvetica-Oblique       /MS-Arial-Italic       ;
/Helvetica-Bold          /MS-Arial-Bold         ;
/Helvetica-BoldOblique   /MS-Arial-Bold-Italic  ;</PRE
>
&#13;</P
><P
>Подобные алиасы можно определить и для других стандартных шрифтов. Эти
алиасы очень хороши, в случае использования <TT
CLASS="LITERAL"
>samba</TT
>-принтеров, работающих с
Windows-клиентами.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN480"
>4.2. Печать образцов шрифтов TrueType</A
></H2
><P
>Самый лучший способ проверить, что <TT
CLASS="LITERAL"
>ghostscript</TT
> правильно настроен на
использование шрифтов TrueType - это напечатать образцы шрифтов.
Предполагая, что у вас запущен <TT
CLASS="LITERAL"
>ghostscript</TT
> версии 5.50, и что он является
вашей очередью печати по умолчанию, вы можете напечатать образцы всех
шрифтов TrueType командой:&#13;</P
><P
>&#13;
<PRE
CLASS="PROGRAMLISTING"
># xfstt --gslist --sync | printfont</PRE
>
&#13;</P
><P
>где <TT
CLASS="LITERAL"
>printfont</TT
> - это следующий скрипт: </P
><P
>&#13;
<PRE
CLASS="PROGRAMLISTING"
>#!/bin/sh

set -e
IFS= ')'

while read fontname rest
do
    cat &#60;&#60; EOM | lpr
%!PS
(/usr/lib/ghostscript/5.50/prfont.ps) run
$fontname) DoFont
EOM
done</PRE
>
&#13;</P
><P
>Если вы хотите напечатать только некоторые шрифты, то скрипт будет проще: </P
><P
>&#13;
<PRE
CLASS="PROGRAMLISTING"
>#!/bin/sh

set -e
while read -p "Введите имя шрифта или ^D для выхода: " fontname
do
    cat &#60;&#60; EOM | lpr
%!PS
(/usr/lib/ghostscript/5.50/prfont.ps) run
$fontname DoFont
EOM
done</PRE
>
&#13;</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN494"
>5. Настройка программ</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN496"
>5.1. Генерация метрик шрифтов AFM <TT
CLASS="LITERAL"
>AFM</TT
></A
></H2
><P
>Шрифтовые метрики <TT
CLASS="LITERAL"
>AFM</TT
> не нужны для того, чтобы выводить содержимое
существующих файлов, но они нужны для создания новых. Эти файлы метрик
могут быть созданы при помощи программы
<TT
CLASS="LITERAL"
>/usr/lib/ghostscript/5.50/printafm.ps</TT
>, входящей в пакет ghostscript, но, я
нашел программу <TT
CLASS="LITERAL"
>ttf2afm</TT
>, входящую в пакет <TT
CLASS="LITERAL"
>tetex-bin</TT
>, которая значительно
проще в использовании.</P
><P
>Нижеприведенный скрипт создаст <TT
CLASS="LITERAL"
>afm</TT
>-файлы для всех шрифтов TrueType в текущем каталоге: </P
><P
>&#13;
<PRE
CLASS="PROGRAMLISTING"
>#!/bin/sh

set -e

for i in *.TTF
do
    /usr/bin/ttf2afm $i &#62; ${i%TTF}afm
done

for i in *.ttf
do
    /usr/bin/ttf2afm $i &#62; ${i%ttf}afm
done</PRE
>
&#13;</P
><P
>Одна небольшая проблема, возникающая с <TT
CLASS="LITERAL"
>ttf2afm</TT
> - это то, что некоторые
программы предполагают, что <TT
CLASS="LITERAL"
>afm</TT
>-файлы начинаются с тэга <TT
CLASS="LITERAL"
>StartFontMetrics</TT
>,
но файлы, созданные <TT
CLASS="LITERAL"
>ttf2afm</TT
> начинаются с комментария. Эта "проблема" легко
исправляется при помощи текстового редактора.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN513"
>5.2. Создание файлов <TT
CLASS="LITERAL"
>font.map</TT
></A
></H2
><P
>Теперь у нас есть <TT
CLASS="LITERAL"
>afm</TT
>-файлы, и нам надо указать системе, где их найти.
Обычно это делается при помощи файла <TT
CLASS="LITERAL"
>font.map</TT
>.</P
><P
>Я так и не смог обнаружить документацию по формату этого файла, в отличие
от <TT
CLASS="LITERAL"
>fonts.dir</TT
>, <TT
CLASS="LITERAL"
>fonts.scale</TT
>, и <TT
CLASS="LITERAL"
>fonts.alias</TT
>, создаваемых <TT
CLASS="LITERAL"
>mkfontdir</TT
>. Однако
минимальный формат достаточно прост:</P
><P
>&#13;<P
></P
><UL
><LI
><P
>Название шрифта без пробелов </P
></LI
><LI
><P
>Имя <TT
CLASS="LITERAL"
>AFM</TT
> - файла, без расширения </P
></LI
></UL
>&#13;</P
><P
>Алиасы реализуются набором нескольких строк, а расширение файла должно быть написано строчными буквами. </P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN532"
>5.3. Работа с изображениями: <TT
CLASS="LITERAL"
>GIMP</TT
></A
></H2
><P
><TT
CLASS="LITERAL"
>GIMP</TT
> - это программа рисования и обработки
изображений Gnu. Мне не пришлось вносить никаких изменений в систему, чтобы
использовать шрифты TrueType в <TT
CLASS="LITERAL"
>gimp</TT
>.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN538"
>5.4. Преобразование ASCII в PostScript: <TT
CLASS="LITERAL"
>enscript</TT
></A
></H2
><P
><TT
CLASS="LITERAL"
>Enscript</TT
> - это программа, преобразующая ASCII в PostScript. Для этих же
целей существуют программы <TT
CLASS="LITERAL"
>a2ps</TT
> и <TT
CLASS="LITERAL"
>mpage</TT
>.. <TT
CLASS="LITERAL"
>Enscript</TT
> позволяет производить
повороты на 90 градусов, добавлять водяные знаки, заголовки и окрашивание
текста, базирующееся на применении ключевых слов. Она не форматирует текст,
поэтому чаще всего используется для печати исходных текстов программ.</P
><P
>Чтобы использовать шрифты TrueType в <TT
CLASS="LITERAL"
>enscript</TT
>, сделайте следующее: </P
><P
>&#13;<P
></P
><UL
><LI
><P
>Добавьте <TT
CLASS="LITERAL"
>/usr/share/fonts/truetype</TT
> к переменной <TT
CLASS="LITERAL"
>AFMPath</TT
>.</P
></LI
><LI
><P
>Укажите шрифт TrueType, либо напрямую, либо через алиасинг обычного шрифта. </P
></LI
></UL
>&#13;</P
><P
>Более подробно читайте документацию <TT
CLASS="LITERAL"
>enscript</TT
>.</P
><P
>После того как я внес эти изменения, у меня не было проблем с использованием шрифтов TrueType. &#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN559"
>5.5. Форматирование и обработка текста: <TT
CLASS="LITERAL"
>groff</TT
></A
></H2
><P
><TT
CLASS="LITERAL"
>Groff</TT
> - это передний план системы форматирования документов groff/troff
Gnu. Возможности <TT
CLASS="LITERAL"
>Groff</TT
> можно оценить, просмотрев руководство пользователя
(<TT
CLASS="LITERAL"
>man</TT
>).</P
><P
>&#13;<I
CLASS="EMPHASIS"
>user shell</I
>

<PRE
CLASS="PROGRAMLISTING"
>$ zcat /usr/man/man1/groff.1.gz | groff -man | lpr</PRE
>
&#13;</P
><P
>Огромное количество документации в Unix использует форматирование при
помощи <TT
CLASS="LITERAL"
>troff</TT
> и макросов <TT
CLASS="LITERAL"
>ms</TT
> (и, иногда, <TT
CLASS="LITERAL"
>me</TT
>). Пакет <TT
CLASS="LITERAL"
>xbooks</TT
> в Debian,
например, содержит 43 файла, использующих <TT
CLASS="LITERAL"
>troff</TT
> с макросами <TT
CLASS="LITERAL"
>ms</TT
>. Можно очень
красиво распечатать эти документы, используя <TT
CLASS="LITERAL"
>groff</TT
>.</P
><P
><TT
CLASS="LITERAL"
>Groff</TT
> - это очень мощная система, но, в любом случае, это внук (или правнук)
программ, использовавшихся в 60-х годах на печатных прессах. Поддержка
шрифтов в <TT
CLASS="LITERAL"
>groff</TT
> полностью отражает суть этой наследственности. <TT
CLASS="LITERAL"
>Groff</TT
>, в
отличие от своих предков, использует PostScript в качестве формата вывода
по умолчанию, поэтому наши предыдущие изменения, внесенные в <TT
CLASS="LITERAL"
>ghostscript</TT
>,
займутся решением наших проблем -- <TT
CLASS="LITERAL"
>groff</TT
> не должен заниматься чтением
файлов со шрифтами TrueType. Ему также не нужны точные метрики шрифтов, и в
этом разделе мы только опишем восстановление необходимых <TT
CLASS="LITERAL"
>groff</TT
> файлов:</P
><P
>&#13;<I
CLASS="EMPHASIS"
>Файлы описания PostScript Groff </I
>

<PRE
CLASS="PROGRAMLISTING"
>/usr/share/groff/font/devps/DESC
    Файл описания устройств
/usr/share/groff/font/devps/text.enc
    Таблицы кодировок используемые для шрифтов
/usr/share/groff/font/devps/generate/textmap
    Стандартная таблица преобразования
/usr/share/groff/font/devps/generate/Makefile
    Стандартный makefile</PRE
>
&#13;</P
><P
>Теперь надо отредактировать Makefile, </P
><P
>&#13;<I
CLASS="EMPHASIS"
>/usr/share/groff/font/devps/generate/Makefile</I
>

<PRE
CLASS="PROGRAMLISTING"
>- afmdir=/usr/local/afm
+ afmdir=/usr/share/fonts/truetype</PRE
>
&#13;</P
><P
>Измените названия шрифтов на их TrueType-эквиваленты (например, если мы
используем бесплатные шрифты Microsoft TrueType, мы бы заменили <TT
CLASS="LITERAL"
>Helvetica</TT
>
на <TT
CLASS="LITERAL"
>Arial</TT
>), и измените раздел <TT
CLASS="LITERAL"
>TEXTFONTS</TT
>, и подобные ему, вставив только те,
которые нам необходимы.</P
><P
>Также вам надо отредактировать файл
<TT
CLASS="LITERAL"
>/usr/share/groff/font/devps/generate/afmname</TT
>, чтобы использовать имена
шрифтов TrueType и <TT
CLASS="LITERAL"
>afm</TT
>-файлов, и убрать флаг <TT
CLASS="LITERAL"
>"-e"</TT
> у <TT
CLASS="LITERAL"
>awk</TT
>.</P
><P
>После этого можно перестроить таблицы <TT
CLASS="LITERAL"
>groff</TT
> командой</P
><P
>&#13;<I
CLASS="EMPHASIS"
>user shell</I
>

<PRE
CLASS="PROGRAMLISTING"
>$ cd /usr/share/groff/font/devps
$ make -f generate/Makefile</PRE
>
&#13;</P
><P
>Как всегда, лучший способ проверить сделанные изменения - использовать
нестандартно выглядящий шрифт. Например, вы можете использовать шрифт
<TT
CLASS="LITERAL"
>Mistral</TT
> из бесплатных шрифтов Microsoft Truetype для печати <TT
CLASS="LITERAL"
>TR</TT
>.</P
><P
>(Я жду благодарностей от всех, кто перенастроит свою систему так, что она будет печатать man-ы староанглийским шрифтом не ранее следующего 1 апреля!) &#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN609"
>5.6. Набор и форматирование текстов: <TT
CLASS="LITERAL"
>TeX</TT
></A
></H2
><P
>&#13;<TT
CLASS="LITERAL"
>TeX</TT
> - это вторая очень распространенная система набора и форматирования текста во многих системах GNU/Linux. </P
><P
>&#13;Шрифты <TT
CLASS="LITERAL"
>TeX</TT
> могут быть созданы при помощи <TT
CLASS="LITERAL"
>mktexmf</TT
>, но я имею очень скудную информацию по конкретным деталям процесса. Более подробное описание читайте в следующих версиях. </P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN617"
>6. Незаданные вопросы</A
></H1
><P
>&#13;<P
></P
><UL
><LI
><P
>Приложения</P
><P
>Самый большой нерешенный на настоящий момент вопрос - это почему <TT
CLASS="LITERAL"
>netscape communicator</TT
> использует шрифты TrueType,<TT
CLASS="LITERAL"
>ghostscript</TT
> использует те же
шрифты TrueType, а напечатанные при помощи <TT
CLASS="LITERAL"
>netscape</TT
> отличаются от того, что
на экране.</P
><P
>Короткий ответ - <TT
CLASS="LITERAL"
>netscape</TT
> генерирует PostScript со стандартными шрифтами
(Helvetica и Times-Roman), вместо тех, которые заданы пользователем или в
HTML. Длинный ответ - я абсолютно не знаю, почему так происходит и есть ли
способы это исправить.</P
></LI
></UL
>&#13;</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN629"
>7. Где найти шрифты TrueType</A
></H1
><P
>Если вы ищете шрифты TrueType, то вот несколько мест, откуда можно начать поиски: </P
><P
>&#13;<P
></P
><UL
><LI
><P
>c:\windows\fonts </P
></LI
><LI
><P
>Бесплатные шрифты Microsoft TrueType 
<TT
CLASS="LITERAL"
><A
HREF="http://www.microsoft.com/typography/fontpack/"
TARGET="_top"
>http://www.microsoft.com/typography/fontpack/</A
></TT
></P
></LI
><LI
><P
>Шрифты Acid 
<TT
CLASS="LITERAL"
><A
HREF="http://www.acidcool.com/"
TARGET="_top"
>http://www.acidcool.com/</A
></TT
></P
></LI
><LI
><P
>Кольцо Шрифтов (The Font Ring) 
<TT
CLASS="LITERAL"
><A
HREF="http://www.webring.org/cgi-bin/webring?ring=fontring&list"
TARGET="_top"
>http://www.webring.org/cgi-bin/webring?ring=fontring&#38;list</A
></TT
></P
></LI
></UL
>&#13;</P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN648"
>7.1. Небольшое дополнение по использованию бесплатных TrueType шрифтов Microsoft</A
></H2
><P
>Ни одна статья о поддержке шрифтов TrueType в Linux не может обойтись без упоминания о бесплатных шрифтах Microsoft TrueType fonts. Сначала о легальности использования Бесплатных Шрифтов Microsoft TrueType: </P
><P
><I
CLASS="EMPHASIS"
><TT
CLASS="LITERAL"
><A
HREF="http://www.microsoft.com/typography/faq/faq8.htm"
TARGET="_top"
>http://www.microsoft.com/typography/faq/faq8.htm</A
></TT
></I
>

Вопрос: "Что я могу делять с этими шрифтами?"
<P
></P
><UL
><LI
><PRE
CLASS="PROGRAMLISTING"
>Кто угодно может загрузить и установить эти шрифты
для собственного пользования.</PRE
></LI
><LI
><PRE
CLASS="PROGRAMLISTING"
>Дизайнеры [веб-страниц] могут указывать ссылки на эти
шрифты в своих Веб-страницах.</PRE
></LI
></UL
></P
><P
>Ясно - абсолютно легально и правильно пользователям Linux загружать эти шрифты и устанавливать их, за что Microsoft большое спасибо. </P
><P
>Несмотря на то, что другое условие запрещает их дальнейшее распространение
"в любой форме, придающей дополнительную ценность коммерческому продукту" Я
не думаю, что в ближайшее время этот пакет появится в группе <TT
CLASS="LITERAL"
>main</TT
>.
(Возможно, когда-нибудь в группе <TT
CLASS="LITERAL"
>non-free</TT
>, может быть в пакете
установщика...?)</P
><P
>После того, как мы обсудили первый пункт, я обращаю ваше внимание на второй. Microsoft активно призывает веб-дизайнеров использовать ее шрифты на страницах, и многие HTML-редакторы используют их по умолчанию. </P
><P
>Многие web-сайты при просмотре стандартным Netscape/Linux могут быть описаны как ... разборчиво читаемые. Некоторые не читаются вовсе. Абсолютно не случаен тот факт, что эти, м-м-м - разборчивые сайты - это те, которые жестко прописывают в страницах информацию о шрифтах. 
&#13;</P
><P
>После того, как я установил эти шрифты, я заметил, что эти "проблемные" сайты стали значительно более привлекательны. Многие из них все-таки очень Windows-центричны, но я по крайней мере перестал вздрагивать каждый раз после загрузки страниц с этих сайтов. </P
><P
>Мой совет - установите бесплатные шрифты Microsoft TrueType fonts в ваш
броузер. Вам не обязательно создавать свои страницы с использованием этих
шрифтов, ни использовать <TT
CLASS="LITERAL"
>ghostscript</TT
> для их просмотра.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN669"
>8. Legalities</A
></H1
><P
>Copyright &copy; 1999 by Bear Giles.</P
><P
>Unless otherwise stated, Linux HOWTO documents are copyrighted by their
respective authors.  Linux HOWTO documents may be reproduced and distributed
whole or in part, in any medium physical or electronic, as long as this copyright
notice is retained in all copies.  Commercial redistribution is allowed
and encouraged; however, the author would like to be notified of any
such distributions.</P
><P
>All translations, derivative works, or aggregate works incorporating
any Linux HOWTO documents must be covered under this copyright notice.
That is, you may produce a derivative work from a HOWTO and impose
additional restrictions on distribution.  Exceptions to these
rules may be granted under certain conditions; please contact
the Linux HOWTO cordinator for more information.</P
><P
>In short, we wish to promote dissemination of this information
through as many channels as possible.  However, we do wish to retain
copyright on the HOWTO documents, and would very much like to be
notified of any plans to redistribute the HOWTOs, this one in
particular!  Web page authors are free to link to this HOWTO without
restriction, though the author would appreciate an email informing
him of this, just so he can boost his ego by knowing who else reads and
links to this document.</P
><P
>Many of the terms mentioned in this document are trade names.
Unless otherwise stated, all trademarks are property of their
respectve owners.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN676"
>9. Авторские права</A
></H1
><P
>Авторские права на русский перевод этого текста принадлежат &copy; 2000 SWSoft Pte Ltd.
Все права зарезервированы.</P
><P
>Этот документ является частью проекта Linux HOWTO.</P
><P
>Авторские права на документы Linux HOWTO принадлежат их авторам, если явно
не указано иное. Документы Linux HOWTO, а также их переводы, могут
быть воспроизведены и распространены полностью или частично на любом
носителе, физическом или электронном, при условии сохранения этой заметки об
авторских правах на всех копиях. Коммерческое распространение разрешается и
поощряется; но, так или иначе, автор текста и автор перевода желали бы знать о
таких дистрибутивах.</P
><P
>Все переводы и производные работы, выполненные по документам Linux HOWTO,
должны сопровождаться этой заметкой об авторских правах. Это делается в
целях предотвращения случаев наложения дополнительных ограничений на
распространение документов HOWTO. Исключения могут составить случаи
получения специального разрешения у координатора Linux HOWTO, с которым
можно связаться по адресу приведенному ниже.</P
><P
>Мы бы хотели распространить эту информацию по всем возможным каналам. Но
при этом сохранить авторские права и быть уведомленными о всех планах
распространения HOWTO. Если у вас возникли вопросы, пожалуйста, обратитесь
к координатору проекта Linux HOWTO по электронной почте:
<TT
CLASS="EMAIL"
>&#60;<A
HREF="mailto:linux-howto@metalab.unc.edu"
>linux-howto@metalab.unc.edu</A
>&#62;</TT
> или к координатору русского
перевода Linux HOWTO компании SWSoft Pte Ltd. по адресу
<TT
CLASS="EMAIL"
>&#60;<A
HREF="mailto:linux-howto@asplinux.ru"
>linux-howto@asplinux.ru</A
>&#62;</TT
></P
></DIV
></DIV
></BODY
></HTML
>