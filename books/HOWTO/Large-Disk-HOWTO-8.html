<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE> Large-Disk-HOWTO : Преобразование и программы-загрузчики.</TITLE>
 <LINK HREF="Large-Disk-HOWTO-9.html" REL=next>
 <LINK HREF="Large-Disk-HOWTO-7.html" REL=previous>
 <LINK HREF="Large-Disk-HOWTO.html#toc8" REL=contents>
</HEAD>
<BODY>
<A HREF="Large-Disk-HOWTO-9.html">Next</A>
<A HREF="Large-Disk-HOWTO-7.html">Previous</A>
<A HREF="Large-Disk-HOWTO.html#toc8">Contents</A>
<HR>
<H2><A NAME="s8">8. Преобразование и программы-загрузчики.</A></H2>

<P>
<!--
диск!преобразование геометрии
-->

<!--
BIOS!преобразование
-->

<!--
BIOS!поддержка LBA
-->

Геометрия диск (с головками,цилиндрами и дорожками) это
анархаизмы оставшиеся в наследство от времен MFM и RLL. В те
дни эти величины отражали физические параметра диска. Сегодня 
с IDE и SCSI, никому не интересна настоящая , физическая геометрия
диска.
По настоящему, количество секторов на дорожку переменная величина,
чем ближе к внешнему кругу диска , тем она больше, поэтому
величина секторов/дорожка всегда не настоящая. 
В тоже время команда IDE - INITIALIZE DRIVE PARAMETERS (91h)
служит для того чтобы сказать диску , сколько головок и секторов/
дорожку он должен иметь.
Для современного диска совершенно нормальна ситуация когда в
действительности он имеет 2 головки , сообщает BIOS , что иx 15-16,
а BIOS убеждает программы, что на самом деле головок 255.
<P>Для пользователя удобнее всего представлять диск , как линейный
массив секторов , пронумерованных по порядку, а задачу нахождения
того , где расположен искомый сектор - оставить фирменному ПО.
Такая линейная нумерация получила название LBA. 
<P>Таким образом на сегодняшний день концептуальная картина такова,
DOS, или менеджер загрузки, сообщают BIOS значения c,h,s. BIOS
преобразует эти значения в LBA , используя фальшивую геометрию диска
,которую использует пользователь. Если диск воспринимает LBA то эта величина
используется для чтения/записи , иначе она преобразуется назад 
в c/h/s и используется.
<P>Заметим что при использовании термина LBA могут возникнуть некоторые
неточности, т.к. термин LBA - в оригинале означает 'Linear Block Addressing'
(в противоположность CHS адресации).
В BIOS Setup он означает схему преобразования , также иногда называемую
'поддержка LBA'.См. `
<A HREF="Large-Disk-HOWTO-5.html#The 8.4 GB limit">The 8.4 GB limit</A>
'  
<P>Иногда тоже самое срабатывает , когда фирменная прошивка не поддерживает
LBA , но BIOS знает о преобразовании. (В SETUP это часто обозначается
как 'Large').Теперь BIOS будет предоставлять геометрию C/H/S операционной
системе, и использовать C`,H`,S` при общении с контроллером диска.
Обычно S=S`,C=C`/N и H=H`<CODE>*</CODE>N,где N это наименьшая степень двойки,
которая приблизит C` к 1024 (так чтобы были минимальные потери при
переворачивание выражения C`=C/N).
Это позволяет получить доступ к 7.8 ГиБ.
<P>Третья опция в Setup - это обычно 'Normal', означающая что трансляция
не производиться.
<P>Если ваш BIOS не поддерживает режимы 'Large' или 'LBA',то существует
несколько софтверных решений проблемы. Менеджеры Дисков,такие как
OnTrack или EZ-Drive замещают процедуры BIOS для работы с дисками,
своими собственными. Часто такие программы размещают свой код
в MBR и последующих секторах (OnTrack называет этот код DDO:
Dynamic Drive Overlay - Динамическое Замещение Диска),так 
что он загружается раньше любой операционной системы.
Правда такой подход может создать проблемы при попытки загрузки с дискеты.
<P>Достигаемый эффект примерно тот-же что и при преобразующим BIOS'ом.
Отрицательная сторона использования менеджеров дисков 
- сложности возникающие при совмещении 
нескольких операционных систем на одном диске. 
<P>Линукс поддерживает OnTrack Disk Manager с версии 1.3.14,
и EZ-Drive с версии 1.3.29. 
Более детально это описано далее.
<HR>
<A HREF="Large-Disk-HOWTO-9.html">Next</A>
<A HREF="Large-Disk-HOWTO-7.html">Previous</A>
<A HREF="Large-Disk-HOWTO.html#toc8">Contents</A>
</BODY>
</HTML>
