<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>  IP Sub-networking Mini-Howto: Как разбить сетевые IP адреса на подсети</TITLE>
 <LINK HREF="IP-Subnetworking-HOWTO-7.html" REL=next>
 <LINK HREF="IP-Subnetworking-HOWTO-5.html" REL=previous>
 <LINK HREF="IP-Subnetworking-HOWTO.html#toc6" REL=contents>
</HEAD>
<BODY>
<A HREF="IP-Subnetworking-HOWTO-7.html">Next</A>
<A HREF="IP-Subnetworking-HOWTO-5.html">Previous</A>
<A HREF="IP-Subnetworking-HOWTO.html#toc6">Contents</A>
<HR>
<H2><A NAME="s6">6. Как разбить сетевые IP адреса на подсети</A></H2>

<P>Допустим вы решили разбить вашу IP сеть на подсети, как вам это сделать?
Ниже кратко перечислены шаги, которые потом будут разъяснены более подробно:
<UL>
<LI>    Установите физические соединения (сетевые кабели и сетевые соединители
- такие как маршрутизаторы);
</LI>
<LI>    Решите насколько большие/маленькие подсети вам нужны, исходя из 
количества устройств, которое будет подключено к ним, то есть сколько
IP адресов требуется использовать в каждом сегменте.
</LI>
<LI>    Вычислите соответствующие сетевые маски и сетевые адреса;
</LI>
<LI>    Раздайте каждому интерфейсу в каждой сети свой IP адрес и соответствующую
сетевую маску;
</LI>
<LI>    Установите маршруты на каждом маршрутизаторе и соответственно шлюзы,
маршруты и/или маршруты по умолчанию на сетевых устройствах;
</LI>
<LI>    Проверьте систему, исправьте ошибки и расслабьтесь!</LI>
</UL>

Для примера, предположим, что разбиваем на подсети одну сеть класса С 
с адресом 192.168.1.0
<P>Она может иметь до 254 интерфейсов (хостов) плюс адрес сети (192.168.1.0)
и широковещательный адрес (192.168.1.255).
<P>
<H2><A NAME="ss6.1">6.1 Установка физических соединений</A>
</H2>

<P>Вам нужно правильно установить кабели для всех устройств, которые вы хотите
объединить, согласно вашему плану.
<P>Вам также нужен механизм для соединения различных сегментов вместе
(маршрутизаторы, конверторы среды передачи итд.).
<P>Подробное разъяснение этого процесса выходит за рамки этого документа. Если 
вы нуждаетесь в помощи в данном вопросе, то существуют консультанты по 
разработке и установке сетей, которые предлагают такие услуги. Также вам 
могут помочь в разных группах новостей Usenet (таких как
comp.os.linux.networking).
<P>
<H2><A NAME="ss6.2">6.2 Размер подсети</A>
</H2>

<P>Существует зависимость между количеством создаваемых вами подсетей и
'потраченными' IP адресами.
<P>Каждая отдельная IP сеть имеет два адреса, неиспользуемые для интерфейсов
(хостов), - IP адрес собственно сети и широковещательный адрес. При 
разбивке на подсети каждая подсеть требует свой собственный уникальный 
IP адрес сети и широковещательный адрес - и они должны быть корректно 
выбраны из диапазона адресов IP сети, которую вы делите на подсети.
<P>Итак, разбив IP сеть на подсети, вы получаете две отдельные подсети, в 
которых есть два сетевых адреса и два широковещательных адреса - произошло
увеличение 'неиспользуемых' интерфейсных (хостовых) адресов; создание 4
подсетей даст восемь неиспользуемых интерфейсных (хостовых) адресов итд.
<P>Реально наименьшая используемая подсеть состоит из 4 IP адресов:-
<UL>
<LI>    Два используемых IP адреса интерфейсов - один для интерфейса
маршрутизатора в этой сети и один для хоста в этой сети.
</LI>
<LI>    Один сетевой адрес.
</LI>
<LI>    Один широковещательный адрес.</LI>
</UL>

Почему нам захотелось создать такую крошечную сеть - это другой вопрос!
С единственным хостом в сети, любое сетевое соединение должно уходить
в другую сеть. Однако пример служит для показа закона уменьшения отдачи,
который применим к подсетям.
<P>В принципе, вы можете только поделить вашу IP сеть на 2^n (где n - 
это количество бит в хостовой части вашего IP адреса сети) равных по 
размеру подсетей (однако вы можете разбивать подсеть на подсети или 
объединять подсети).
<P>Реальные требования к организации вашей сети - вам нужно минимальное 
количество разделенных локальных сетей, которое должно соответствовать
требованиям управления, физической реализуемости, оборудования и 
безопасности.
<P>
<H2><A NAME="ss6.3">6.3 Вычисление сетевой маски и сетевых номеров</A>
</H2>

<P>Сетевая маска - это то, что выполняет все логические манипуляции по 
разделению IP сети на подсети.
<P>Сетевая маска для не-подсетевых адресов IP - это просто октеты разделенные 
точками, в которых все 'сетевые биты' адреса сети установлены в '1', а все 
хостовые биты в '0'.
<P>     
Итак, для трех классов IP сетей стандартные сетевые маски:-
<UL>
<LI>    Класс A (8 сетевых битов) : 255.0.0.0
</LI>
<LI>    Класс B (16 сетевых битов): 255.255.0.0
</LI>
<LI>    Класс C (24 сетевых бита): 255.255.255.0</LI>
</UL>

Методика разбивки на подсети состоит в заимствовании одного или более
доступных хостовых битов и соответствующей правке сетевой маски, что 
заставляет интерфейсы локально интерпретировать эти позаимствованные 
биты как часть сетевых битов. Так, чтобы разбить сетевой адрес на две 
подсети, мы должны позаимствовать один хостовый бит, установив 
соответствующий бит в сетевой маске первого (обычного) хостового бита в 1.
<P>Для адресов класса C, это дает маску 11111111.11111111.11111111.10000000
или 255.255.255.128
<P>Для нашего класса сети С адрес 192.168.1.0, существует несколько способов
разбивки на подсети:-
<P>
<BLOCKQUOTE><CODE>
<PRE>
  Число      Число
  подсетей   хостов       Сетевая маска
  2            126        255.255.255.128 (11111111.11111111.11111111.10000000)
  4             62        255.255.255.192 (11111111.11111111.11111111.11000000)
  8             30        255.255.255.224 (11111111.11111111.11111111.11100000)
  16            14        255.255.255.240 (11111111.11111111.11111111.11110000)
  32             6        255.255.255.248 (11111111.11111111.11111111.11111000)
  64             2        255.255.255.252 (11111111.11111111.11111111.11111100)
</PRE>
</CODE></BLOCKQUOTE>
<P>В принципе, нет никаких причин следовать приведенному выше способу разбивки
на подсети, когда биты сетевой маски добавляются от наибольших значащих
хостовых битов в сторону наименьших значащих хостовых битов. Однако, если
вы не применяте этот способ, результирующие IP адреса будут следовать в 
весьма нечетной последовательности! Это весьма затрудняет человека в 
определении, какой подсети принадлежит IP адрес, так как мы не очень хорошо 
мыслим в двоичном исчислении (а вот компьютеры используют и будут 
использовать то исчисление, которое вы им укажете, с непоколебимым 
спокойствием).
<P>Разобравшись и определив сетевую маску, вам нужно решить вопрос об адресах
сетей и широковещательных адресах - и о диапазоне IP адресов для каждой из 
этих сетей. Снова, принимая во внимание только сетевые адреса класса С и 
показав только последнюю (хостовую) часть адресов, мы имеем:
<P>
<BLOCKQUOTE><CODE>
<PRE>
  Сетевая маска   Подсети Сеть  B'cast   MinIP   MaxIP    Хосты   Всего хостов
  --------------------------------------------------------------------------
      128            2       0     127       1     126    126
                           128     255     129     254    126     252

      192            4       0      63       1      62     62
                            64     127      65     126     62
                           128     191     129     190     62
                           192     255     193     254     62     248

      224            8       0      31       1      30     30
                            32      63      33      62     30
                            64      95      65      94     30
                            96     127      97     126     30
                           128     159     129     158     30
                           160     191     161     190     30
                           192     223     193     222     30
                           224     255     225     254     30     240
</PRE>
</CODE></BLOCKQUOTE>
<P>Как видно, эти последовательности чисел весьма определенные, что делает их 
очень легкими для проверки. Наглядно видно сокращение общего количества 
доступных хостовых адресов при увеличении количества подсетей.
<P>Вооруженные этой информацией, вы готовы назначить хостовые и сетевые 
IP адреса и сетевые маски.
<P>
<HR>
<A HREF="IP-Subnetworking-HOWTO-7.html">Next</A>
<A HREF="IP-Subnetworking-HOWTO-5.html">Previous</A>
<A HREF="IP-Subnetworking-HOWTO.html#toc6">Contents</A>
</BODY>
</HTML>
