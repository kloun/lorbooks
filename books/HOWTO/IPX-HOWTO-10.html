<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>IPX в Linux HOWTO: Настройка вашей Linux машины как сервер NCP.</TITLE>
 <LINK HREF="IPX-HOWTO-11.html" REL=next>
 <LINK HREF="IPX-HOWTO-9.html" REL=previous>
 <LINK HREF="IPX-HOWTO.html#toc10" REL=contents>
</HEAD>
<BODY>
<A HREF="IPX-HOWTO-11.html">Следующий</A>
<A HREF="IPX-HOWTO-9.html">Предыдущий</A>
<A HREF="IPX-HOWTO.html#toc10">Содержание</A>
<HR>
<H2><A NAME="s10">10. Настройка вашей Linux машины как сервер NCP.</A>      </H2>

<P>Существует два пакета, которые позволяют Linux обеспечивать
функции файлового сервера Novell. Они оба позволяют осуществлять
доступ к файлам на вашей Linux машине для пользователей использующих
клиентское программное обеспечение Novell NetWare. Пользователи могут
присоединять и мапировать файловые системы как локальные диски на их
машинах точно также как они могут делать на настоящем файловом
сервере Novell. Вы можете хотеть попробовать оба, чтобы увидеть какой
лучше отвечает вашим намерениям.
<P>
<H2><A NAME="ss10.1">10.1 Пакет <B><EM>mars_nwe</EM></B></A>
        </H2>

<P>Martin Stover <CODE>&lt;mstover@freeway.de></CODE> разработал пакет
<EM>mars_nwe</EM> для того чтобы обеспечить в linux работу файловых
сервисов и сервисов печати для клиентов NetWare.
<P>
<P>В случае если вас удивляет имя, то оно расшифровывается как:
<EM>mars_nwe</EM> это Martin Stovers Netware Emulator (Эмулятор
Netware Мартина Стоверса). 
<P>
<H3>Возможности <B><EM>mars_nwe</EM></B>.          </H3>

<P><EM>mars_nwe</EM> реализует подмножество полного Novell NCP
для файловых сервисов, основанного на дисках bindery и также
сервисы печати. Также вероятно что этот пакет содержит ошибки, но
много людей используют его и число ошибок постоянно уменьшается с 
выпуском новых версий. 
<P>
<H3>Где взять <B><EM>mars_nwe</EM></B>.          </H3>

<P>Вы можете получить <EM>mars_nwe</EM> с 
<A HREF="ftp://ftp.gwdg.de/pub/linux/misc/ncpfs/">ftp.gwdg.de</A> 
или с 
<A HREF="ftp://sunsite.unc.edu/pub/Linux/system/filesystems/ncpfs/">ftp://sunsite.unc.edu/pub/Linux/system/filesystems/ncpfs/</A>.
<P>
<P>Версия в момент написания документа была:
<CODE>mars_nwe-0.99.pl10.tgz</CODE>.
<P>
<H3>Построение пакета <EM>mars_nwe</EM>          </H3>

<P>
<DL>
<DT><B>Построение ядра с поддержкой Ethernet и IPX</B><DD><P>В ядре
версии <CODE>1.2.13</CODE> вам необходимо только убедиться, что вы
ответили <CODE>Y</CODE> на вопрос: '<CODE>The IPX protocol</CODE>' и <CODE>N</CODE>
на вопрос: `<CODE>Full internal IPX network</CODE>' как показано:
<P>
<PRE>
 ...
 ...
The IPX protocol (CONFIG_IPX) [n] y
 ...
 ...
Full internal IPX network (CONFIG_IPX_INTERN) [N/y/?] n
 ...
 ...
</PRE>
<P>
<P>В более новых ядрах производится подобный процесс, но
действительный текст запроса может слегка измениться.
<P>
<P>Вам также надо убедиться, что вы включили соответствующий
драйвер для вашей карты Ethernet. Если вы не знаете как
сделать это, вам необходимо прочитать документ 
<A HREF="http://www.linux.org.ru/books/HOWTO/Ethernet-HOWTO.html">Ethernet-HOWTO</A>. 
<P>
<P>Затем вы можете приступить к построению вашего
ядра. Помните, что надо запустить команду <EM>lilo</EM> для
установки ядра, когда его компиляция завершится.
<P>
<DT><B>Разожмите пакет <EM>mars_nwe</EM></B><DD><P>
<BLOCKQUOTE><CODE>
<PRE>
# cd /usr/src
# tar xvfz mars_nwe-0.99.pl10.tgz
</PRE>
</CODE></BLOCKQUOTE>
<P>
<DT><B>Построение <EM>mars_nwe</EM></B><DD><P>Процесс построения
пакета очень прост. Первый шаг&nbsp;-- просто запустить
<CODE>make</CODE>, эта команда создаст для вас файл <CODE>config.h</CODE>.
Затем вы должны посмотреть и отредактировать файл
<CODE>config.h</CODE> если это необходимо. Это позволит настроить
такие настройки как, какие директории будут использоваться и
максимальное количество сессий и томов, которые будет
поддерживать сервер. Самые важные выглядят так:
<P>
<PRE>
FILENAME_NW_INI       расположение инициализационного файла
PATHNAME_PROGS        где находятся выполнимые программы поддержки
PATHNAME_BINDERY      где будут находится файлы 'bindery'
PATHNAME_PIDFILES     директория, куда будут записываться 'pid' файлы
MAX_CONNECTIONS       максимальное количество одновременных соединений
MAX_NW_VOLS           максимальное количество томов, которое будет поддерживать mars_nwe 
MAX_FILE_HANDLES_CONN максимальное количество открытых файлов на одно соединение
WITH_NAME_SPACE_CALLS если вы хотите поддерживать клиентов ncpfs
INTERNAL_RIP_SAP      хотите ли вы поддерживать маршрутизацию rip/sap с помощью mars_nwe
SHADOW_PWD            хотите ли вы использовать 'теневые пароли' или нет
</PRE>
<P>
<P>Значения по умолчанию должны быть нормальными, но все
равно проверьте их.
<P>
<P>Когда это сделано, выполнение команд:
<P>
<BLOCKQUOTE><CODE>
<PRE>
# make
# make install
</PRE>
</CODE></BLOCKQUOTE>
<P>
<P>построит сервер и установит его в соответствующие
директории. Установочный скрипт также устанавливает
конфигурационный файл /etc/nwserv.conf.
<P>
<DT><B>Настройка сервера</B><DD><P>Настройка довольно проста. Вам
необходимо отредактировать файл
/etc/nwserv.conf. Формат этого файла на первый
взгляд может показаться загадочным, но на самом деле он
довольно прост. Файл содержит некоторое количество
одностроковых настроечных данных. Каждая строка разделена
пробелами и начинается с числа, которое обозначает содержимое
этой строки. Все символы следующие за символом '<CODE>#</CODE>'
считаются комментарием и игнорируются. Martin обеспечивает
пример настроечного файла в пакете, но представлю упрощенный
пример как альтернативу для вас. 
<P>
<BLOCKQUOTE><CODE>
<PRE>
# ТОМА (максимум 5)
# Только том SYS является необходимым. Директория содержащая том SYS
# должна содержать директории: LOGIN, PUBLIC, SYSTEM, MAIL.
# Опция 'i' регистр букв.
# Опция 'k' преобразует все имена в запросе NCP в нижний регистр
# Опция 'm' обозначает том как сменный (полезно для cdroms и т.п.)
# Опция 'r' устанавливает том только для чтения
# Опция 'o' показывает, что том является единой файловой системой
# Опция 'P' разрешает командам использоваться как файлы
# Опция 'O' позволяет использовать использовать пространство имен OS/2
# Опция 'N' разрешает использование пространства имен NFS
# По умолчанию в верхнем регистре.
# Синтаксис:
#    1 &lt;Имя тома>  &lt;Путь к тому>        &lt;Опции>

1   SYS         /home/netware/SYS/               # SYS
1   DATA        /home/netware/DATA/      k       # DATA
1   CDROM       /cdrom                   kmr     # CDROM

# ИМЯ СЕРВЕРА
# Если не установлено, тогда имя машины linux hostname будет
# сконвертировано в верхний регистр и использовано. Этот пункт
# является опциональным, если не настроено будеи использовано имя
# машины. 
# Синтаксис:
#    2 &lt;Имя сервера>

2   LINUX_FS01

# АДРЕС ВНУТРЕННЕЙ СЕТИ
# Адрес внутренней сети IPX это свойство, которое упрощает
# маршрутизацию IPX для многосетевых машин (машин, которые имеют
# порты больше чем на одной сети IPX).
# Синтаксис:
#    3 &lt;Адрес внутренней сети> [&lt;Номер узла>]
# или:
#    3 auto
#
# Если вы используете 'auto', тогда будет использован IP адрес
# вашей машины. ЗАМЕЧАНИЕ: это может быть угрожающим, пожалуйста
# будьте уверены, что используете уникальное число.
# Адрес имеет длину 4 байта в шестнадцатиричной форме (требуется
# лидирующий 0x). 

3   0x49a01010  1


# СЕТЕВОЕ УСТРОЙСТВО(А)
# Этот раздел настраивает вашу сеть IPX. Если она у вас уже
# настроена, вам этот пункт не нужен. Это тоже самое что и
# использование утилит ipx_configure/ipx_interface до запуска
# сервера. 
# Синтаксис:
#    4 &lt;Номер сети IPX> &lt;имя устройства> &lt;тип фрейма> [&lt;ticks>]
#                         Frame types: ethernet_ii, 802.2, 802.3, SNAP

4  0x39a01010  eth0  802.3  1

# СОХРАНЯТЬ МАРШРУТЫ IPX ПОСЛЕ ОКОНЧАНИЯ РАБОТЫ СЕРВЕРА
# Синтаксис:
#    5 &lt;флаг>
#       0 = не сохранять маршруты, 1 = сохранять маршруты

5 0

# ВЕРСИЯ NETWARE
# Синтаксис:
#    6 &lt;версия>
#      0 = 2.15, 1 = 3.11

6 1

# ОБРАБОТКА ПАРОЛЯ
# Настоящие клиенты Novell для DOS поддерживают процедуру, которая
# шифрует пароли при их изменении. Вы можете выбрать, хотите ли вы
# чтобы ваш сервер поддерживал эту процедуру или нет.
# Синтаксис:
#    7 &lt;флаг>
#    &lt;флаг> может быть:
#        0 force password encryption. (Клиенты не могут сменить пароль)
#        1 force password encryption, разрешить изменение нешифрованного пароля
#        7 разрешаются нешифрованные пароли, но не пустые
#        8 разрешаются нешифрованные пароли включая пустые
#        9 полностью нешифрованные пароли (не работает с OS/2)

7 1

# МИНИМАЛЬНЫЕ ПРАВА GID UID
# разрешения используемые для подсоединения без входа. Эти разрешения
# будут использоваться для файлов на присоединении к вашему
# основному серверу
# Синтаксис:
#    10 &lt;gid>
#    11 &lt;uid>
#    &lt;gid> &lt;uid> из /etc/passwd, /etc/groups

10  200
11  201

# ПАРОЛЬ АДМИНИСТРАТОРА (SUPERVISOR)
# Может быть убран после первого запуска сервера. Сервер зашифрует 
# эту информацию в файл bindery после запуска. Вы должны избегать
# использования пользователя 'root' и вместо этого использовать
# другой идентификатор для администрирования файлового сервера mars
#
# Эта запись читается и шифруется в файлы bindery сервера, так что он
# необходим только при первом запуске сервера, чтобы обеспечить
# чтобы пароль не украли.
#
# Синтаксис:
#    12 &lt;Идентификатор администратора> &lt;имя пользователя Unix> [&lt;пароль>]

12  SUPERVISOR  terry  secret

# ЗАПИСИ ПОЛЬЗОВАТЕЛЕЙ
# Этот раздел ассоциирует идентификаторы NetWare с идентификаторами
# пользователей unix. Наличие пароля является опциональным.
# Синтаксис:
     13 &lt;Идентификатор пользователя> &lt;имя пользователя в Unix> [&lt;пароль>]

13  MARTIN martin
13  TERRY  terry  

# НАСТРОЙКА СИСТЕМЫ "ЛЕНИВОГО" АДМИНИСТРИРОВАНИЯ
# Если у вас большое количество пользователей и вы не хотите
# беспокоиться использованием индивидуального мапирования
# пользовательских имен, как в предыдущем случае, то вы можете 
# автоматически мапировать идентификаторы mars_nwe в имена
# пользователей Linux. Но в настоящее время нет способа использовать
# пароли linux, так что все пользователи настроенные таким способом
# будут пользоваться единственным паролем, указанным здесь. Я
# рекомендую не использовать это до тех пор пока вас перестанет
# беспокоить безопасность.
# Синтаксис:
#    15 &lt;флаг> &lt;общий пароль>
#    &lt;флаг>:    0  - не делать автоматическое мапирование пользователей
#               1  - автоматически мапировать пользователей не указанных выше
#               99 - автоматически мапировать всех пользователей этим способом

15  0  duzzenmatta

# ПРОВЕРКА РАБОТОСПОСОБНОСТИ
# mars_nwe будет автоматически убеждаться, что определенные
# директории существуют, если установлен этот флаг
# Синтаксис:
#    16 &lt;флаг>
#    &lt;флаг> - 0 для нет, не делать, или 1 для да, делать проверку

16  0

# ОЧЕРЕДИ ПЕЧАТИ
# Этот раздел ассоциирует принтера NetWare с принтерами unix.
# Директории очередей должны быть созданы вручную до попытки печати.
# Директории очередей НЕ являются очередями lpd.
# Синтаксис:
#    21 &lt;имя очереди> &lt;директория очереди> &lt;команда печати unix>

21  EPSON  SYS:/PRINT/EPSON lpr -h
21  LASER  SYS:/PRINT/LASER lpr -Plaser

# ФЛАГИ ОТЛАДКИ 
# Обычно они не нужны, но могут быть полезными если вы ищите проблему.
# Синтаксис:
#    &lt;тема отладки> &lt;флаг отладки>
#
#    100 = IPX KERNEL
#    101 = NWSERV
#    102 = NCPSERV
#    103 = NWCONN
#    104 = start NWCLIENT
#    105 = NWBIND
#    106 = NWROUTED
#                 0 = запрещает отладку, 1 = разрешает отладку

100 0
101 0
102 0
103 0
104 0
105 0
106 0

# ЗАПУСК NWSERV В ФОНОВОМ РЕЖИМЕ И ИСПОЛЬЗОВАНИЕ ФАЙЛА ПРОТОКОЛА
# Синтаксис:
#    200 &lt;флаг>
#        0 = запуск NWSERV в нормальном режиме и не использовать файл протокола
#        1 = запуск NWSERV в фоновом режиме и использовать файл протокола

200  1

# ИМЯ ФАЙЛА ПРОТОКОЛА
# Синтаксис:
#    201 &lt;файл протокола>

201  /tmp/nw.log

# ДОПОЛНЯТЬ ПРОТОКОЛ ИЛИ ПЕРЕЗАПИСЫВАТЬ
# Синтаксис:
#    202 &lt;флаг>
#        0 = добавлять к существующему файлу протокола
#        1 = переписывать существующий файл протокола

202  1

# ВРЕМЯ ВЫКЛЮЧЕНИЯ СЕРВЕРА
# Этот раздел устанавливает время между выдачей команды SERVER DOWN и
# действительным выключением сервера.
# Синтаксис:
#    210 &lt;время>
#        в секундах. (по умолчанию 10)

210  10

# ИНТЕРВАЛ МЕЖДУ ПЕРЕДАЧАМИ ШИРОКОВЕЩАТЕЛЬНОЙ ПЕРЕДАЧЕЙ МАРШРУТОВ
# Время в секундах между широковещательными передачами сервера.
# Синтаксис:
#    211 &lt;время>
#        в секундах. (по умолчанию 60)

211  60

# ИНТЕРВАЛ ПРОТОКОЛИРОВАНИЯ МАРШРУТИЗАЦИИ
# Устанавливает сколько широковещательных передач произойдет до 
# протоколирования маршрутизационной информации.
# Синтаксис:
#    300  &lt;число>

300  5

# ФАЙЛ ПРОТОКОЛА МАРШРУТИЗАЦИИ
# Устанавливает имя файла протокола маршрутизации
# Синтаксис:
#    301 &lt;имя файла>

301  /tmp/nw.routes

# ДОБАВЛЕНИЕ/ПЕРЕЗАПИСЬ МАРШРУТНОЙ ИНФОРМАЦИИ
# Устанавливает хотите ли вы добавлять информацию к существующему 
# файлу протокола, или перезаписывать его.
# Синтаксис:
#    302 &lt;флаг>
#        &lt;flag> - 0 для дополнения, 1 для создания/перезаписи

302  1

# WATCHDOG TIMING
# Устанавливает хронометраж для наблюдательных сообщений, чтобы
# убедиться что сеть жива.
# Синтаксис:
#    310 &lt;значение>
#        &lt;значение> = 0 - всегда посылать наблюдательные сообщения
#                   &lt; 0 - (-ve) для запрета наблюдений
#                   > 0 - посылать наблюдательные сообщения при 
#                        падении трафика ниже 'n' ticks

310  7

# ФАЙЛ СТАНЦИЙ
# Устанавливает имя для файла станций, который определяет для каких
# машин этот файловый сервер будет выступать как первичный файловый 
# сервер. Синтаксис этого файла описан в директории 'examples' исходного
# кода пакета.
# Синтаксис:
#    400 &lt;имя файла>

400  /etc/nwserv.stations

# ОБРАБОТКА 'GET NEAREST FILESERVER'
# Устанавливает как будет обрабатываться запрос SAP 'Get Nearest 
# Fileserver' (получить ближайший файловый сервер). 
# Синтаксис:
#    401 &lt;флаг>
#        &lt;флаг>: 0 - запретить запросы 'Get Nearest Fileserver'.
#                1 - файл 'stations' перечисляет исключаемые станции.
#                2 - файл 'stations' перечисляет включаемые станции.

401  2
</PRE>
</CODE></BLOCKQUOTE>
<P>
<DT><B>Запуск сервера</B><DD><P>Если вы так настроили сервер, что он
полагается на внешние программы для настройки вашей сети и
и/или обеспечения функций маршрутизации, тогда вы должны
запустить эти программы до запуска сервера. Предполагая, что
вы настроили сервер, так что он настроит ваши интерфейсы и
будет обеспечивать сервисы маршрутизации, тогда вам
необходимо только выполнить команду: 
<P>
<BLOCKQUOTE><CODE>
<PRE>
# nwserv
</PRE>
</CODE></BLOCKQUOTE>
<P>
<DT><B>Проверка работы сервера</B><DD><P>Для тестирования сервера вы
первым делом должны попытаться присоединиться и войти с
клиента NetWare на вашей сети. Затем вы должны сделать
<CODE>CAPTURE</CODE> с клиента и попытаться напечатать. Если обе этих
вещи работают хорошо, тогда сервер работает.
<P>
</DL>
<P>
<H2><A NAME="ss10.2">10.2 Пакет <B><EM>lwared</EM></B></A>
        </H2>

<P>Ales Dryak <CODE>&lt;A.Dryak@sh.cvut.cz></CODE> разработал
<EM>lwared</EM> чтобы позволить Linux функционировать как файловый
сервер на базе NCP. 
<P>
<P>Ales назвал пакет <EM>lwared</EM>, сокращение для <EM>LinWare
Daemon</EM>.
<P>
<H3>Возможности <B><EM>lwared</EM></B>          </H3>

<P>Сервер <EM>lwared</EM> обеспечивает подмножество всех функций 
Novell NCP. Он включает функции сообщений, но не обеспечивает
возможности печати. В настоящее время он не совсем хорошо
работает с клиентами Windows95 или Windows NT. Сервер
<EM>lwared</EM> полагается на внешние программы для выполнения
функций построения и обновления таблиц маршрутизации IPX и таблиц
SAP. "Плохие" клиенты могут вызвать падение сервера. Что важно,
возможность трансляции имен не была включена. 
<P>
<P>Сервер работает с оболочками NETX и VLM NetWare.
<P>
<H3>Получение <B><EM>lwared</EM></B>          </H3>

<P>Пакет <EM>lwared</EM> может быть построен для любого ядра
новее чем <CODE>1.2.0</CODE>, я рекомендую вам использовать ядро версии
<CODE>1.2.13</CODE>, так как для этого не требуется заплаток (patches)
для ядра. Некоторые функциональные возможности IPX изменились в
ядрах версии <CODE>1.3.*</CODE> и это означает, что требуются заплатки
чтобы все работало правильно. Соответствующие заплатки включены в
состав новых ядер, так что если вы должны использовать ядра в
стадии alpha, вы все равно сможете заставить <EM>lwared</EM>
работать правильно.
<P>
<P>Вы можете получить пакет <EM>lwared</EM> по анонимному ftp с:
<A HREF="ftp://klokan.sh.cvut.cz/pub/linux/linware/">klokan.sh.cvut.cz</A><P>
<P>или с: 
<A HREF="ftp://sunsite.unc.edu/pub/Linux/system/network/daemons">sunsite.unc.edu</A> или серверов-зеркал. Текущая версия в
момент написания была: <CODE>lwared-0.95.tar.gz</CODE>.
<P>
<H3>Построение <B><EM>lwared</EM></B>          </H3>

<P>
<DL>
<DT><B>Разожмите пакет <EM>lwared</EM></B><DD><P>Выполните что-то
подобное этому:
<P>
<PRE>
# cd /usr/src
# tar xvpfz lwared-0.95.tar.gz
</PRE>
<P>
<DT><B>Построение ядра с поддержкой Ethernet и IPX</B><DD><P>Если вы
используете alpha версии ядер <CODE>1.3.*</CODE>, тогда вы должны
использовать ядро версии <CODE>1.3.17</CODE> или более новое,
потому-что прилагаемые заплатки были сделаны для него. Ядра
<CODE>1.3.*</CODE> старее чем <CODE>1.3.17</CODE> требуют ручного исправления
для установки (<EM>некоторая информация о том как сделать это
включена в файл <CODE>INSTALL</CODE> в составе пакета</EM>). Для
установки заплаток для ядра версии <CODE>1.3.17</CODE> или более
новых вы должны использовать команду: 
<P>
<PRE>
# make patch
</PRE>
<P>
<P>После приложения патчей, если необходимо, следующая вещь
которую вам необходимо сделать&nbsp;-- это убедиться что ваше
ядро скомпилированно с поддержкой IPX. Для ядра версии
<CODE>1.2.13</CODE> вам необходимо только убедиться, что вы ответили
<CODE>Y</CODE> на вопрос: '<CODE>The IPX protocol</CODE>' как показано:
<P>
<PRE>
 ...
 ...
Assume subnets are local (CONFIG_INET_SNARL) [y]
Disable NAGLE algorithm (normally enabled) (CONFIG_TCP_NAGLE_OFF) [n]
The IPX protocol (CONFIG_IPX) [n] y
*
* SCSI support
 ...
 ...
</PRE>
<P>
<P>В более новых ядрах процесс сходен, но текст запроса может 
незначительно измениться.
<P>
<P>Вам также будет необходимо проверить, что вы включили
соответствующий драйвер для вашей карты Ethernet. Если вы не
знаете как сделать это, тогда вы должны прочитать документ
<A HREF="http://www.linux.org.ru/books/HOWTO/Ethernet-HOWTO.html">Ethernet-HOWTO</A>. 
<P>
<P>Затем вы можете продолжать построение вашего
ядра. Помните, что необходимо запустить <EM>lilo</EM> для
установки ядра, после окончания процесса компиляции.
<P>
<DT><B>Компиляция и установка <EM>lwared</EM></B><DD><P>Для
компиляции <EM>lwared</EM> вы должны сначала проверить, и
если необходимо отредактировать, файл
<CODE>server/config.h</CODE>. Этот файл содержит различные
настройки, которые будут управлять поведением вашего сервера
при запуске. Значения по умолчанию достаточно разумны, но вы
можете проверить, что указанные директории для файлов
протокола и файлов настройки соответствуют вашей системе.
<P>
<PRE>
# make depend
# make
# make install
</PRE>
<P>
<P>Я заметил, что '<CODE>make depend</CODE>' жалуется на то что не
нашла файл  <CODE>float.h</CODE> на моей системе, но все равно
работает. Я также нашел, что когда я пытался компилировать с
gcc <CODE>2.6.3</CODE>, я изменил строку:
<P>
<PRE>
#include &lt;net/route.h>
</PRE>
<P>
<P>на
<P>
<PRE>
#include &lt;net/if_route.h>
</PRE>
<P>
<P>в <CODE>lib/ipxkern.c</CODE>, так как файл иногда меняет имя.
<P>
<P>'<CODE>make install</CODE>' будет пытаться установить сервер и
программы демонов маршрутизации в вашу директорию
<CODE>/usr/sbin</CODE>, программу <EM>lwpasswd</EM> в директорию
<CODE>/usr/bin</CODE>, программы работы с IPX будут установлены в
директорию <CODE>/sbin</CODE> и справочные страницы будут
установлены в директорию <CODE>/usr/man</CODE>. Если любое из
этих директорий не подходят для вашей системы, то вы должны
отредактировать файл <CODE>Makefile</CODE> и изменить конечные
директории на нужные.
<P>
</DL>
<P>
<H3>Настройка и использование <B><EM>lwared</EM></B>          </H3>

<P>
<DL>
<DT><B>Настройка сети IPX</B><DD><P>Первая вещь которую вы должны
сделать&nbsp;-- это настройка ваших интерфейсов Ethernet для
поддержки сетей IPX, которые ваш сервер будет
поддерживать. Для того чтобы сделать это вам необходимо знать 
сетевые адреса IPX для каждого из сегментов LAN, какие
устройства Ethernet (<CODE>eth0</CODE>, <CODE>eth1</CODE> etc.) находятся на
каком сегменте, какой тип фреймов (<CODE>802.3</CODE>, <CODE>EtherII</CODE>
etc.) использует каждый сегмент LAN и какой адрес внутренней
сети должен использовать ваш сервер (это необходимо только
если ваш сервер будет обслуживать больше одного сегмента
LAN). Настройка для сервера, который находится в двух
непохожих сегментах с сетевыми адресами IPX равными
<CODE>23a91300</CODE> и <CODE>23a91301</CODE> и адресом внутренней сети
<CODE>bdefaced</CODE> может выглядеть так: 
<P>
<PRE>
# ipx_internal_net add BDEFACED 1
# ipx_interface add eth0 802.3 23a91300
# ipx_interface add eth1 etherii 23a91301
</PRE>
<P>
<DT><B>Запуск демонов маршрутизации</B><DD><P>Программное
обеспечение ядра в действительности делает только
перекладывание пакетов IPX, также как и для IP, но ядро
требует дополнительных программ для управления обновлением
таблицы маршрутизации. Для IPX требуются два демона и оба
поставляются с <EM>lwared</EM>: <EM>ipxripd</EM> управляет
маршрутизационной информацией IPX, а <EM>ipxsapd</EM>
управляет информацией SAP. Для запуска демонов вам только
необходимо указать место где они могут писать свои файлы
протокола:
<P>
<PRE>
# ipxripd /var/adm/ipxrip
# ipxsapd /var/adm/ipxsap
</PRE>
<P>
<DT><B>Настройка сервера <EM>lwared</EM></B><DD><P>Существует два
файла, которые вы должны настроить вручную чтобы разрешить
пользователям входить на ваш сервер <EM>lwared</EM>. Это:
<P>
<P>
<DL>
<DT><B><CODE>/etc/lwpasswd</CODE></B><DD><P>Это место где хранится
информация о пользователях LinWare. программа
<EM>lwpasswd</EM> используется для работы с записями. В
простейшем случае файл <CODE>/etc/lwpasswd</CODE> выглядит
следующим образом: 
<P>
<PRE>
ales:
terryd:
guest:
</PRE>
<P>
<P>Этот формат является простым списком идентификаторов
входа с последующим символом ':' и затем шифрованная
версия пароля для входа. Здесь есть несколько дополнений:
отсутствие шифрованного пароля означает вход без пароля,
пользователи LinWare должны быть зарегестрированы в
Linux, так что любой пользователь кроме записи в файле
<CODE>/etc/lwpasswd</CODE> также должен иметь запись в
<CODE>/etc/passwd</CODE> и только пользователь <CODE>root</CODE>
является пользователем, который может менять пароль для
других пользователей LinWare. Если вы вошли в систему как
<CODE>root</CODE> то вы можете сменить пароль пользователя
LinWare как это показано: 
<P>
<PRE>
# lwpasswd rodg
Changing password for RODG
Enter new password: 
Re-type new password: 
Password changed.
</PRE>
<P>
<DT><B><CODE>/etc/lwvtab</CODE></B><DD><P>Этот файл содержит таблицу
томов LinWare и хранить информацию о том какие директории
будут доступны для пользователей LinWare (этот файл похож
по природе на файл NFS <CODE>/etc/exports</CODE>). Простой
пример формата этого файла: 
<P>
<PRE>
SYS             /lwfs/sys
DATA            /lwfs/data
HOME            /home
</PRE>
<P>
<P>Формат очень прост: После имени тома через пробел
следует экспортируемая директория Linux. Вы должны иметь
<B>по крайней мере</B> запись для тома <CODE>SYS</CODE>, чтобы
запустить сервер. Если вы намереваетесь для ваших DOS
клиентов использовать сервер LinWare как первичный
файловый сервер, тогда вы должны создать стандартную
структуру директорий тома <CODE>SYS</CODE> в директории
экспортируемой как ваш том <CODE>SYS</CODE>. Так как эти файлы
являются патентованными и авторскими правами на них
владеет корпорация Novell, вы дожны иметь на них
лицензию. Если ваши пользователи будут использовать
файловый сервер Novell как первичный сервер, то это не
является необходимым. 
<P>
</DL>
<P>
<DT><B>Запуск сервера <EM>lwared</EM></B><DD><P>tada!
<P>
<PRE>
# lwared
</PRE>
<P>
<P>Это выглядит разочаровывающе, не так ли? Ok, у вас есть
вопрос? Какое имя сервера будет присвоено? Если вы запустите
сервер как показано выше, то имя сервера LinWare будет
присвоено на основе имени возвращенного командой Linux
<EM>hostname</EM>. Если вы хотите какое-то другое имя, тогда
вы можете задать имя сервера при его старте, например
команда:
<P>
<PRE>
# lwared -nlinux00
</PRE>
<P>
<P>должна запустить сервер с именем <CODE>linux00</CODE>.
<P>
<DT><B>Тестирование сервера <EM>lwared</EM></B><DD><P>Самая первая
вещь для проверки&nbsp;-- это то что ваш сервер LinWare
появился в выводе команды <EM>slist</EM> запущенной с клиента
DOS на вашей сети. Программа <EM>slist</EM> хранится на томе
<CODE>SYS</CODE> файлового сервера Novell, так что вы должны сделать
это с какой-то машины уже подключенной куда-нибудь. Если это
не произошло, то проверьте что запущены <EM>ipxsapd</EM> и
<EM>lwared</EM>. Если выполнение команды <EM>slist</EM>
прошло удачно, то попытайтесь подключиться к серверу и
замапировать том:
<P>
<PRE>
C:> attach linux00/ales
 ...
 ...
C:> map l:=linux00/data:
C:> l:
</PRE>
<P>
<P>Вы должны затем нормально обращаться с новым мапированием
также как с другими. Разрешения на файлы которые вы будете
иметь, будут основаны на разрешениях, которые разрешены
вашими правами на <EM>linux</EM>, которые являются
параллельными вашему идентификатору LinWare.
<P>
</DL>
<P>
<HR>
<A HREF="IPX-HOWTO-11.html">Следующий</A>
<A HREF="IPX-HOWTO-9.html">Предыдущий</A>
<A HREF="IPX-HOWTO.html#toc10">Содержание</A>
</BODY>
</HTML>
