<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>PPP HOWTO: Использование PPP и привилегии root</TITLE>
 <LINK HREF="PPP-HOWTO-12.html" REL=next>
 <LINK HREF="PPP-HOWTO-10.html" REL=previous>
 <LINK HREF="PPP-HOWTO.html#toc11" REL=contents>
</HEAD>
<BODY>
<A HREF="PPP-HOWTO-12.html">Next</A>
<A HREF="PPP-HOWTO-10.html">Previous</A>
<A HREF="PPP-HOWTO.html#toc11">Contents</A>
<HR>
<H2><A NAME="s11">11. Использование PPP и привилегии root</A></H2>

<P>Поскольку PPP должен настроить сетевые устройства, измените таблицу 
маршрутизации ядра и т.д, что требует привилегий root.
<P>Если пользователи (не root) должны устанавливать PPP соединение, то программа 
pppd должна были setuid root: 
<PRE>
-rwsr-xr-x   1 root     root        95225 Jul 11 00:27  /usr/sbin/pppd
</PRE>

Если /usr/sbin/pppd не setuid, то зарегитрируйтесь как root и дайте команду:
<PRE>
chmod u+s /usr/sbin/pppd
</PRE>

После этого pppd бкдет запускаться с привилегиями root, даже если запущен
обычным пользователем. Это позволяет нормальному пользователю выполнять 
pppd с необходимыми привилегиями, чтобы настроить сетевые интерфейсы и 
таблицу маршрутизации ядра.
<P>Программы, которые выполняют 'set uid root', являются потенциальными лазейками 
в защите системы, и вы должны быть чрезвычайно осторожны при создании программ
'suid root'. Ряд программ (включая pppd) был тщательно написан с точки зрения
минимизации опасности выполнения suid root, так что вы должны быть защищены
(но все-таки гарантий нет).
<P>В зависимости от того, как вы хотите, чтобы ваша система работала - особенно
если вы хотите, чтобы ЛЮБОЙ пользователь вашей системы мог инициализировать 
PPP связь, то вы должны сделать ваш набор скриптов ppp-on/off 
читаемым/выполнимым. (Наверное это здорово, когда PC используется ТОЛЬКО Вами).
<P>Однако, если вы НЕ хотите, чтобы любой человек мог запускать PPP соединение 
(например, ваши дети имеет аккаунты на вашем Linux PC, и вы не хотите, чтобы 
они выходили в Интернет без вашего разрешения), то вы должны будете настроить 
группу PPP (как root, отредактировать /etc/group) и:
<UL>
<LI> сделайте для файла pppd - suid root, владелец root и группа PPP, с очищенными
правами 'other'. Это должно затем походить
<PRE>
-rwsr-x---   1 root     PPP        95225 Jul 11 00:27 /usr/sbin/pppd
</PRE>
</LI>
<LI> сделайте для скриптов ppp-on\off - владелец root и группа PPP
</LI>
<LI> сделайте скрипты ppp-on/off читаемыми/выполнимыми группой PPP
<PRE>
-rwxr-x---   1 root     PPP           587 Mar 14  1995 /usr/sbin/ppp-on 
-rwxr-x---   1 root     PPP           631 Mar 14  1995 /usr/sbin/ppp-off
</PRE>
</LI>
<LI> обнулите права other для ppp-on/off.
</LI>
<LI> добавьте пользователей, которые будут запускать PPP в группу PPP в /etc/group</LI>
</UL>

Даже если вы сделали это, обычные пользователи ВСЕ ЕЩЕ не могут завершить
связь программно! Выполнение сценария ppp-off требует привилегий root. 
Однако, любой пользователь может только выключить модем (или выдернуть 
телефонную линию из внутреннего модема).
<P>Вариант (и лучший метод), чтобы это настроить, состоит в использовании программы
sudo. Она предлагает повышенную защиту и позволит вам настроить систему так, 
чтобы любой (разрешенный) пользователь мог активизировать/дезактивировать 
связь, используя скрипты. Использование sudo позволит разрешенному пользователю 
активизировать/дезактивировать связь PPP чисто и надежно.
<HR>
<A HREF="PPP-HOWTO-12.html">Next</A>
<A HREF="PPP-HOWTO-10.html">Previous</A>
<A HREF="PPP-HOWTO.html#toc11">Contents</A>
</BODY>
</HTML>
