<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Мини-HOWTO: Sound Blaster AWE 32/64</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.57"></HEAD
><BODY
CLASS="ARTICLE"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="ARTICLE"
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
><A
NAME="AEN2"
>Мини-HOWTO: Sound Blaster AWE 32/64</A
></H1
><DIV
CLASS="AUTHORGROUP"
><A
NAME="AEN4"
></A
><H3
CLASS="AUTHOR"
><A
NAME="AEN5"
>Marcus Brinkmann</A
></H3
><DIV
CLASS="AFFILIATION"
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
>Marcus.Brinkmann@ruhr-uni-bochum.de</P
></DIV
></DIV
><H3
CLASS="CORPAUTHOR"
> Перевод: <A
HREF="mailto:sam@asp-linux.com"
TARGET="_top"
>Станислав Рогин</A
>,
 <A
HREF="http://www.asplinux.com"
TARGET="_top"
>SWSoft Pte Ltd.</A
>
 </H3
></DIV
><P
CLASS="PUBDATE"
>версия 1.2, 11 января 1998<BR></P
><DIV
><DIV
CLASS="ABSTRACT"
><A
NAME="AEN15"
></A
><P
></P
><P
>В этом документе описывается установка и настройка звуковой карты Sound Blaster 32 (SB AWE 32, SB AWE 64) фирмы Creative Labs на Linux-системе, с использованием Расширения Звукового Драйвера AWE автора Takashi Iwai. Он также описывает некоторые специальные утилиты и проигрыватели для SB серии AWE. Документ написан для дистрибутива Debian GNU/Linux, но также должно работать и на всех других дистрибутивах Linux.</P
><P
></P
></DIV
></DIV
><HR></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Содержание</B
></DT
><DT
>1. <A
HREF="Soundblaster-AWE.html#AEN17"
>Введение</A
></DT
><DD
><DL
><DT
>1.1. <A
HREF="Soundblaster-AWE.html#AEN21"
>Благодарности</A
></DT
><DT
>1.2. <A
HREF="Soundblaster-AWE.html#AEN31"
>История изменений документа</A
></DT
><DT
>1.3. <A
HREF="Soundblaster-AWE.html#AEN48"
>Новые версии этого документа</A
></DT
><DT
>1.4. <A
HREF="Soundblaster-AWE.html#AEN62"
>Отзывы</A
></DT
><DT
>1.5. <A
HREF="Soundblaster-AWE.html#AEN69"
>Distribution Policy</A
></DT
><DT
>1.6. <A
HREF="Soundblaster-AWE.html#AEN79"
>Авторские права</A
></DT
></DL
></DD
><DT
>2. <A
HREF="Soundblaster-AWE.html#AEN88"
>Перед началом работы</A
></DT
><DD
><DL
><DT
>2.1. <A
HREF="Soundblaster-AWE.html#AEN90"
>Введение</A
></DT
><DT
>2.2. <A
HREF="Soundblaster-AWE.html#AEN96"
>Некоторые общие замечания о картах SB AWE</A
></DT
><DT
>2.3. <A
HREF="Soundblaster-AWE.html#AEN101"
>Некоторые общие замечания о Plug and Play картах</A
></DT
><DT
>2.4. <A
HREF="Soundblaster-AWE.html#AEN115"
>Некоторые общие замечания о загружаемых модулях ядра</A
></DT
><DT
>2.5. <A
HREF="Soundblaster-AWE.html#AEN137"
>Некоторые общие замечания о звуковом драйвере ядра</A
></DT
></DL
></DD
><DT
>3. <A
HREF="Soundblaster-AWE.html#AEN147"
>Как установить поддержку звуковых карт AWE</A
></DT
><DD
><DL
><DT
>3.1. <A
HREF="Soundblaster-AWE.html#AEN149"
>Что вам понадобится</A
></DT
><DT
>3.2. <A
HREF="Soundblaster-AWE.html#ISAPNP"
>Начало работы</A
></DT
><DT
>3.3. <A
HREF="Soundblaster-AWE.html#AEN221"
>Сборка ядра</A
></DT
><DT
>3.4. <A
HREF="Soundblaster-AWE.html#AEN267"
>Перезагрузка</A
></DT
></DL
></DD
><DT
>4. <A
HREF="Soundblaster-AWE.html#AEN287"
>Проверяем драйвер звука</A
></DT
><DD
><DL
><DT
>4.1. <A
HREF="Soundblaster-AWE.html#AEN289"
><TT
CLASS="LITERAL"
>/proc/devices, /dev/sndstat</TT
></A
></DT
><DT
>4.2. <A
HREF="Soundblaster-AWE.html#AEN307"
>Вывод - прямое (Raw) аудио-устройство</A
></DT
><DT
>4.3. <A
HREF="Soundblaster-AWE.html#AEN318"
>Вывод - Синтезатор OPL-2/OPL-3</A
></DT
><DT
>4.4. <A
HREF="Soundblaster-AWE.html#AEN329"
>Вывод - Синтезатор Wave Table</A
></DT
><DT
>4.5. <A
HREF="Soundblaster-AWE.html#MIXING"
>Микширование</A
></DT
><DT
>4.6. <A
HREF="Soundblaster-AWE.html#AEN368"
>Ввод - оцифровка с помощью прямого аудио-устройства</A
></DT
><DT
>4.7. <A
HREF="Soundblaster-AWE.html#AEN374"
>Порт MIDI</A
></DT
></DL
></DD
><DT
>5. <A
HREF="Soundblaster-AWE.html#AEN377"
>Программное обеспечение драйвера AWE</A
></DT
><DD
><DL
><DT
>5.1. <A
HREF="Soundblaster-AWE.html#AEN379"
><TT
CLASS="LITERAL"
>sfxload</TT
></A
></DT
><DT
>5.2. <A
HREF="Soundblaster-AWE.html#AEN395"
><TT
CLASS="LITERAL"
>drvmidi</TT
></A
></DT
></DL
></DD
><DT
>6. <A
HREF="Soundblaster-AWE.html#AEN404"
>Приложение</A
></DT
><DD
><DL
><DT
>6.1. <A
HREF="Soundblaster-AWE.html#MOREINFO"
>Дополнительная информация</A
></DT
><DT
>6.2. <A
HREF="Soundblaster-AWE.html#SOURCES"
>Источники</A
></DT
><DT
>6.3. <A
HREF="Soundblaster-AWE.html#ISAPNPCONF"
>Пример <TT
CLASS="LITERAL"
>isapnp.conf</TT
></A
></DT
></DL
></DD
></DL
></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN17"
>1. Введение</A
></H1
><P
>В этом документе описывается установка и настройка звуковой карты Sound Blaster. Здесь приведена полная информация о том, как извлечь максимум из вашего Sound Blaster 32 или лучше, включая синтезатор Wave Table. Этот документ описывает все звуковые карты SB от  SB 32 и выше.</P
><P
>Серия звуковых карт Sound Blaster хорошо известна в сообществах DOS и Windows, и многие пользователи Linux тоже хотели бы использовать звуковые карты в своей работе. К сожалению, Creative Labs предоставляет драйвера только для Windows и DOS, поэтому не очень просто установить и использовать SB-карту в Linux. Этот документ пытается описать, как вы можете использовать возможности карт серии SB AWE под управлением Linux-а.</P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN21"
>1.1. Благодарности</A
></H2
><P
>Этот документ содержит информацию, которую я почерпнул из AWE Driver FAQ и ISA PnP FAQ. Смотрите раздел "<A
HREF="Soundblaster-AWE.html#SOURCES"
><I
>Источники</I
></A
>", чтобы узнать об авторе и местоположении этого документа. Благодаря этим авторам, поддержка SB AWE стала возможной.</P
><P
>Большое количество очень полезной работы проведено <A
HREF="http://www.4front-tech.com/usslite"
TARGET="_top"
>Hannu Savolainen</A
>, который разработал драйвер звука, встроенный в ядро Linux. Большое спасибо!</P
><P
>Я  хочу также поблагодарить <A
HREF="mailto:n.bern@mail.protos.it"
TARGET="_top"
>Nicola Bernardelli</A
>
за проверку вещей, касающихся AWE64. Без него многие ошибки так и остались бы не найденными.</P
><P
>Большое спасибо пакету <A
HREF="ftp://sunsite.unc.edu/pub/Linux/utils/text/sgml-tools-0.99.0.tar.gz"
TARGET="_top"
>SGML Tools</A
>, этот документ доступен в несколькоих форматах, и все они  сгенерированы из общего исходного файла.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN31"
>1.2. История изменений документа</A
></H2
><P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
>Версия 1.0</DT
><DD
><P
>Изначальная версия</P
></DD
><DT
>Версия 1.1</DT
><DD
><P
>Исправлены синтаксические ошибки (спасибо, Curt!), добавлены требования версии <TT
CLASS="LITERAL"
>isapnp</TT
>, теперь доступной через sunsite и большинство его зеркал</P
></DD
><DT
>Версия 1.2</DT
><DD
><P
>Доступна версия на французском!, небольшие изменения, исправлены синтаксические ошибки (спасибо программе ispell)</P
></DD
></DL
></DIV
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN48"
>1.3. Новые версии этого документа</A
></H2
><P
>Последняя версия этого документа может быть найдена на моей Домашней Страничке, под именем
<A
HREF="http://homepage.ruhr-uni-bochum.de/Marcus.Brinkmann/soundblaster.html"
TARGET="_top"
>Sound Blaster AWE HOWTO</A
>.</P
><P
>Новые версии этого документа будут загружаться на различные анонимные ftp-сервера, содержащих подобную информацию, включая <A
HREF="ftp://sunsite.unc.edu/pub/Linux/docs/HOWTO/mini"
TARGET="_top"
>ftp://sunsite.unc.edu/pub/Linux/docs/HOWTO/mini</A
>.</P
><P
>Гипертекстовые версии этого и других Linux HOWTO доступны на большом количестве WWW-сайтов, включая <A
HREF="http://sunsite.unc.edu/LDP/"
TARGET="_top"
>http://sunsite.unc.edu/LDP/</A
>. Most Linux CD-ROM distributions include the HOWTOs, often under the
<TT
CLASS="LITERAL"
>/usr/doc</TT
>.</P
><P
>Спасибо Arnaud Launay <A
HREF="mailto:zoro@lsol.tm.fr"
TARGET="_top"
>zoro@lsol.tm.fr</A
>, за французскую версию этого документа! Последнюю версию этого документа можно найти через <A
HREF="http://www.freenix.fr/linux/HOWTO"
TARGET="_top"
>http</A
>
или <A
HREF="ftp://ftp.lip6.fr/pub/linux/french/docs/HOWTO"
TARGET="_top"
>anonymous ftp</A
>.</P
><P
>Если вы переведете этот документ на другой язык, дайте мне знать, и я включу ссылку на это здесь.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN62"
>1.4. Отзывы</A
></H2
><P
>Я возлагаю на вас, читатели, обязанность сделать  этот документ полезным. Если у вас есть предложения, поправки или комментарии, посылайте их мне по адресу
<A
HREF="mailto:Marcus.Brinkmann@ruhr-uni-bochum.de"
TARGET="_top"
>Marcus.Brinkmann@ruhr-uni-bochum.de</A
>, и я попытаюся вставить их в следующую версию.</P
><P
>Я буду особенно рад информации о стартовых процедурах (загрузочных скриптах и т.п.) других знаменитых дистрибутивов Linux, например Red Hat или SuSE Linux.</P
><P
>Если вы опибликуете этот документ на CD-ROM или на бумажном носителе, подарочный экземпляр тоже будет воспринят с радостью. Пишите мне на мой почтовый адрес. Также внесите пожертвование Проекту Документирования Linux (Linux Documentation Project) для поддержки бесплатной документации к Linux. Свяжитесь с координатором Linux HOWTO, Tim Bynum <A
HREF="mailto:linux-howto@sunsite.unc.edu"
TARGET="_top"
>linux-howto@sunsite.unc.edu</A
>,
за дополнительной информацией.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN69"
>1.5. Distribution Policy</A
></H2
><P
>Copyright 1997 Marcus Brinkmann.</P
><P
>This HOWTO is free documentation; you can redistribute it and/or
modify it under the terms of the GNU General Public License as
published by the Free Software Foundation; either version 2 of the
License, or (at your option) any later version.</P
><P
>This document is distributed in the hope that it will be useful, but
<I
CLASS="EMPHASIS"
>without any warranty</I
>; without even the implied warranty of
<I
CLASS="EMPHASIS"
>merchantability</I
> or <I
CLASS="EMPHASIS"
>fitness for a particular purpose</I
>.
See the GNU General Public License for more details.</P
><P
>You can obtain a copy of the GNU General Public License by writing to
the <A
HREF="http://www.fsf.org"
TARGET="_top"
>Free Software Foundation</A
>,
Inc., 675 Mass Ave, Cambridge, MA 02139,
USA.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN79"
>1.6. Авторские права</A
></H2
><P
>Авторские права на русский перевод этого текста принадлежат &copy; 2000 SWSoft Pte Ltd.
Все права зарезервированы.</P
><P
>Этот документ является частью проекта Linux HOWTO.</P
><P
>Авторские права на документы Linux HOWTO принадлежат их авторам, если явно
не указано иное. Документы Linux HOWTO, а также их переводы, могут
быть воспроизведены и распространены полностью или частично на любом
носителе, физическом или электронном, при условии сохранения этой заметки об
авторских правах на всех копиях. Коммерческое распространение разрешается и
поощряется; но, так или иначе, автор текста и автор перевода желали бы знать о
таких дистрибутивах.</P
><P
>Все переводы и производные работы, выполненные по документам Linux HOWTO,
должны сопровождаться этой заметкой об авторских правах. Это делается в
целях предотвращения случаев наложения дополнительных ограничений на
распространение документов HOWTO. Исключения могут составить случаи
получения специального разрешения у координатора Linux HOWTO, с которым
можно связаться по адресу приведенному ниже.</P
><P
>Мы бы хотели распространить эту информацию по всем возможным каналам. Но
при этом сохранить авторские права и быть уведомленными о всех планах
распространения HOWTO. Если у вас возникли вопросы, пожалуйста, обратитесь
к координатору проекта Linux HOWTO по электронной почте:
<TT
CLASS="EMAIL"
>&#60;<A
HREF="mailto:linux-howto@metalab.unc.edu"
>linux-howto@metalab.unc.edu</A
>&#62;</TT
> или к координатору русского
перевода Linux HOWTO компании SWSoft Pte Ltd. по адресу
<TT
CLASS="EMAIL"
>&#60;<A
HREF="mailto:linux-howto@asplinux.ru"
>linux-howto@asplinux.ru</A
>&#62;</TT
></P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN88"
>2. Перед началом работы</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN90"
>2.1. Введение</A
></H2
><P
>Этот документ пытается помочь вам, установить и использовать Sound Blaster AWE 32 или Sound Blaster AWE 64 фирмы Creative Labs в вашей Linux-системе. Здесь описываются процедуры, проверенные для системы <A
HREF="http://www.debian.org"
TARGET="_top"
>Debian GNU/Linux</A
>
на платформе Intel i586, но это должно работать со всеми другими дистрибутивами Linux, равно как и со всеми платформами и звуковыми картами, поддерживаемыми драйвером звука Linux (различия будут упоминаться там, где они есть).</P
><P
>Прочтите внимательно "HOWTO: Звук в Linux" (Linux Sound HOWTO) (см. раздел "<A
HREF="Soundblaster-AWE.html#MOREINFO"
><I
>Дополнительная информация</I
></A
>"). Я рассматриваю свой документ, как дополнение к этому HOWTO, и очень часто более полную информацию вы можете найти там, особенно то, что я мог упустить.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN96"
>2.2. Некоторые общие замечания о картах SB AWE</A
></H2
><P
>Звуковая карта SB AWE 32 представляет из себя: прямое (raw) аудио-устройство, стандартный OPL-2/OPL-3 синтезатор, MIDI-порт MPU-401 и 32-голосный EMU 8000 WaveTable-синтезатор (для разъяснения значений этих и других терминов смотрите "HOWTO: Звук в Linux"). Одна из целей этого документа - помочь вам настроить нормальную работу всех этих функций.</P
><P
>В карту SB AWE 64 встроены все функции SB AWE 32 и дополнительный синтезатор Wave Guide, которым так гордится Creative Labs. Проблема для пользователей Linux состоит в том, что дополнительные 32 голоса генерируются программно и выводятся через прямые аудио устройства. Но, поскольку фирма Creative Labs не видит в Linux рынка сбыта драйверов, драйвер звука для синтезатора Wave Guide существует только для Windows 3.1 и Windows 95.</P
><P
>Учитывая это, с точки зрения пользователя Linux, карты SB AWE 32 и SB AWE 64 почти идентичны. С этого момента я буду упоминать только SB AWE вообще, и буду лишь упоминать о различиях, когда они возникают.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN101"
>2.3. Некоторые общие замечания о Plug and Play картах</A
></H2
><P
>Многие современные карты на платформе Intel являются так называемыми ISA PnP картами, где PnP - это аббревиатура к сочетанию "Plug and Play" (Включи и работай). Это означает, что карта должна быть настроена операционной системой, и это должно производиться программой инициализации во время загрузки системы. В общем случае, существует как минимум три способа сделать это:</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>У вас есть PnP Bios, что означает, что ваш BIOS осведомлен о возможном наличии PnP-карт и может их отконфигурировать. Если вы думаете, что можете использовать все функции вашего SB AWE PnP только потому, что у вас PnP Bios, то тут вам не повезло. Даже если BIOS заявляет, что поддерживает PnP карты, то он всего лишь настраивает набор портов и адресов, используемых картой. Вы, возможно, сможете играть прямой (raw) звук, но , например, не сможете воспользоваться MIDI-музыкой. Поэтому PnP BIOS не подходит для наших целей.&#13;</P
></LI
><LI
><P
>У вас есть операционная система, поддерживающая PnP карты. Текущее стабильное ядро Linux версий 2.0.x - это не такая система, поэтому нам придется подождать будущих релизов ядра, которые будут поддерживать PnP устройства.&#13;</P
></LI
><LI
><P
>У вас есть специальная программа, запускаемая в процессе загрузки системы, которая инициализирует ваши PnP- карты. Это как раз тот способ, который мы будем использовать.</P
></LI
></OL
>&#13;</P
><P
>Наиболее часто используемой программой, предназначенной для инициализации PnP карт под Linux, является пакет "isapnptools" (см. раздел "<A
HREF="Soundblaster-AWE.html#SOURCES"
><I
>Источники</I
></A
>" и
"<A
HREF="Soundblaster-AWE.html#ISAPNP"
><I
>Начало работы</I
></A
>"). Этот пакет обеспечивает предсказуемый способ инициализации всех ISA PnP карт на вашей машине, а не только звуковых.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN115"
>2.4. Некоторые общие замечания о загружаемых модулях ядра</A
></H2
><P
>Некоторые драйвера устройств могут быть построены в виде модулей, вместо встраивания их внутрь ядра. Вы можете найти дополнительную информацию о модулях в "HOWTO:Ядро" (Kernel HOWTO) и "HOWTO:Модули" (Module HOWTO) (см. раздел "<A
HREF="Soundblaster-AWE.html#MOREINFO"
><I
>Дополнительная информация</I
></A
>").</P
><P
>Если у вас PnP карта, <I
CLASS="EMPHASIS"
>то</I
> установите поддержку звука в виде загружаемого модуля ядра. Это означает, что нельзя встраивать драйвер звука в ядро, вам, вместо этого, необходимо собрать этот драйвер в виде модуля, чтобы он мог загружаться в систему уже после загрузки ядра. Это необходимо по той причине, что ядро загружается до конфигурирования ваших ISA PnP карт, а ваш драйвер звука должен быть загружен после конфигурирования ISA PnP карт.</P
><P
>Модуль драйвера звука может быть загружен вручную командами <TT
CLASS="LITERAL"
>insmod sound</TT
> или
<TT
CLASS="LITERAL"
>modprobe -a sound</TT
> или в соответствующем загрузочном скрипте вашего Linux-а (в Debian достаточно добавить строку
<TT
CLASS="LITERAL"
>sound</TT
> в файл <TT
CLASS="LITERAL"
>/etc/modules</TT
>). Другой вариант - это запустить <TT
CLASS="LITERAL"
>kerneld</TT
>, демон (daemon), который устанавливает и выгружает модули ядра по необходимости.</P
><P
>Заметьте однако, что <TT
CLASS="LITERAL"
>kerneld</TT
> - это не лучшее решение для модуля драйвера звука SB AWE, потому что загрузка модуля в ядро занимает некоторое время, особенно, если вы хотите использовать WaveTable-синтезатор и загрузить в него большие звуковые банки (Sound Font banks), что придется делать каждый раз после установки модуля. По той причине, что <TT
CLASS="LITERAL"
>kerneld</TT
> удаляет неиспользуемые модули через одну минуту, то, наверное, правильнее установить модуль звука вручную или в процессе загрузки. Заметьте, что ручная установка модуля или его установка в процессе загрузки предохранит этот модуль от выгрузки
<TT
CLASS="LITERAL"
>kerneld</TT
>. Кстати: вы можете вручную загрузить модуль драйвера звука и в то же время использовать <TT
CLASS="LITERAL"
>kerneld</TT
>. Эти два метода не конфликтуют, и <TT
CLASS="LITERAL"
>kerneld</TT
> не будет обращать внимания на модуль драйвера звука.</P
><P
>Это особенно полезно, когда настройки вашего микшера изменяются после удаления и переустановки модуля. Решение этой проблемы приведено разделе "<A
HREF="Soundblaster-AWE.html#MIXING"
><I
>Микширование</I
></A
>"
(там описано, как можно автоматически запускать микшер после загрузки модуля драйвера звука). Однако, загрузка модуля демоном
<TT
CLASS="LITERAL"
>kerneld</TT
>, загрузка звуковых банков и запуск вашего микшера занимает длительное время, и по этой и по некоторым другим причинам все-таки лучше устанавливать модуль звука в процессе загрузки, и, таким образом, не давать <TT
CLASS="LITERAL"
>kerneld</TT
> его выгрузить.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN137"
>2.5. Некоторые общие замечания о звуковом драйвере ядра</A
></H2
><P
>Вы можете установить поддержку звука внутрь ядра или в загружаемый модуль. Если у вас PnP карта, то вам придется это сделать с помощью модуля, потому что PnP карты нужно инициализировать через утилиты isapnptools до загрузки модуля.</P
><P
>Как вы уже наверно поняли, придется пересобирать ядро. Я дам необходимые подсказки по этому поводу немного позднее. А теперь давайте поговорим о поддержке звука в исходных текстах ядра. Ядро поставляется с бесплатной (усеченной) версией звукового драйвера OSS (USS). Текущая версия этого драйвера (3.5.4) не полностью поддерживает SB AWE, но SB 16 - это часть AWE. Поэтому вам будут доступны прямое аудио-устройство и OPL-2/OPL-3 синтезатор, если вы используете этот драйвер, но вам будет недоступна MIDI-музыка, использующая WaveTable-синтезатор.</P
><P
>Если вы хотите использовать WaveTable-устройство, то купите коммерческий драйвер звука у компании <A
HREF="http://www.4front-tech.com"
TARGET="_top"
>4Front Technologies</A
> (кто-нибудь, подтвердите, что их драйвер поддерживает AWE), или исправьте ядро патчем Звукового Драйвера AWE 32 автора Takashi Iwai. Первый не обозревается в этом документе, я же предполагаю, что вы будете использовать второй.</P
><P
>Звуковой Драйвер AWE32 (см. раздел "<A
HREF="Soundblaster-AWE.html#SOURCES"
><I
>Источники</I
></A
>") опубликован в соответствии с Лицензией GNU и поставляется с набором утилит, использующих EMU 8000 синтезатор карт SB AWE.</P
><P
>Программа <TT
CLASS="LITERAL"
>awedrv</TT
> также включена в новые исходные тексты ядер (начиная с некоторых версий ядра 2.1.x, но, возможно, когда вы захотите обновить исходные текста ядра, они уже немного устареют).</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN147"
>3. Как установить поддержку звуковых карт AWE</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN149"
>3.1. Что вам понадобится</A
></H2
><P
>Ниже приведен список того, что необходимо для установки поддержки SB AWE под Linux:</P
><P
>&#13;<P
></P
><UL
><LI
><P
>работающая Linux-система (например, дистрибутив Debian GNU/Linux),</P
></LI
><LI
><P
>SB AWE 32 или совместимая карта (например. SB32, SB32 PnP, SB AWE64, ...),</P
></LI
><LI
><P
>исходные тексты ядра Linux, включая драйвер звука OSS/Free (обычно включен в поставку, прочтите <TT
CLASS="LITERAL"
>/usr/src/Linux/drivers/sound/Readme</TT
>),</P
></LI
><LI
><P
>Звуковой Драйвер AWE 32.</P
></LI
></UL
>&#13;</P
><P
>Если у вас PnP-карта, вам также понадобится:</P
><P
>&#13;<P
></P
><UL
><LI
><P
>пакет утилит isapnptools. </P
></LI
></UL
>&#13;</P
><P
>Смотрите раздел "<A
HREF="Soundblaster-AWE.html#SOURCES"
><I
>Источники</I
></A
>", в котором описано, где можно найти эти программы.</P
><P
>Если у вас система Debian GNU/Linux - это означает, что  нужны пакеты <TT
CLASS="LITERAL"
>kernel-source-&lt;версия&gt;</TT
>, <TT
CLASS="LITERAL"
>awe-drv</TT
>
и, возможно, пакет <TT
CLASS="LITERAL"
>isapnptools</TT
>.
Вы, наверное, также захотите установить другие <TT
CLASS="LITERAL"
>awe-*</TT
> пакеты, хотя они не так и важны для установки. Я настойчиво рекомендую установку пакета
<TT
CLASS="LITERAL"
>kernel-package</TT
> для более простой компиляции и установки ядра.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="ISAPNP"
>3.2. Начало работы</A
></H2
><P
>Предположим, что вы правильно установили вашу карту в гнездо на материнской плате, и, возможно, проверили ее работоспособность в DOS или Windows.</P
><P
>Следующим шагом будет настройка инициализации карты в процессе загрузки (только если у вас PnP-карта). Следуйте документации в исходных текстах, соберите и установите пакет <TT
CLASS="LITERAL"
>isapnptools</TT
> (или используйте уже собранный пакет дистрибутива Debian), и, затем, наберите</P
><P
>&#13;<PRE
CLASS="SCREEN"
># pnpdump &#62; /etc/isapnp.conf</PRE
>&#13;</P
><P
>будучи root-ом. Эта команда сгенерирует нормальный конфигурационный файл для ваших PnP-карт, но с закомментированными устройствами. Аккуратно отредактируйте этот файл, сравнивая значения номеров DMA-каналов, базовых значений портов ввода-вывода и номера IRQ с соответствующими значениями под DOS или Windows, если это возможно (в Windows'95, изучите ресурсы, выделенные карте в пункте
<TT
CLASS="LITERAL"
>resources</TT
> (ресурсы) в <TT
CLASS="LITERAL"
>device manager</TT
>) ("Свойства:Система")). Если у вас возникли проблемы, еще  раз подробно прочтите документацию к пакету <TT
CLASS="LITERAL"
>isapnptools</TT
>.</P
><DIV
CLASS="CAUTION"
><P
></P
><TABLE
CLASS="CAUTION"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="http://www.linux.org.ru/books/images/caution.gif"
HSPACE="5"
ALT="Предостережение"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
><I
CLASS="EMPHASIS"
>ВНИМАНИЕ:</I
> <TT
CLASS="LITERAL"
>isapnptools</TT
> часто не могут правильно определить все три порта ввода-вывода устройства WaveTable карты SB AWE. Пожалуйста, сравните строку <TT
CLASS="LITERAL"
>WaveTable</TT
>
в вашем файле <TT
CLASS="LITERAL"
>isapnp.conf</TT
> с тем, что приведено в примере в приложении к этому HOWTO. Настройте базы портов ввода-вывода, если это необходимо.</P
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="CAUTION"
><P
></P
><TABLE
CLASS="CAUTION"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="http://www.linux.org.ru/books/images/caution.gif"
HSPACE="5"
ALT="Предостережение"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
><I
CLASS="EMPHASIS"
>ВНИМАНИЕ:</I
> В соответствии с <TT
CLASS="LITERAL"
>isapnp-faq</TT
>, <TT
CLASS="LITERAL"
>isapnp</TT
>
иногда неправильно программирует логический номер устройства. Если вы встретите сообщения об ошибках типа:</P
></TD
></TR
></TABLE
></DIV
><P
>&#13;<PRE
CLASS="SCREEN"
>Error occurred executing request 'LD 2' on or around line...
Во время исполнения запроса 'LD 2' возникла ошибка в строке...</PRE
>&#13;</P
><P
>попробуйте добавить строку <TT
CLASS="LITERAL"
>(VERIFYLD N)</TT
> в начале файла <TT
CLASS="LITERAL"
>isapnp.conf</TT
>. Вам придется использовать версию 1.10 или новее, чтобы этот ключ сработал. Если у вас нет возможности использовать версию 1.10 или новее, вы также можете ПРОПИСАТЬ логический номер устройства напрямую. Читайте <TT
CLASS="LITERAL"
>isapnp-faq</TT
> для более полной информации по этому вопросу. Если и это не заработает, свяжитесь со мной (и ребятами, занимающимися <TT
CLASS="LITERAL"
>isapnp</TT
>, им тоже будет интересно, я думаю).</P
><DIV
CLASS="CAUTION"
><P
></P
><TABLE
CLASS="CAUTION"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="http://www.linux.org.ru/books/images/caution.gif"
HSPACE="5"
ALT="Предостережение"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
><I
CLASS="EMPHASIS"
>ВНИМАНИЕ:</I
> Убедитесь, что в последней строке написана команда <TT
CLASS="LITERAL"
>(WAITFORKEY)</TT
>,
которая иногда опускается старыми версиями <TT
CLASS="LITERAL"
>pnpdump</TT
>.</P
></TD
></TR
></TABLE
></DIV
><P
>Пример файла <TT
CLASS="LITERAL"
>isapnp.conf</TT
> для одной PnP-карты (звуковой карты) вы можете найти в приложении к этому документу (см.раздел "<A
HREF="Soundblaster-AWE.html#ISAPNPCONF"
><I
>Пример <I
>isapnp.conf</I
></I
></A
>").</P
><P
>Если у вас Debian-система, то никаких дополнительных настроек не потребуется.
<TT
CLASS="LITERAL"
>isapnp</TT
> будет запускаться в процессе загрузки в файле <TT
CLASS="LITERAL"
>/etc/init.d/boot</TT
> той частью скрипта, которую вы наверно захотите добавить в свои загрузочные скрипты:

<PRE
CLASS="PROGRAMLISTING"
># Настройка ISA PnP карт до загрузки
# модулей. Это необходимо сделать ДО загрузки модулей, чтобы
# настроить и запустить PnP карты ДО того, как
# драйверы там все напутают.
#
if [ -x /etc/init.d/isapnp ]
then
  /etc/init.d/isapnp start
fi</PRE
>

где <TT
CLASS="LITERAL"
>/etc/init.d/isapnp</TT
> - это:

<PRE
CLASS="PROGRAMLISTING"
>#! /bin/sh
# /etc/init.d/isapnp: конфигурация Plug and Play карт
test -x /sbin/isapnp || exit 0
/sbin/isapnp /etc/isapnp.conf
exit 0</PRE
>&#13;</P
><P
>Если у вас другой дистрибутив Linux, то все зависит от вас. Я не знаю, что делать в других дистрибутивах (кто-нибудь желает послать мне более точную информацию?). Просто убедитесь в том, что isapnp запускается <I
CLASS="EMPHASIS"
>до</I
> загрузки модулей (см. ниже).</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN221"
>3.3. Сборка ядра</A
></H2
><P
>До сборки ядра вам придется установить Звуковой Драйвер AWE в стандартный драйвер звука ядра. Даже если ваши исходные тексты ядра включают расширение
<TT
CLASS="LITERAL"
>awedrv</TT
> (см.каталог <TT
CLASS="LITERAL"
>/drivers/sound/lowlevel/</TT
>), вы захотите обновить программу <TT
CLASS="LITERAL"
>awedrv</TT
>. Следуйте инструкциям по установке в каталоге исходных текстов <TT
CLASS="LITERAL"
>awedrv</TT
>. Вкратце, вам придется запустить скрипт, который произведет необходимые изменения в исходных текстах ядра.</P
><P
>Проверьте, обновились ли исходные тексты ядра после запуска этого скрипта. Он просто проверяет, существует ли конкретный файл - если он существует, то он ничего не делает. Вам лучше предварительно удалить файл <TT
CLASS="LITERAL"
>drivers/sound/lowlevel/awe_wav.c</TT
> до запуска этого скрипта.</P
><P
>Затем вам надо настроить ядро, включив в нем поддержку звука. Я надеюсь, что вы немного разбираетесь в сборке ядра; обращайтесь в "HOWTO: Звук в Linux" (Linux Sound HOWTO) и "HOWTO: Ядро" (Kernel HOWTO)  за подробной информацией. Перейдите в каталог исходных текстов ядра (например
<TT
CLASS="LITERAL"
>/usr/src/linux</TT
>) и наберите:</P
><P
>&#13;<PRE
CLASS="SCREEN"
># make config</PRE
>&#13;</P
><P
>или <TT
CLASS="LITERAL"
>make menuconfig</TT
>, или <TT
CLASS="LITERAL"
>make xconfig</TT
>. Затем вам придется настроить ядро обычным образом. Используйте возможность создать маленькое и очень мощное ядро, собранное специально для  вашей машины. Обязательно включите пункт <TT
CLASS="LITERAL"
>"Поддержка загружаемых модулей" (Enable loadable module support)</TT
>, если вы собираетесь собрать драйвер звука в виде модуля (вы <I
CLASS="EMPHASIS"
>должны</I
> это сделать, если у вас PnP карта), но я уверен, что вы включите эту опцию в любом случае.</P
><P
>Затем вам будет задан вопрос о поддержке звука. Можно ответить <TT
CLASS="LITERAL"
>Y</TT
> или <TT
CLASS="LITERAL"
>M</TT
> здесь, если у вас <I
CLASS="EMPHASIS"
>не</I
>-PnP карта.
<I
CLASS="EMPHASIS"
>Ответьте</I
> <TT
CLASS="LITERAL"
>M</TT
> здесь, если у вас PnP-карта. Вы должны собрать поддержку звуковой карты в виде модуля, при наличии  PnP карты потому, что PnP карта должна быть инициализирована до загрузки модуля драйвера звука.</P
><P
>На следующие вопросы необходимо ответить <TT
CLASS="LITERAL"
>Y</TT
>, на все другие
<TT
CLASS="LITERAL"
>N</TT
>:</P
><P
>&#13;<PRE
CLASS="PROGRAMLISTING"
>Sound Blaster (SB, SBPro, SB16, clones) support (CONFIG_SB) [Y/n/?]
	(Поддержка Sound Blaster (SB, SBPro, SB16, clones) (CONFIG_SB) [Y/n/?])

Generic OPL2/OPL3 FM synthesizer support (CONFIG_ADLIB) [Y/n/?]
	(Поддержка Стандартного OPL2/OPL3 FM-синтезатора (CONFIG_ADLIB) [Y/n/?])

/dev/dsp and /dev/audio support (CONFIG_AUDIO) [Y/n/?]
	(Поддержка /dev/dsp и /dev/audio (CONFIG_AUDIO) [Y/n/?])

MIDI interface support (CONFIG_MIDI) [Y/n/?]
	(Поддержка MIDI-интерфейса (CONFIG_MIDI) [Y/n/?])

FM synthesizer (YM3812/OPL-3) support (CONFIG_YM3812) [Y/n/?]
	(Поддержка FM-синтезатора (YM3812/OPL-3) (CONFIG_YM3812) [Y/n/?])

lowlevel sound driver support [Y/n/?]
	(Поддержка звукового драйвера низкого уровня [Y/n/?])
 
AWE32 support (CONFIG_AWE32_SYNTH) [Y/n/?]
	(Поддержка AWE32 (CONFIG_AWE32_SYNTH) [Y/n/?])&#13;</PRE
>&#13;</P
><P
>Только последний вопрос касается WaveTable-синтезатора. Остальные касаются поддержки SB 16 драйвером звука OSS/Free.</P
><P
>В дополнение к этому, вам придется настроить порт ввода-вывода звуковой карты. Еще раз взгляните в файл
<TT
CLASS="LITERAL"
>isapnp.conf</TT
> за подсказкой, если он есть. Для меня следующих стандартных значений достаточно. Заметьте, что стандартное значение, написанное в конфигурационном скрипте, может быть неверно (особенно значения <TT
CLASS="LITERAL"
>SBC_IRQ</TT
> и
<TT
CLASS="LITERAL"
>SB_MPU_BASE</TT
> часто неверны для многих карт).</P
><P
>&#13;<PRE
CLASS="PROGRAMLISTING"
>I/O base for SB Check from manual of the card (SBC_BASE) [220]
	(Номер базового порта для SB (сверьтесь с руководством по карте) (SBC_BASE) [220])

Sound Blaster IRQ Check from manual of the card (SBC_IRQ) [5]
	(Номер IRQ для SB (сверьтесь с руководством по карте)(SBC_IRQ) [5])

Sound Blaster DMA 0, 1 or 3 (SBC_DMA) [1]
	(Номер DMA для SB (SBC_DMA) [1])

Sound Blaster 16 bit DMA (_REQUIRED_for SB16, Jazz16, SMW) 5, 6 or 7
(use 1 for 8 bit cards) (SB_DMA2) [5]
	(Номер 16-битного DMA для SB (_ОБЯЗАТЕЛЬНО_ для SB16, Jazz16, SMW) 5, 6 or 7
	(используйте 1 для 8-битных карт) (SB_DMA2) [5]

MPU401 I/O base of SB16, Jazz16 and ES1688 Check from manual of the card (SB_MPU_BASE) [330]
	(Номер базового порта MPU401 для SB16, Jazz16 and ES1688 (сверьтесь с
	руководством по карте (SB_MPU_BASE) [330])

SB MPU401 IRQ (Jazz16, SM Wave and ES1688) Use -1 with SB16 (SB_MPU_IRQ) [-1]
	(SB MPU401 IRQ (Jazz16, SM Wave and ES1688) Используйте -1 для SB16 (SB_MPU_IRQ) [-1])&#13;</PRE
>&#13;</P
><P
>Теперь пересоберите ядро. Пользователь Debian должны использовать пакет
<TT
CLASS="LITERAL"
>kernel-package</TT
>. Этот пакет позволяет собирать ядро так же просто, как и любой другой пакет в debian. Прочтите инструкцию в каталоге
<TT
CLASS="LITERAL"
>/usr/doc/kernel-package/</TT
>. Подсказка:</P
><P
>&#13;<PRE
CLASS="SCREEN"
># make-kpkg clean
# make-kpkg -revision custom.1.0 kernel_image</PRE
>&#13;</P
><P
>а затем <TT
CLASS="LITERAL"
>dpkg -i /usr/src/kernel-image-2.0.29_custom.1.0_i386.deb</TT
>.</P
><P
>Если у вас другой дистрибутив Linux, следуйте требованиям стандартных инструкций по сборке ядра. Не забудьте сделать <TT
CLASS="LITERAL"
>make modules</TT
> и <TT
CLASS="LITERAL"
>make
modules_install</TT
>. Взгляните в "HOWTO: Звук в Linux" (Linux Sound HOWTO) и, возможно, в "HOWTO: Ядро" ( Kernel HOWTO)  за подробной информацией.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN267"
>3.4. Перезагрузка</A
></H2
><P
>После установки нового ядра вы должны перезагрузиться (убедитесь в том, что у вас есть под рукой работающий загрузочный флоппи-диск) Перекрестите пальцы :-).</P
><P
>Если у вас PnP-карта, убедитесь в запуске isapnp в загрузочном скрипте (как было описано выше) или вручную:</P
><P
>&#13;<PRE
CLASS="SCREEN"
># /sbin/isapnp /etc/isapnp.conf
Board 1 has Identity 74 00 00 e3 10 48 00 8c 0e:  CTL0048 Serial No 58128
[checksum 74]</PRE
>&#13;</P
><P
>Теперь вы можете установить драйвер звука, если собрали его в виде модуля:</P
><P
>&#13;<PRE
CLASS="SCREEN"
># modprobe -a sound
AWE32 Sound Driver v0.3.3e (DRAM 2048k)</PRE
>&#13;</P
><P
>Если вам кажется, что объем памяти неверный (У меня были сообщения о том, что в одной карте AWE64 было 4096 Кб, а "определялось" 28672 Кб), попытайтесь либо обновить пакет <TT
CLASS="LITERAL"
>awedrv</TT
> или указать объем памяти в файле
<TT
CLASS="LITERAL"
>/usr/src/linux/drivers/sound/lowlevel/awe_config.h</TT
>, например:</P
><P
>&#13;<PRE
CLASS="SCREEN"
>#define AWE_DEFAULT_MEM_SIZE  4096   /* kbytes */</PRE
>&#13;</P
><P
>Извините, но после этого вам придется пересобрать ядро (возможно пересборки модулей будет достаточно, но я в этом не уверен).</P
><P
>Если все заработало, вы наверно захотите загружать модуль звука автоматически. Можно использовать <TT
CLASS="LITERAL"
>kerneld</TT
> (это плохая идея - причины описаны в разделе 1.4) или добавить одну строчку, содержащую слово <TT
CLASS="LITERAL"
>sound</TT
> в ваш файл <TT
CLASS="LITERAL"
>/etc/modules</TT
> (в Debian)
или добавить строку <TT
CLASS="LITERAL"
>/sbin/modprobe -a sound</TT
> в ваш загрузочный скрипт.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN287"
>4. Проверяем драйвер звука</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN289"
>4.1. <TT
CLASS="LITERAL"
>/proc/devices, /dev/sndstat</TT
></A
></H2
><P
>Если поддержка звука встроена в ядро, то Вы увидите немного полезной информации при загрузке. Если  поддержка звука собрана в виде модуля, вы можете увидеть эту же информацию (возможно после выгрузки модуля командой
<TT
CLASS="LITERAL"
>modprobe -r sound</TT
>) при помощи команд</P
><P
>&#13;<PRE
CLASS="SCREEN"
># modprobe -a sound trace_init=1
Sound initialization started

&#60;Sound Blaster 16 (4.13)&#62; at 0x220 irq 5 dma 1,5
&#60;Sound Blaster 16&#62; at 0x330 irq 5 dma 0
&#60;Yamaha OPL3 FM&#62; at 0x388
Sound initialization complete
AWE32 Sound Driver v0.3.3e (DRAM 2048k)</PRE
>&#13;</P
><P
>Если у вас есть виртуальная файловая система <TT
CLASS="LITERAL"
>/proc</TT
>, можно поискать устройство вывода звука командой</P
><P
>&#13;<PRE
CLASS="SCREEN"
># cat /proc/devices
Character devices:
[...]
14 sound
[...]</PRE
>&#13;</P
><P
>Затем убедитесь, что у вас правильно настроены устройства в каталоге <TT
CLASS="LITERAL"
>/dev/</TT
>. Читайте "HOWTO: Звук в Linux" (Linux Sound HOWTO) для более полного описания. Затем запросите у <TT
CLASS="LITERAL"
>/dev/sndstat</TT
> статус модуля звука:</P
><P
>&#13;<PRE
CLASS="SCREEN"
># cat /dev/sndstat
Sound Driver:3.5.4-960630 (Sat Oct 11 19:35:14 CEST 1997 root,
Linux flora 2.0.29 #1 Sat Oct 11 19:12:56 CEST 1997 i586 unknown)
Kernel: Linux flora 2.0.29 #1 Sat Oct 11 19:36:23 CEST 1997 i586
Config options: 0

Installed drivers:
Type 1: OPL-2/OPL-3 FM
Type 2: Sound Blaster
Type 7: SB MPU-401

Card config:
Sound Blaster at 0x220 irq 5 drq 1,5
SB MPU-401 at 0x330 irq 5 drq 0
OPL-2/OPL-3 FM at 0x388 drq 0

Audio devices:
0: Sound Blaster 16 (4.13)

Synth devices:
0: Yamaha OPL-3
1: AWE32 Driver v0.3.3e (DRAM 2048k)

Midi devices:
0: Sound Blaster 16

Timers:
0: System clock

Mixers:
0: Sound Blaster
1: AWE32 Equalizer</PRE
>&#13;</P
><P
>Если у вас не вышло на экран что-то подобное, то, возможно, у вас ошибка в вашей конфигурации. Найдите  то, что не работает, затем вернитесь к шагу "<A
HREF="Soundblaster-AWE.html#ISAPNP"
><I
>Начало работы</I
></A
>", проверяя все на каждом шаге.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN307"
>4.2. Вывод - прямое (Raw) аудио-устройство</A
></H2
><P
>Найдите <TT
CLASS="LITERAL"
>.au</TT
>-файл (Рабочая станция Sun) или простой файл аудио-сэмпл (sample file), и наберите</P
><P
>&#13;<PRE
CLASS="SCREEN"
># cat bell.au &#62; /dev/audio</PRE
>&#13;</P
><P
>или, соответственно</P
><P
>&#13;<PRE
CLASS="SCREEN"
># cat sample &#62; /dev/dsp</PRE
>&#13;</P
><P
>Вы должны услышать результат через <TT
CLASS="LITERAL"
>Audio Device 0: Sound
Blaster 16 (4.3)</TT
>.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN318"
>4.3. Вывод - Синтезатор OPL-2/OPL-3</A
></H2
><P
>Если вы хотите использовать OPL-2/OPL-3 FM-синтезатор для проигрывания MIDI-файлов при помощи вашей звуковой карты, попробуйте использовать программу <TT
CLASS="LITERAL"
>playmidi</TT
> (см. приложение 2). Запустите ее командой</P
><P
>&#13;<PRE
CLASS="SCREEN"
># playmidi -f dance.mid</PRE
>&#13;</P
><P
>или</P
><P
>&#13;<PRE
CLASS="SCREEN"
># playmidi -4 dance.mid</PRE
>&#13;</P
><P
>Первый даст вам OPL-2, второй OPL-3 MIDI-музыку. Если вам очень не понравился звук, не обвиняйте в этом playmidi: просто сам FM-синтезатор издает не очень приятные звуки.</P
><P
>Представьте, что вы бы имели только драйвер звука OSS/Free: Тогда бы у вас было только такое качество MIDI-музыки (опуская возможность программного синтезирования). К счастью, у вас SB AWE, и можно использовать возможности WaveTable при помощи Звукового Драйвера AWE.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN329"
>4.4. Вывод - Синтезатор Wave Table</A
></H2
><P
>Звуковой Драйвер AWE поставляется с набором специальных утилит (<TT
CLASS="LITERAL"
>awesfx</TT
>) для того, чтобы сделать возможным использование Wave Table-синтезатор EMU 8000. Во-первых, вам надо загрузить Звуковые банки (Sound Font Bank) в вашу карту - даже если вы хотите использовать банки, прошитые в ПЗУ! Вы можете скопировать эти файлы из вашего Windows - ищите файлы, оканчивающиеся на <TT
CLASS="LITERAL"
>*.sfb</TT
> или
<TT
CLASS="LITERAL"
>*.sf2</TT
>.</P
><P
>Образцы звуков из ПЗУ звуковой карты можно загрузить с помощью файла <TT
CLASS="LITERAL"
>SYNTHGM.SBK</TT
>, настоящие образцы находятся в
<TT
CLASS="LITERAL"
>SYNTHGS.SBK</TT
> и <TT
CLASS="LITERAL"
>SYNTHMT.SBK</TT
>, а также в
<TT
CLASS="LITERAL"
>SAMPLE.SBK</TT
>. Вы можете скачать другие Звуковые Банки (Sound Font Banks) по ftp или www, попробуйте домашнюю страницу EMU, WWW-сайт Creative Labs, и поищите набор образцов "Chaos" - они также достаточно хороши (убедитесь, что также проверили сайт драйвера AWE).</P
><P
>Попытайтесь загрузить стандартный GM-набор (из ПЗУ) при помощи команды</P
><P
>&#13;<PRE
CLASS="SCREEN"
># sfxload -i synthgm.sbk</PRE
>&#13;</P
><P
>и затем попробуйте проиграть midi-file, поставляемый вместе с вашим SB AWE:</P
><P
>&#13;<PRE
CLASS="SCREEN"
># drvmidi dance.mid</PRE
>&#13;</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="MIXING"
>4.5. Микширование</A
></H2
><P
>Возьмите вашу любимую программу-микшер и запустите ее. Запустите прямой аудио-сэмпл и два MIDI-файла параллельно, и испробуйте настройки микшера. Поэкспериментируйте, это должно быть очень просто. Ниже приведен список устройств, и как они называются:</P
><P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
>Yamaha OPL-3</DT
><DD
><P
>WaveTable Синтезатор или FM</P
></DD
><DT
>AWE32 Driver</DT
><DD
><P
>WaveTable Синтезатор или FM (кто-нибудь видел микшер, в котором два последних разделены?)</P
></DD
><DT
>Sound Blaster 16 (4.13)</DT
><DD
><P
>PCM или DSP</P
></DD
><DT
>PC Speaker (все еще жив :-()</DT
><DD
><P
>Спикер</P
></DD
></DL
></DIV
></P
><P
>Другие настройки микшера относятся к CD-ROM, возможно подключенному к звуковой карте, к Общему Уровню (Master Volume), Низким Частотам (Bass), Верхним Частотам (Treble) и уровню записи (Recording Level) на разных входных линиях. Вы также можете выбрать, с каких линий оцифровывать звук.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN368"
>4.6. Ввод - оцифровка с помощью прямого аудио-устройства</A
></H2
><P
>Вы можете  записывать звук с различных источников: подключенного CD ROM, микрофона, подключенного к карте, а также со всего, что вы можете подключить к линейному входу вашей карты. Настройте микшер. Включите проигрывание звука и запишите его в файл, читая из прямого аудио устройства, например:</P
><P
>&#13;<PRE
CLASS="SCREEN"
># cdplay
# dd bs=8k count=5 &#60;/dev/dsp &#62;music.au
5+0 records in
5+0 records out
# cat music.au &#62;/dev/dsp</PRE
>&#13;</P
><P
>записывает, а затем проигрывает 5 секунд звука из устройства ввода.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN374"
>4.7. Порт MIDI</A
></H2
><P
>Извините, по MIDI-порту пока нет никакой информации!</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN377"
>5. Программное обеспечение драйвера AWE</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN379"
>5.1. <TT
CLASS="LITERAL"
>sfxload</TT
></A
></H2
><P
>Вы можете загрузить образцы звуков в память вашей звуковой карты командой <TT
CLASS="LITERAL"
>sfxload</TT
>. Заметьте, что можно загрузить только один файл в банк, и банк 0 используется по умолчанию. Так, после команды <TT
CLASS="LITERAL"
>sfxload synthgs.sbk</TT
>, в памяти вашей звуковой карты будут только образцы набора GS. Если вы хотите загрузить дополнительные Звуковые Банки (Sound Font Banks), надо использовать опцию <TT
CLASS="LITERAL"
>-b</TT
>, например:
 </P
><P
>&#13;<PRE
CLASS="SCREEN"
># sfxload synthgs.sbk
# sfxload -b1 sample.sbk
# drvmidi sfx.mid</PRE
>&#13;</P
><P
>Вы можете загружать стандартный Звуковой Банк автоматически в момент установки модуля. Просто добавьте строку вида</P
><P
>&#13;<PRE
CLASS="SCREEN"
>post-install sound /usr/bin/sfxload synthgm.sbk</PRE
>&#13;</P
><P
>в ваш файл <TT
CLASS="LITERAL"
>/etc/conf.modules</TT
>.</P
><P
>Смотрите также документацию, касающуюся <TT
CLASS="LITERAL"
>sfxload</TT
>.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN395"
>5.2. <TT
CLASS="LITERAL"
>drvmidi</TT
></A
></H2
><P
>При помощи программы <TT
CLASS="LITERAL"
>drvmidi</TT
> вы можете проигрывать MIDI-файлы через AWE-драйвер. Просто укажите имя файла в качестве аргумента команды:</P
><P
>&#13;<PRE
CLASS="SCREEN"
># drvmidi waltz.mid</PRE
>&#13;</P
><P
>Смотрите также документацию, касающуюся <TT
CLASS="LITERAL"
>drvmidi</TT
>.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN404"
>6. Приложение</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="MOREINFO"
>6.1. Дополнительная информация</A
></H2
><P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
>"HOWTO: Звук в Linux" (The Linux Sound HOWTO)</DT
><DD
><P
>Автор: Jeff Tranter, <TT
CLASS="LITERAL"
>&lt;<A
HREF="mailto:jeff_tranter@pobox.com"
TARGET="_top"
>jeff_tranter@pobox.com</A
>&gt;</TT
></P
><P
>Последняя версия: 1.17, 4 августа 1997</P
><P
>Пожалуйста, хорошо изучите этот HOWTO (доступно на sunsite.unc.edu и других сайтах). Там находится куча информации о сборке ядра с поддержкой звука, и объясняется многое о звуковых устройствах, программах и т.п.</P
><P
>Я воспринимаю мой документ как дополнение к "HOWTO: Звук в Linux" (The Linux Sound HOWTO).</P
></DD
><DT
>"HOWTO: Проигрывание звука в Linux" (The Linux Sound Playing HOWTO)</DT
><DD
><P
>Автор: Yoo C. Chung, <TT
CLASS="LITERAL"
>&lt;<A
HREF="mailto:wacko@laplace.snu.ac.kr"
TARGET="_top"
>wacko@laplace.snu.ac.kr</A
>&gt;</TT
></P
><P
>Последняя версия: 1.4, 13 мая 1997</P
><P
>Вы также должны взглянуть в "HOWTO: Проигрывание звука в Linux" (The Linux Sound Playing HOWTO). Там описывается проигрывание звуков в различных форматах, а также программы, их проигрывающие.</P
></DD
><DT
>"FAQ: Драйвер AWE" (The AWE Driver FAQ)</DT
><DD
><P
>Автор: Takashi Iwai <TT
CLASS="LITERAL"
>&lt;<A
HREF="mailto:iwai@dragon.mm.t.u-tokyo.ac.jp"
TARGET="_top"
>iwai@dragon.mm.t.u-tokyo.ac.jp</A
>&gt;</TT
></P
><P
>Исходный текст: <A
HREF="http://bahamut.mm.t.u-tokyo.ac.jp/~iwai/awedrv/awedrv-faq.html"
TARGET="_top"
>http://bahamut.mm.t.u-tokyo.ac.jp/~iwai/awedrv/awedrv-faq.html</A
></P
><P
>Если у вас проблемы с установкой драйвера AWE или с использованием вашего Sound Blaster, тогда взгляните в этот документ.</P
></DD
><DT
>"FAQ: ISA PnP" (The ISA PnP FAQ)</DT
><DD
><P
>Автор: Peter Fox <TT
CLASS="LITERAL"
>&lt;<A
HREF="mailto:fox@roestock.demon.co.uk"
TARGET="_top"
>fox@roestock.demon.co.uk</A
>&gt;</TT
></P
><P
>Исходный текст: <A
HREF="http://www.roestock.demon.co.uk/isapnptools/isapnpfaq.html"
TARGET="_top"
>http://www.roestock.demon.co.uk/isapnptools/isapnpfaq.html</A
></P
><P
>Если у вас проблемы с настройкой ISA PnP карты, тогда взгляните в эту книгу знаний.</P
></DD
></DL
></DIV
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="SOURCES"
>6.2. Источники</A
></H2
><P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="LITERAL"
>isapnptools</TT
></DT
><DD
><P
>Автор: Peter Fox <TT
CLASS="LITERAL"
>&lt;<A
HREF="mailto:fox@roestock.demon.co.uk"
TARGET="_top"
>fox@roestock.demon.co.uk</A
>&gt;</TT
></P
><P
>Последняя версия: 1.11</P
><P
>Источник: <A
HREF="http://www.roestock.demon.co.uk/isapnptools/index.html"
TARGET="_top"
>http://www.roestock.demon.co.uk/isapnptools/index.html</A
></P
><P
>Если будете посылать патчи, сообщения об ошибках или проблемах, пожалуйста, вставьте строку 'isapnp' где-нибудь в теме сообщения и пишите по адресу isapnp@roestock.demon.co.uk.</P
></DD
><DT
><TT
CLASS="LITERAL"
>awedrv</TT
></DT
><DD
><P
>Автор: Takashi Iwai <TT
CLASS="LITERAL"
>&lt;<A
HREF="mailto:iwai@dragon.mm.t.u-tokyo.ac.jp"
TARGET="_top"
>iwai@dragon.mm.t.u-tokyo.ac.jp</A
>&gt;</TT
></P
><P
>Последняя версия: 0.4.2c</P
><P
>Источник: <A
HREF="http://bahamut.mm.t.u-tokyo.ac.jp/~iwai/awedrv/"
TARGET="_top"
>http://bahamut.mm.t.u-tokyo.ac.jp/~iwai/awedrv/</A
></P
></DD
><DT
>Ядро Linux</DT
><DD
><P
>Автор: Linus Torvald и многие другие</P
><P
>Последняя версия: В настоящий момент используйте 2.0.29</P
><P
>Источник: везде, где вы можете найти Linux <TT
CLASS="LITERAL"
>:)</TT
></P
></DD
><DT
>OSS/Free</DT
><DD
><P
>Автор: Hannu Savolainen (Сначала смотрите <A
HREF="http://www.4front-tech.com/usslite"
TARGET="_top"
>http://www.4front-tech.com/usslite</A
>, затем пишите мне).</P
><P
>Последняя версия : У меня 3.5.5-beta1</P
><P
>Источник: исходные тексты ядра Linux</P
><P
>Информация:  <A
HREF="http://www.4front-tech.com/usslite"
TARGET="_top"
>http://www.4front-tech.com/usslite</A
> или <A
HREF="http://personal.eunet.fi/pp/voxware"
TARGET="_top"
>Зеркало в Европе</A
>.</P
></DD
></DL
></DIV
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="ISAPNPCONF"
>6.3. Пример <TT
CLASS="LITERAL"
>isapnp.conf</TT
></A
></H2
><P
>Файл конфигурации ISA PnP создается командой pnpdump, и отдельные части ваших PnP карт разделены на секции. В приведенном ниже примере обнаружена одна карта (звуковая) с четырьмя логическими устройствами:</P
><P
>&#13;<P
></P
><UL
><LI
><P
><TT
CLASS="LITERAL"
>LD 0</TT
>: Аудио-устройство</P
></LI
><LI
><P
><TT
CLASS="LITERAL"
>LD 1</TT
>: IDE-устройство</P
></LI
><LI
><P
><TT
CLASS="LITERAL"
>LD 2</TT
>: WaveTable-устройство</P
></LI
><LI
><P
><TT
CLASS="LITERAL"
>LD 3</TT
>: Устройство игрового порта</P
></LI
></UL
>&#13;</P
><P
>Я оставил <TT
CLASS="LITERAL"
>LD 1</TT
> без изменений, потому что у меня нет устройств, подключенных к IDE-порту звуковой карты. Если у вашего SB нет IDE-порта, то <TT
CLASS="LITERAL"
>LD 1</TT
> будет игровым устройством, а <TT
CLASS="LITERAL"
>LD 3</TT
> не появится.</P
><P
>Обязательно прочтите раздел "<A
HREF="Soundblaster-AWE.html#ISAPNP"
><I
>Начало работы</I
></A
>" для дальнейшей (очень важной!) информации  об этом файле.</P
><P
>&#13;<PRE
CLASS="PROGRAMLISTING"
># $Id: Soundblaster-AWE.html,v 1.1 2002/10/30 21:27:03 ott Exp $
# This is free software, see the sources for details.
# This software has NO WARRANTY, use at your OWN RISK
#
# Это бесплатное программное обеспечение, см. исходные
# для более детального описания. Это обеспечение не несет
# НИКАКИХ ГАРАНТИЙ, используйте НА СВОЙ СТРАХ И РИСК
#
# For details of this file format, see isapnp.conf(5)
# Детально формат этого файла описан в isapnp.conf(5)
#
# For latest information on isapnp and pnpdump see:
# За последней информацией по isapnp и pnpdump обращайтесь по адресу:
# http://www.roestock.demon.co.uk/isapnptools/
#
# Compiler flags: -DREALTIME -DNEEDSETSCHEDULER
# Флаги компилятора: -DREALTIME -DNEEDSETSCHEDULER

(READPORT 0x0203)
(ISOLATE)
(IDENTIFY *)

# Try the following if you get error messages like
# Error occurred executing request 'LD 2' on or around line...
# Попробуйте включить следущую строку , если у вас выдаются ошибки вида
# Во время исполнения запроса 'LD 2' возникла ошибка в строке...

#(VERIFYLD N)

# ANSI string --&#62;Creative SB32 PnP&#60;--

(CONFIGURE CTL0048/58128 (LD 0
#     ANSI string --&#62;Audio&#60;--

  (INT 0 (IRQ 5 (MODE +E)))
  (DMA 0 (CHANNEL 1))
  (DMA 1 (CHANNEL 5))
  (IO 0 (BASE 0x0220))
  (IO 1 (BASE 0x0330))
  (IO 2 (BASE 0x0388))

  (ACT Y)
))

(CONFIGURE CTL0048/58128 (LD 1
#     ANSI string --&#62;IDE&#60;--

# (INT 0 (IRQ 10 (MODE +E)))
# (IO 0 (BASE 0x0168))
# (IO 1 (BASE 0x036e))

# (ACT Y)
))

(CONFIGURE CTL0048/58128 (LD 2
#     ANSI string --&#62;WaveTable&#60;--

  (IO 0 (BASE 0x0620))
  (IO 1 (BASE 0x0A20))
  (IO 2 (BASE 0x0E20))

  (ACT Y)
))

(CONFIGURE CTL0048/58128 (LD 3
#     ANSI string --&#62;Game&#60;--

  (IO 0 (BASE 0x0200))
  (ACT Y)
))

# Returns all cards to the "Wait for Key" state
# Возвращаем все карты в состояние "Ожидание Ключа"
(WAITFORKEY)</PRE
>&#13;</P
></DIV
></DIV
></DIV
></BODY
></HTML
>