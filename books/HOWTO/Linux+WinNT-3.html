<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>Linux+WindowsNT mini-HOWTO: КАК УСТАНОВИТЬ: СНАЧАЛА NT, ЗАТЕМ WINDOWS LINUX</TITLE>
 <LINK HREF="Linux+WinNT-4.html" REL=next>
 <LINK HREF="Linux+WinNT-2.html" REL=previous>
 <LINK HREF="Linux+WinNT.html#toc3" REL=contents>
</HEAD>
<BODY>
<A HREF="Linux+WinNT-4.html">Next</A>
<A HREF="Linux+WinNT-2.html">Previous</A>
<A HREF="Linux+WinNT.html#toc3">Contents</A>
<HR>
<H2><A NAME="s3">3. КАК УСТАНОВИТЬ: СНАЧАЛА NT, ЗАТЕМ WINDOWS LINUX</A></H2>

<P>
<H2><A NAME="ss3.1">3.1 Если у вас <EM>только один</EM> жесткий диск IDE</A>
</H2>

<P>
<UL>
<LI>Прежде всего я предложил бы установить свежий дистрибутив
Windows NT 4.0 на ваш жесткий диск.
Я предполагаю, что вы уже сделали резервную копию важных данных,
тогда установка NT должна пройти без проблем.
Во времы установки NT, инсталлятор не спросит вас, где разместить
загрузчик NT. Он будет помещен в MBR (Главная загрузочная запись) на
вашем жестком диске.
Имеется возможность восстановить предыдущее содержимое
MBR (например? от предыдущего содержимого Lilo).
Я предложил бы вам (до инсталляции NT) загрузить
компьютер с дискеты DOS, имеющей программу FDISK.
В командной строке a:\ введите: fdisk /mbr и снова перезагрузите
компьютер (без дискеты).
<P>
</LI>
<LI>После успешной установки NT, вы увидите, что система использует
целый жесткий диск или определенный раздел жесткого диска
(в зависимости от того, как вы выбрали в процессе установки).
Т.о. рекомендуется 'сжать' раздел, где находится NT, чтобы освободить
некоторое пространство на диске.
На этом свободном пространстве вы установите Linux.
После того, как ваш NT сконфигурирован и запускается,
вы должны загрузить ваш компьютер, используя дискету с
утилитой Partition Magic.
Это графическая утилита позволяет видеть все разделы на всех
жестких дисках, которые у вас имеются.
Вы сможете сделать изменения ваших разделов и не потерять ваши
данные.
Первое - сделайте ваши существующие разделы меньше,
т.о. вы получите некоторое свободное место на диске для других
целей.
Хотя я вам советую сделать резервную копию до того, как вы
будете делать любые изменения разделов, я обычно делаю 'сжатие'
разделов NT, когда NT установлена не полностью (т.о. если
будет необходимость, повторный запуск установки не вызовет
проблем).
Partition Magic (или другая подобная утилита) будет 'сжимать'
ваши данные на NT разделе (NTFS или FAT) в начало или в конец
раздела. Вы можете сами выбрать, где размещать данные - в начале
или в конце диска (я обычно выбираю чтобы данные NT раздела
были в начале, т.о. в конце диска будет свободное пространство).
После 'сжатия' вы можете перезагрузить вашу систему (NT), чтобы
проверить результат: вы можете использовать для этого
Проводник Windows или Disk Administrator.

<P>
</LI>
<LI>Пока все хорошо. Следующий шаг - установка Linux.
Возмите ваш дистрибутив RedHat (я надеюсь, что с другими пакетами
подобно), поместите установочный диск в устройство и перезагрузите
компьютер.
Ну что же, когда вы выберите тип установки (Gnome или KDE
Workstation, Custom и т.п.) вы можете выбрать
запланированные заранее компоненты для установки, но я рекомендую
сначала установить Workstation.
Это лучше, т.к. установка Linux будет автоматически искать
свободное пространство на (первом) жестком диске, сделайте
все разделы необходимые Linux, отформатируйте их должным образом
и выберите большинство опций по умолчанию, т.о. установка
пройдет лучше (позже, если вы хотите, вы можете или добавить
отсутствующие компоненты, или переустановить Linux, выбрав Custom).
Lilo запишется в MBR.
<P>
</LI>
<LI>После окончания установки Linux, вы  должны перезагрузить компьютер
и после перезагрузки вы увидите только Lilo, с единственным
пунктом "Linux" в меню загрузки (или может быть больше, чем один пункт
для загрузки Linux, в случае, когда у вас многопроцессорная система).
Но не паникуйте! Ваш Windows NT находится там, где вы его установили.
Вам будет необходимо найти и отредактировать файл /etc/lilo.conf.
Сначала, когда вы откроете этот файл, вы увидите только одну (или больше)
записей для загрузки Linux.
Вы должны точно знать расположение (читай: раздел), где установлен
Windows NT, т.о., вы должны добавить соответствующую запись в
файл /etc/lilo.conf.
После того, как вы это сделаете, перезапустите Lilo, и при следующей
перезагрузке вы увидите обе записи 'linux' и 'nt' в меню Lilo.

<P>
</LI>
<LI>Моя добавленная запись для NT:

<P>other=/dev/hda1
<P>label=nt
<P>
<P>Т.о., полный файл /etc/lilo.conf подобен этому:
<P>
<P>boot=/dev/hda
<P>timeout=50
<P>prompt
<P>default=linux
<P>vga=normal
<P>read-only
<P>image=/boot/vmlinuz-2.2.12-20
<P>label=linux
<P>root=/dev/hda3
<P>other=/dev/hda1
<P>label=nt
<P>
<P>
</LI>
<LI>Несколько больше объяснений относительно моего файла /etc/lilo.conf:
После установки Windows NT, я назначил для этого устройства букву C:.
Помимо этого, я хотел иметь другой NTFS раздел, чтобы хранить и
резервировать важные данные. Вот почему я сделал и другой NT раздел,
которому назначил диск D:.
Оба NTFS раздела занимали приблизительно 3 Гб каждый, и программа
установки Linux находила их как разделы /dev/hda1 и /dev/hda2.
Остаток свободного места был 2 Гб, где я сделал раздел /root (1.9 Гб)
и раздел /swapp (100 MB) (/dev/hda3 и /dev/hda4 соответственно).</LI>
</UL>
<P>
<H2><A NAME="ss3.2">3.2 Если у вас <EM>больше чем один</EM> (SCSI) жесткий диск</A>
</H2>

<P><EM>Примечание: У меня на одном компьютере было несколько
SCSI дисков. Именно поэтому я помещал слово 'SCSI' в скобки.
У меня было несколько SCSI устройств - SCSI CD ROM и ленточное SCSI
устройство.
Т.о. это не подразумевает, что вы будете использовать SCSI устройства.
Вам достаточно обработать несколько IDE дисков, и, я надеюсь, процесс
установки сильно не изменится.</EM>
<P>
<P>
<UL>
<LI>Прежде всего я предложил бы установить свежий дистрибутив
Windows NT 4.0 на ваш <B>первый</B> жесткий диск.
Я предполагаю, что вы уже сделали резервную копию важных данных,
тогда установка NT должна пройти без проблем. Вы можете просто
скопировать ваши данные на второй жесткий диск.
Во время установки NT инсталлятор не спросит вас, где разместить
загрузчик NT. Он будет помещен в MBR (Главная загрузочная запись) на
вашем <B>первом</B> жестком диске.
Имеется возможность восстановить предыдущее содержимое
MBR (например от предыдущего содержимого Lilo).
Я предложил бы вам (до инсталляции NT) загрузить
компьютер с дискеты DOS, содержащей программу FDISK.
В командной строке a:\ введите: fdisk /mbr и снова перезагрузите
компьютер (без дискеты).
Если вы хотите быть уверены, что ваша машина 'чистая', вы можете
также удалить все существующие разделы на ваших <EM>других</EM> дисках
в процессе установки Windows NT <B>в том случае, если вы *не* сделали
никаких резервных копий на других дисках</B>.
<P>
</LI>
<LI>После успешной установки NT вы увидите, что система использует
целый жесткий диск или определенный раздел жесткого диска
(в зависимости от того, что вы выбрали в процессе установки).
Т.о. рекомендуется 'сжать' раздел, где находится NT, чтобы освободить
некоторое пространство на диске.
На этом свободном пространстве вы установите Linux.
Вы можете также подумать об использовании других дисков для Linux.
В этом случае вы будете должны запустить установку Linux и
попробовать использовать, например
/dev/sdb (или sdc, или sdd, в случае если у вас SCSI диски) или
/dev/hdb (или hdc, или hdd, в случае если у вас SCSI диски).
Обратите внимание, что установка Linux приняла все, что я выбрал,
но так или иначе, после окончания установки, LILO был не в состоянии
что-либо сделать. Фактически, загрузка всегда останавливалась после
вывода на экран 'LI', т.о., нет возможности запустить Linux вообще.
После некоторых размышлений, я решил сделать установку на
<B>первом</B> диске.
После того, как ваш NT сконфигурирован и запускается,
вы должны загрузить ваш компьютер, используя дискету с
утилитой Partition Magic.
Это графическая утилита позволяет видеть все разделы на всех
жестких дисках, которые у вас имеются.
Вы сможете сделать изменения ваших разделов и не потерять ваши
данные.
Первое - сделайте ваши существующие разделы меньше,
и вы получите некоторое свободное место на диске(ах) для других
целей.
Хотя я вам советую сделать резервную копию до того, как вы
будете делать любые изменения разделов, я обычно делаю 'сжатие'
разделов NT, когда NT установлена не полностью (т.о., если
будет необходимость, повторный запуск установки не вызовет
проблем).
Partition Magic (или другая подобная утилита) будет 'сжимать'
ваши данные на NT разделе (NTFS или FAT) в начало или в конец
раздела. Вы можете сами выбрать, где размещать данные - в начале
или в конце диска (я обычно предпочитаю, чтобы данные NT раздела
были в начале, тогда в конце диска будет свободное пространство).
После 'сжатия' вы можете перезагрузить вашу систему (NT), чтобы
проверить результат: вы можете использовать для этого
Проводник Windows или Disk Administrator.
Также обратите внимание, как NT может 'видеть' все (другие)
диски на вашей машине (как разделы или как свободное пространство).
<P>
</LI>
<LI>Пока все хорошо. Следующий шаг - установка Linux.
Возмите ваш дистрибутив RedHat (я надеюсь, что с другими пакетами
будет точно также), поместите установочный диск в устройство и перезагрузите
компьютер.
Когда вы выберите тип установки (Gnome или KDE Workstation, Custom и т.п.)
вы можете выделить
запланированные заранее компоненты для установки, но я рекомендую
сначала установить Workstation.
Это лучше, т.к. установка Linux будет автоматически искать
свободное пространство на <B>первом</B> жестком диске, сделайте
все разделы необходимые Linux, отформатируйте их должным образом,
и выберите большинство опций по умолчанию, т.о. установка
пройдет лучше (позже, если вы хотите, вы можете или добавить
отсутствующие компоненты, или переустановить Linux, выбрав Custom).
Lilo запишется в MBR на вашем <B>первом</B> жестком диске.
<P>
</LI>
<LI>После окончания установки Linux, вы  должны перезагрузить компьютер
и после перезагрузки вы увидите только Lilo с единственным
пунктом "Linux" в меню загрузки (или может быть больше одного пункта
для загрузки Linux, в том случае, когда у вас многопроцессорная система).
Но не паникуйте! Ваш Windows NT находится там, где вы его установили.
Вам будет необходимо найти и отредактировать файл /etc/lilo.conf.
Сначала, когда вы откроете этот файл, там будет только одна (или больше)
запись для загрузки Linux.
Вы должны точно знать расположение (читай: раздел), где установлен
Windows NT, т.о. вы должны добавить соответствующую запись в
файл /etc/lilo.conf.
После того, как это сделано, перезапустите Lilo, и при следующей
перезагрузке увидите обе записи 'linux' и 'nt' в меню Lilo.

<P>
</LI>
<LI>Моя добавленная запись для NT:

<P>other=/dev/sda1
<P>label=nt
<P>
<P>   Т.о., полный файл /etc/lilo.conf подобен этому:
<P>boot=/dev/sda
<P>map=/boot/map
<P>install=/boot/boot.b
<P>prompt
<P>timeout=50
<P>default=linux
<P>image=/boot/vmlinuz-2.2.12-20smp
<P>label=linux-mp
<P>initrd=/boot/initrd-2.2.12-20smp.img
<P>read-only
<P>root=/dev/sda6
<P>image=/boot/vmlinuz-2.2.12-20
<P>label=linux-up
<P>initrd=/boot/initrd-2.2.12-20.img
<P>read-only
<P>root=/dev/sda6
<P>other=/dev/hda1
<P>label=nt
<P>
<P>
</LI>
<LI>Несколько больше объяснений относительно моего файла /etc/lilo.conf:
После установки Windows NT на <B>первый диск</B>,
я назначил для этого устройства букву C:.
После того, как я подготовил достаточно свободного пространства
за разделом NTFS, я позволил установке Linux обработать дальнейшую
разбивку.
Хотя Linux должен поддерживать, как минимум, 4 основных раздела на
диск, скорее всего установка сделает расширенный раздел, т.к.
каждый раз она обнаруживает, что на диске уже имеется
основной раздел.
Эти 'виртуальные' основные разделы идут с /dev/sda1 до /dev/sda4
(включая расширенный), расширенный должен стать /dev/sda4.
Первый логический раздел в пределах расширенного радела будет
/dev/sda5 (в моем случае, это был раздел /boot, который физически
располагался от начала <B>первого</B> жесткого диска).
Т.о., разделы /root и /swapp были /dev/sda6 и /dev/sda7 соответственно.
Вы можете видеть строку "root=/dev/sda6" сообщающую вам это.
Lilo запишется в MBR, и все прекрасно запустится.

<P>
</LI>
<LI>Ну что же, вы можете спросить меня: Хорошо, но что, если у меня
несколько жестких установлены в машине? Хороший вопрос.
Вы видите, я имею <EM>четыре</EM> SCSI диска и, конечно,
я пробовал установить Linux на 2-м, дальше на 3-м и наконец
на 4-м диске.
Я делал это (установка Linux ни на что не жаловалась),
но после перезагрузки Lilo останавливался после вывода 'LI', т.о.
система не стартовала.
Наконец я понял, что есть проблема с дисками, которые "далеки"
от MBR, расположенный на <B>первом</B> диске.
Именно поэтому, я предложил сделать их всех (NT и Linux)
на <B>первом</B> диске.
После этого все работало нормально, и не было проблем, связанных с тем,
чтобы
сделать диски видимыми (и используемыми) в обеих операционных
системах.
Я надеюсь, ваш <B>первый</B> диск достаточно большой, чтобы обе
операционные системы (NT нужно около 150 MB, Linux требует
около 580 MB (Gnome или KDE Workstations) и более 1.4 Гб (Custom)).
Это означает, что <B>первый</B> диск должен быть заполнен на 2.4 Гб.

<P>
</LI>
<LI>Вы можете также спросить меня:
Что если я 'сжал' NT раздел так, что свободное пространство оказалось
в начале диска?
Хорошо, я пробовал делать так и устанавливать сначала
Gnome Workstation (395 пакетов, 570 MB). В процессе установки все шло
хорошо, но Lilo не был установлен, и загрузочная дискета не была сделана.
Т.о. Linux не работал.
Тогда я попытался установить KDE Workstation (377 пакетов, 582 MB)
на то же место.
Опять все шло хорошо, но Lilo не был установлен, и загрузочная дискета
не была сделана.
Исследуя это, я изучал структуру всех существующих разделов.
Я был удивлен, когда новый логический раздел распознался (в пределах
нового расширенного раздела), как расположенный <EM>после</EM> раздела NT!
Другими словами, получился 'забавный' порядок: /dev/sda5, /dev/sda6,
/dev/sda7 и, наконец, /dev/sda1.
Такая система была несколько запутана.

<P>
</LI>
<LI>Относительно двух подобных образов Linux (отличные в 'smp').
Это сервер с мульти-процессорной поддержкой.
"Интеллектуальная" программа установки осмотрела аппаратные средства
и предложила выбрать использовать 'несколько' или 'один' процессор.
Однако у меня работает только один процессор.
</LI>
</UL>
<P>
<HR>
<A HREF="Linux+WinNT-4.html">Next</A>
<A HREF="Linux+WinNT-2.html">Previous</A>
<A HREF="Linux+WinNT.html#toc3">Contents</A>
</BODY>
</HTML>
