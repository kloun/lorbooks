<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r"><title>Как правильно подготовить свою WWW страничку</title><meta name="generator" content="DocBook XSL Stylesheets V1.59.1"><link rel="home" href="index.html" title="The Linux Cyrillic HOWTO (russian)"><link rel="up" href="ch12.html" title="Глава 12. WWW и кириллизация"><link rel="previous" href="ch12s04.html" title="Netscape Navigator"><link rel="next" href="ch13.html" title="Глава 13. Совместимость"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Как правильно подготовить свою WWW страничку</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch12s04.html">Пред.</a> </td><th width="60%" align="center">Глава 12. WWW и кириллизация</th><td width="20%" align="right"> <a accesskey="n" href="ch13.html">След.</a></td></tr></table><hr></div><div class="sect1" lang="ru"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="WWW-right-choice"></a>Как правильно подготовить свою WWW страничку</h2></div></div><a class="indexterm" name="id2893752"></a><p>Этот раздел появился благодаря (фактически полностью состоит
из) статьям Андрея А. Чернова. Подробную информацию по этому вопросу
можно найти на страничке А.А. Чернова <a href="http://koi8.pp.ru/" target="_top">KOI8-R - Russian Net Character
Set</a>.</p><div class="sect2" lang="ru"><div class="titlepage"><div><h3 class="title"><a name="id2893784"></a>Предисловие</h3></div></div><p>Всемирное падение нравов началось с незначительной уступки
пользователям. Как известно, в стандартах по HTML/HTTP чётко сказано,
что каждому документу должен соответствовать такой параметр, как
MIME-имя кодировки, и есть только один случай, когда его можно не
указывать &#8212; если документ составлен в кодировке <span class="emphasis"><em>ISO
8859-1</em></span>. Это правило оказалось либо совершенно неизвестным,
либо невыносимо сложным для неподготовленных пользователей, так что
они предпочли проигнорировать его, и странички создавались просто
набиванием некоторых кодов.</p><p>Далее, компании Netscape начал поступать поток претензий,
что странички, набитые таким образом, не видны. Вместо того, чтобы
отослать ламеров к документации, компания Netscape делает фатальный
ход, минимально необходимый, чтобы все окончательно разрушить &#8212;
вводит возможность выбора кодировки для страничек, где она не
указана!</p><p>Естественно, после такого уже никто не считает нужным
указывать кодировку документа; раньше останавливало хотя бы то
обстоятельство, что были затруднения с просмотром кривых страничек,
требующие такой достаточно сложной операции, как замена шрифта
<span class="emphasis"><em>ISO 8859-1</em></span> на шрифт используемой кодировки,
теперь это препятствие было преодолено благодаря попустительству
Netscape. Вслед за Netscape этот фатальный шаг делают и производители
остальных броузеров, из соображений выживания в конкурентной
борьбе. Вернуть все назад невозможно из-за тех же коммерческих
соображений...</p><p>Тем самым, теперь выбор кодировки переносится с
автоматического уровня на пользовательский, отсюда все эти надоедливые
&quot;Выберите вашу кодировку&quot;  и на страничках, и в броузерах.</p><p>В связи с общей коммерциализацией Интернет такие вещи, как
соответствие стандартам, уже перестают быть аргументом, и продукты,
ещё следующие им, потихоньку вытесняются в маргинальные области. В
общем, процесс повторяет происходящее в социуме, и будет продолжаться
до тех пор, пока участников не начнёт тошнить. Этот порог отодвигается
все дальше и дальше благодаря удивительным способностям человеческого
организма к адаптации...</p><p><span class="emphasis"><em>ВНИМАНИЕ!</em></span> Иногда я слышу
безответственные &quot;мнения&quot;  по поводу того, что указывать
кодировку необязательно и не нужно: мол, пользователь у нас не
ленивый, выберет вручную. При этом &quot;советчики&quot;  злостно
умалчивают о том, что надёжного автоматического определения кодировки
не существует и не может существовать в принципе; так что вебмастера,
не проставляющие кодировку, с какой-то вероятностью ставят свои
странички под удар быть неверно истолкованными разного рода системами
автоматической обработки текста, например, поисковыми машинами. Это
все равно как вам бы предложили согласиться быть убитым с небольшой
вероятностью, скажем 3%. И зачем вам это нужно?</p></div><div class="sect2" lang="ru"><div class="titlepage"><div><h3 class="title"><a name="WWW-right-choice-standart"></a>Русские странички не нарушая стандартов - это
просто!</h3></div></div><a class="indexterm" name="id2893935"></a><a class="indexterm" name="id2893950"></a><p>Здесь приведена пошаговая инструкция правильной подготовки
ваших русских страничек для WWW:</p><div class="itemizedlist"><ul type="disc"><li><p>Если у вас на страничках стоит выбор
кодировок, выкиньте этот кусок HTML кода: он вам больше не понадобится
&#8212; отныне все будет происходить автоматически.
</p></li><li><p> Если у вас странички не в кодировке
<span class="emphasis"><em>KOI8-R</em></span>, перекодируйте их туда каким-нибудь
конвертером &#8212; смотрите раздел <a href="ch09s03.html" title="Символьная перекодировка">&#8220;Символьная перекодировка&#8221;</a>.
Ничего страшного не произойдёт: если все дальнейшее вы сделаете
правильно, то в таком виде их по-прежнему можно будет редактировать,
скажем, в <tt>Netscape Composer</tt> без всякой заметной
разницы. Мало того, в таком виде ваши странички будут одинаково хорошо
видны для всех операционных систем без всяких переключателей
кодировок, превратившихся в бич русского WWW.  </p></li><li><p> <span class="emphasis"><em>Внимание!</em></span> Данный пункт можно пропустить, если на вашем сервере
стоит Apache или какая-либо его разновидность (то есть в 90% случаев) &#8212;
в этом случае необходимая информация может быть задана в настройках
Apache.

Если же вы предполагаете частые переезды с сервера на сервер с
неизвестными HTTPD, следуйте указаниям пункта.</p><div class="itemizedlist"><ul type="circle"><li><p>Проверьте самую первую строчку ваших
русских HTML документов, она должна выглядеть примерно так:

</p><pre class="programlisting">
&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;
</pre><p>

Если такой строчки нет, или номер после слова HTML меньше 4.0,
добавьте её в самое начало.  <span class="emphasis"><em>Примечание для
специалистов:</em></span> атрибут <span class="emphasis"><em>LANG</em></span> определён
только в HTML 4.0 и выше, так что указание DTD обязательно.
</p></li><li><p> Замените следующий за ней таг
<tt>&lt;HTML&gt;</tt> на таг <tt>&lt;HTML
LANG=ru&gt;</tt>, это укажет, что ваш документ на русском языке,
и облегчит жизнь поисковикам.  </p></li></ul></div></li><li><p> Спросите вашего веб-мастера, что за штука стоит у вас в качестве
веб-сервера, если он ответит:</p><div class="itemizedlist"><ul type="circle"><li><p>что Apache или Apache/RUS: в самом
верхнем каталоге, содержащем ваши странички, создайте файл с именем
<tt>.htaccess</tt>, доступный всем на чтение с такими
строчками:</p><div class="orderedlist"><ol type="1"><li><p> Для версий Apache, начиная с 1.3.12:
</p><pre class="programlisting">
AddDefaultCharset koi8-r
AddLanguage ru .html .txt
</pre><p>
</p></li><li><p> Для версий Apache, начиная с 1.3.10:
</p><pre class="programlisting">
AddCharset koi8-r .html .txt
AddLanguage ru .html .txt
</pre><p>
</p></li><li><p> Для более старых версий Apache (или
если версия вам неизвестна):

</p><pre class="programlisting">
AddType &quot;text/html; charset=koi8-r&quot; .html
AddType &quot;text/plain; charset=koi8-r&quot; .txt
AddLanguage ru .html .txt
</pre><p>
</p></li></ol></div><p>Если файл <tt>.htaccess</tt> уже есть,
просто добавьте туда эти строчки.</p><p>Записанное в <tt>.htaccess</tt>
распространяется на все подкаталоги вниз по дереву.</p><p>Подразумевается, что ваши HTML документы
заканчиваются на <tt>.html</tt>; если они заканчиваются на
<tt>.htm</tt>, поменяйте <tt>.html</tt> на
<tt>.htm</tt> в предлагаемом образце.</p><p>При таких настройках не обязательно (но можно)
указывать язык тагом <tt>&lt;HTML LANG=ru</tt>, как это было
описано выше.</p><p>Указание языка внутри HTML документа имеет
приоритет над указанием для сервера.</p><p>Так как для текстовых (<tt>*.txt</tt>)
документов никак нельзя указать язык внутри документа, указание для
сервера &#8212; это единственная альтернатива.</p><p>Если у вас на сервере стоит
<span class="emphasis"><em>Apache/RUS</em></span>, то рекомендуется отключить всякую
автоматическую перекодировку, добавив в <tt>.htaccess</tt>
директиву</p><pre class="programlisting">
CharsetTurnOff On
</pre><p>

(работает начиная с версии Apache/RUS PL20).</p><p><span class="emphasis"><em>ПРЕДУПРЕЖДЕНИЕ:</em></span> в последних
версиях Apache обработка файлов <tt>.htaccess</tt> по
умолчанию выключена в главной конфигурации (директивой
<tt>AllowOverride None</tt>), т.е. ваши установки не будут
иметь никакого эффекта. В этом случае попросите вебмастера включить
такую обработку для вашего каталога, добавив директиву</p><pre class="programlisting">
AllowOverride +FileInfo
</pre><p>

в соответствующую секцию <tt>&lt;Directory ...&gt;</tt>
конфигурации Apache.</p></li><li><p>что NCSA: в каждом каталоге, содержащем ваши странички, заведите
файл с именем <tt>.htaccess</tt>, доступный всем на чтение с
такими строчками:
</p><pre class="programlisting">
AddType text/html;\ charset=koi8-r .html
AddType text/plain;\ charset=koi8-r .txt
</pre><p>
</p><p>Если файл <tt>.htaccess</tt> уже есть,
просто добавьте туда эти строчки.</p><p>Подразумевается, что ваши HTML документы
заканчиваются на <tt>.html</tt>; если они заканчиваются на
<tt>.htm</tt>, поменяйте конец строки на
<tt>.htm</tt> соответственно.</p></li><li><p>что CERN: для каждого вашего каталога с
русскими страничками создайте подкаталог <tt>.web</tt>, в
него положите файлы с именами, сконструированными добавлением суффикса
.meta к именам в главном каталоге. Каталог <tt>.web</tt> и
файлы в нем должны быть доступны всем на чтение. Например, файлу
<tt>index.html</tt> соответствует файл
<tt>.web/index.html.meta</tt> и т.д.  Каждый такой файл
должен содержать следующую строчку</p><pre class="programlisting">
Content-Type: text/html; charset=koi8-r
</pre><p>

(для HTML файлов) или</p><pre class="programlisting">
Content-Type: text/plain; charset=koi8-r
</pre><p>

(для текстовых файлов).</p></li><li><p>что какой-нибудь другой HTTP сервер:
сперва попробуйте связать расширения <tt>.html</tt> и
<tt>.txt</tt> по аналогии с решениями выше; если вы не
знаете, как это сделать в вашем HTTP сервере, вам придётся
редактировать непосредственно сами ваши странички: в секцию
<tt>&lt;HEAD&gt;</tt> каждого HTML документа вставьте самой
первой директивой следующий таг:</p><pre class="programlisting">
&lt;META HTTP-EQUIV=&quot;Content-Type&quot;
CONTENT=&quot;text/html; charset=koi8-r&quot;&gt;
</pre><p>
</p><p>Т.е. каждый ваш документ должен будет выглядеть
примерно так:</p><pre class="programlisting">
&lt;HEAD&gt;
&lt;META HTTP-EQUIV=&quot;Content-Type&quot;
CONTENT=&quot;text/html; charset=koi8-r&quot;&gt;
&lt;TITLE&gt;Заголовок странички&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
Содержимое странички
&lt;/BODY&gt;
</pre><p>
</p><p>К сожалению, в этом случае невозможно указание
кодировки для текстовых файлов (<tt>*.txt</tt>).</p></li></ul></div></li></ul></div><p>На этом всё готово. При просмотре ваших страничек никто
теперь не увидит мусора из умляутов вместо нормальных русских букв, и
не придётся больше выбирать кодировки!</p></div><div class="sect2" lang="ru"><div class="titlepage"><div><h3 class="title"><a name="WWW-right-choice-check"></a>Проверка правильности кириллизации</h3></div></div><a class="indexterm" name="id2894624"></a><a class="indexterm" name="id2894643"></a><p>Как проверить, удалось ли проставить кодировку и язык в
HTTP заголовке?</p><p>Допустим, ваша страничка называется
<tt>http://www.yourserver.ru/yourpath/yourpage.html</tt></p><div class="itemizedlist"><ul type="disc"><li><p>Наберите:

<tt>telnet www.yourserver.ru 80</tt>
</p></li><li><p>После соединения наберите:</p><pre class="screen">
HEAD /yourpath/yourpage.html HTTP/1.0
</pre><p>Если ваша страничка находится на виртуальном сервере,
то к приведённой выше строчке следует добавить <tt>Host:
host.ru</tt></p><p>Возможно, в некоторых системах придётся набирать
вслепую.</p></li><li><p>Нажмите Enter два раза. Вы увидите HTTP
заголовок.</p></li><li><p> Найдите в нем поле
<tt>Content-Type</tt> и проверьте, что там стоит не просто
<tt>text/html</tt>, а <tt>text/html;
charset=koi8-r</tt> </p></li><li><p>Если вы на сервере установили русский язык для
ваших страничек, в заголовке должно присутствовать поле

</p><pre class="programlisting">
       Content-Language: ru
</pre><p>
</p></li></ul></div></div><div class="sect2" lang="ru"><div class="titlepage"><div><h3 class="title"><a name="id2894779"></a>Полезные советы</h3></div></div><p><span class="emphasis"><em>А совсем старые версии броузеров не показывают
русских букв при таком способе, что делать?</em></span></p><p><span class="emphasis"><em>Посоветовать пользователю сменить версию
броузера на более новую.</em></span> В качестве прецедента, вспомните,
что было с вводом прогрессивных JPEG, или анимированных GIF? Все
поменяли версии на новые, никто не жаловался и не делал две копии
страничек, одну с GIFами, а другую &#8212; без, а потом предлагал бы
их выбрать...</p><p><span class="emphasis"><em>А нельзя сделать так, чтобы 1) старые версии
работали, 2) новые версии работали, и 3) чтобы пользователю было
удобно?</em></span></p><p><span class="emphasis"><em>Нельзя.</em></span> Из этой тройки можно сделать
вместе только два, на выбор. Из-за ненависти к пользователю у нас
часто делают (1) чтобы старые версии работали и (2) чтобы новые версии
работали (при этом стандартам не соответствует), я же предпочитаю (3)
чтобы пользователю было удобно и (2) чтобы новые версии работали (при
этом стандартам соответствовало), а вы?</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch12s04.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="ch12.html">Уровень выше</a></td><td width="40%" align="right"> <a accesskey="n" href="ch13.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">Netscape Navigator </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> Глава 13. Совместимость</td></tr></table></div></body></html>
