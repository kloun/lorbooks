<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>IPX в Linux HOWTO: Настройка PPP для поддержки IPX</TITLE>
 <LINK HREF="IPX-HOWTO-15.html" REL=next>
 <LINK HREF="IPX-HOWTO-13.html" REL=previous>
 <LINK HREF="IPX-HOWTO.html#toc14" REL=contents>
</HEAD>
<BODY>
<A HREF="IPX-HOWTO-15.html">Следующий</A>
<A HREF="IPX-HOWTO-13.html">Предыдущий</A>
<A HREF="IPX-HOWTO.html#toc14">Содержание</A>
<HR>
<H2><A NAME="s14">14. Настройка PPP для поддержки IPX</A>      </H2>

<P>Новые версии <EM>pppd</EM>, демона PPP для Linux, имеют поддержку,
которая позволит вам переносить пакеты IPX через последовательные
соединения PPP. Вам необходим по крайней мере демон версии
<CODE>ppp-2.2.0d</CODE>. Смотрите 
<A HREF="PPP-HOWTO.html">PPP-HOWTO</A>
для детальной информации о том где найти его. При компиляции
<EM>pppd</EM> вы должны убедиться что вы разрешили поддержку IPX
добавив следующие две строки:
<P>
<BLOCKQUOTE><CODE>
<PRE>
IPX_CHANGE = 1
USE_MS_DNS = 1
</PRE>
</CODE></BLOCKQUOTE>
<P>
<P>в файл: <CODE>/usr/src/linux/pppd-2.2.0f/pppd/Makefile.linux</CODE>.
<P>
<P><CODE>IPX_CHANGE</CODE> настраивает поддержку IPX в PPP. Определение
<CODE>USE_MS_DNS</CODE> позволяет машинам с Microsoft Windows95 делать Name
Lookups (Поиск Имен).
<P>
<P>Настоящий фокус чтобы заставить это все работать&nbsp;-- это
знание как настраивать демона.
<P>
<P>Существует много способов настройки, но я опишу только два о
которых я получил какую-то информацию. Я никогда не пытался сделать
это, так что рассматривайте это раздел как экспериментальный, и если
у вас что-то получится дайте мне знать. 
<P>
<H2><A NAME="ss14.1">14.1 Настройка сервера IPX/PPP</A>
        </H2>

<P>Первая вещь которую вам нужно сделать это настроить вашу
Linux-машину как сервер IP/PPP. Не паникуйте. Это не так
трудно. Далее, следуйте инструкциям в 
<A HREF="PPP-HOWTO.html">PPP-HOWTO</A> и все должно быть ok. Когда вы сделаете это есть
несколько простых изменений, которые вам нужны чтобы заставить
работать IPX на той же конфигурации. 
<P>
<H3>Первые шаги          </H3>

<P>Один из первых шагов которые вы должны сделать&nbsp;-- это
настройка вашей Linux машины как маршрутизатора IPX, как это
описано в соответствующем разделе выше в этом документе. Вам не
нужно использовать команду <EM>ipx_route</EM> для интерфейса <CODE>ppp</CODE>
потому-что <EM>pppd</EM> сам настроит это для вас как он это делает с
IP. Когда у вас запущен демон <EM>ipxd</EM> он сам будеи
автоматически определять любые новые интерфейсы IPX и
распространять маршруты для них. В этом случае ваша машина будет
видна другим машинам автоматически при подсоединении.
<P>
<H3>Дизайн          </H3>

<P>Когда вы работаете как сервер, то вы несете ответственность за 
назначение сетевых адресов на каждое PPP-соединение, когда оно
установлено. Это важный вопрос, каждое PPP-соединение будет
являться сетью IPX и должно иметь уникальный сетевой адрес
IPX. Это означает, что вы должны решить как вы будете назначать
адреса и какими они будут. Простое решение заключается в
выделении одного сетевого адреса IPX на каждое последовательное
устройство, которое будет поддерживать IPX/PPP. Вы можете
выдавать сетевые адреса IPX основанные на идентификаторе
подключающегося пользователя, но я не вижу особенно хорошей
причины чтобы делать это.
<P>
<P>Я буду предполагать что у вас это сделано, и что вы имеете два 
последовательных устройства (модема), которые вы будете
использовать. Адреса которые я присвоил в этом примере следующие: 
<P>
<BLOCKQUOTE><CODE>
<PRE>
устройство  Сетевой адрес IPX
------     &nbsp;------------------
ttyS0       0xABCDEF00
ttyS1       0xABCDEF01
</PRE>
</CODE></BLOCKQUOTE>
<P>
<H3>Настройка <EM>pppd</EM>.          </H3>

<P>Настройте ваш файл <CODE>/etc/ppp/options.ttyS0</CODE> как
показано: 
<P>
<BLOCKQUOTE><CODE>
<PRE>
ipx-network 0xABCDEF00
ipx-node 2:0
ipxcp-accept-remote
</PRE>
</CODE></BLOCKQUOTE>
<P>
<P>и ваш файл <CODE>/etc/ppp/options.ttyS1</CODE> как:
<P>
<BLOCKQUOTE><CODE>
<PRE>
ipx-network 0xABCDEF01
ipx-node 3:0
ipxcp-accept-remote    
</PRE>
</CODE></BLOCKQUOTE>
<P>
<P>Это скажет <EM>pppd</EM> выделить соответствующий сетевой
адрес IPX для соединения когда оно установлено, установить номер
локального узла в <CODE>2</CODE> или <CODE>3</CODE> и позволит удаленному узлу
переписать номер удаленного узла в тот который ему нужен. Заметим
что каждый из этих узлов являются шестнадцатиричными числами и
требуется <CODE>0x</CODE> а начале сетевого адреса, но не требуется в
начале адреса узла.
<P>
<P>Существуют другие места в которых эта информация может быть
настроена. Если вы имеете только один модем, то запись должна
быть расположена в файле <CODE>/etc/ppp/options</CODE>. В других
случаях эта информация может быть передана через командную строку
<EM>pppd</EM>.
<P>
<H3>Проверка настройки сервера          </H3>

<P>Для проверки настройки сервера вам необходим уже работающий
клиент. Когда клиент подсоединяется, входит в систему и
запустится <EM>pppd</EM>, то он присвоит сетевой адрес, проверьте
номер узла клиента этого сервера и согласуете номера узлов
клиентов.  Когда это будет выполнено и после того как
<EM>ipxd</EM> определит новый интерфейс, клиент сможет
устанавливать соединения IPX с удаленными машинами. 
<P>
<H2><A NAME="ss14.2">14.2 Настройка клиента IPX/PPP</A>
        </H2>

<P>В настройке клиента необходимость настройки вашей Linux-машины
как маршрутизатора IPX зависит от того имеете ли вы локальную сеть
для которой вы хотите выступать как маршрутизатор или нет. Если у
вас автономная машина, подключенная к серверу IPX/PPP, то вам нет
необходимости запускать <EM>ipxd</EM>, но если у вас есть локальная 
сеть и вы хотите чтобы все машины в этой сети могли использовать
IPX/PPP маршрутизацию, то вы должны настроить и запустить
<EM>ipxd</EM> как описано. Эта настройка более проста потому-что у
вас нет множественных последовательных устройств, которые
необходимо настраивать. 
<P>
<H3>Настройка <EM>pppd</EM>          </H3>

<P>Простейшая конфигурация это такая, которая позволяет серверу
обеспечивать всю информацию о настройке сети IPX. Эта
конфигурация должна быть совместимой с конфигурацией сервера,
описанной выше. 
<P>
<P>Далее вам необходимо добавить некоторые опции в ваш файл
<CODE>/etc/ppp/options</CODE>:
<P>
<BLOCKQUOTE><CODE>
<PRE>
ipxcp-accept-network
ipxcp-accept-remote
ipxcp-accept-local
</PRE>
</CODE></BLOCKQUOTE>
<P>
<P>Эти опции говорят <EM>pppd</EM> полностью работать пассивно и
принимать все настроечные детали от сервера. Вы можете установить 
значения по умолчанию для серверов, которые не обеспечивают эти
детали добавлением записей <CODE>ipx-network</CODE> и <CODE>ipx-node</CODE>
сходных с конфигурацией сервера.
<P>
<H3>Тестирование клиента IPX/PPP          </H3>

<P>Для тестирования клиента вам необходим работающий сервер к
которому можно подключиться. После того как вы подключились и
запустился <CODE>pppd</CODE> вы должны увидеть детали настройки IPX
на вашем устройстве <CODE>ppp0</CODE> когда вы запустите команду
<EM>ifconfig</EM> и вы должны мочь использовать
<EM>ncpmount</EM>. 
<P>
<P>Я не уверен должны ли вы добавлять маршруты IPX вручную, чтобы 
достичь удаленного файлового сервера. Вероятно да. Если
кто-нибудь запустит такую конфигурацию сообщите мне я буду
благодарен. 
<P>
<HR>
<A HREF="IPX-HOWTO-15.html">Следующий</A>
<A HREF="IPX-HOWTO-13.html">Предыдущий</A>
<A HREF="IPX-HOWTO.html#toc14">Содержание</A>
</BODY>
</HTML>
