<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Мини-HOWTO: "Использование загрузчика NT OS с Linux"</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.57"></HEAD
><BODY
CLASS="ARTICLE"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="ARTICLE"
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
><A
NAME="AEN2"
>Мини-HOWTO: "Использование загрузчика NT OS с Linux"</A
></H1
><DIV
CLASS="AUTHORGROUP"
><A
NAME="AEN4"
></A
><H3
CLASS="AUTHOR"
><A
NAME="AEN5"
>Bernd Reichert</A
></H3
><DIV
CLASS="AFFILIATION"
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
>&nbsp;&nbsp;&nbsp;&nbsp;     reichert@dial.eunet.ch
    <br>
&nbsp;&nbsp;&nbsp;</P
></DIV
></DIV
><H3
CLASS="CORPAUTHOR"
>  Перевод: <A
HREF="mailto:sam@asp-linux.com"
TARGET="_top"
>Станислав Рогин</A
>,
  <A
HREF="http://www.asplinux.com"
TARGET="_top"
>SWSoft Pte Ltd.</A
>
 </H3
></DIV
><P
CLASS="PUBDATE"
>версия 1.11, 2 сентября 1997<BR></P
><HR></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Содержание</B
></DT
><DT
>1. <A
HREF="Linux+NT-Loader.html#AEN15"
>Вступление</A
></DT
><DT
>2. <A
HREF="Linux+NT-Loader.html#AEN18"
>Как работает загрузчик NT OS</A
></DT
><DT
>3. <A
HREF="Linux+NT-Loader.html#AEN21"
>Советы и подсказки по установке Windows NT и Linux на одном компьютере</A
></DT
><DD
><DL
><DT
>3.1. <A
HREF="Linux+NT-Loader.html#AEN23"
>Установка Windows NT</A
></DT
><DT
>3.2. <A
HREF="Linux+NT-Loader.html#AEN27"
>Создание разделов на жестком диске</A
></DT
><DT
>3.3. <A
HREF="Linux+NT-Loader.html#AEN30"
>Инсталляция Linux</A
></DT
><DT
>3.4. <A
HREF="Linux+NT-Loader.html#AEN34"
>Lilo</A
></DT
></DL
></DD
><DT
>4. <A
HREF="Linux+NT-Loader.html#AEN47"
>Bootpart</A
></DT
><DT
>5. <A
HREF="Linux+NT-Loader.html#AEN52"
>Действия в Linux</A
></DT
><DT
>6. <A
HREF="Linux+NT-Loader.html#AEN66"
>Действия в Windows NT</A
></DT
><DT
>7. <A
HREF="Linux+NT-Loader.html#AEN85"
>Все по новой...</A
></DT
><DT
>8. <A
HREF="Linux+NT-Loader.html#AEN89"
>Диагностика проблем</A
></DT
><DT
>9. <A
HREF="Linux+NT-Loader.html#AEN103"
>Первоисточники</A
></DT
><DT
>10. <A
HREF="Linux+NT-Loader.html#AEN111"
>Благодарности</A
></DT
><DT
>11. <A
HREF="Linux+NT-Loader.html#AEN119"
>Отзывы и предложения</A
></DT
><DT
>12. <A
HREF="Linux+NT-Loader.html#AEN122"
>Авторские права</A
></DT
></DL
></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN15"
>1. Вступление</A
></H1
><P
>Этот документ описывает методику использования системы загрузки Windows NT
для загрузки Linux. Описанные здесь процедуры тестировались на Windows NT
4.0 WS и Linux 2.0.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN18"
>2. Как работает загрузчик NT OS</A
></H1
><P
>Загрузчик NT OS сохраняет загрузочные сектора других операционных систем в
виде файлов. При старте считывается нужный файл и начинается загрузка или
Windows NT в выбранном режиме, или какой-то другой операционной системы.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN21"
>3. Советы и подсказки по установке Windows NT и Linux на одном компьютере</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN23"
>3.1. Установка Windows NT</A
></H2
><P
>Сначала установите Windows NT. Если вы хотите использовать файловую систему
NTFS для разделов Windows NT, то помните, что на настоящее время в Linux
нет поддержки NTFS. Тестовую версию драйвера (только для чтения) NTFS можно
найти по адресу <TT
CLASS="LITERAL"
>http://www.informatik.hu-berlin.de/&tilde;loewis/ntfs</TT
>. Для обмена
информацией вы можете создать отдельный FAT-раздел, или передавать ее через
флоппи-диски, отформатированные под DOS.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN27"
>3.2. Создание разделов на жестком диске</A
></H2
><P
>При совместном использовании Windows NT и Linux на одном компьютере не
рекомендуется использовать NT "Disk Administartor" для создания основного
Linux-раздела и раздела подкачки. Его лучше запускать только для получения
информации о свободном для новых разделов месте на винчестере. А вообще,
желательно использовать Linux-программу fdisk.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN30"
>3.3. Инсталляция Linux</A
></H2
><P
>Загрузите Linux с дискет, создайте основной раздел и раздел подкачки. Fdisk
выводит NTFS-разделы, как HPFS. Так и должно быть. Снова перезагрузитесь с
дискет, и продолжайте устанавливать Linux так, как вам хочется, в
необходимой конфигурации.</P
><P
>Если процедура установки Linux сообщит вам, что у вас есть возможность
подключить раздел HPFS, обнаруженный на компьютере, то ПРОИГНОРИРУЙТЕ это
предложение.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN34"
>3.4. Lilo</A
></H2
><P
>Когда вы начнете работу с Lilo, то определите ваш основной раздел Linux как
загрузочное устройство, так как Master Boot Record (MBR) вашего жесткого
диска используется Windows NT. Проверьте следующее - записи о корневом
(root) и загрузочном (boot) устройстве в конфигурационном файле
<TT
CLASS="FILENAME"
>/etc/lilo.conf</TT
> должны быть идентичны. Если у вас стоит IDE-винчестер, и
Linux установлен на втором разделе, то запись о загрузочном устройстве в
файле <TT
CLASS="FILENAME"
>/etc/lilo.conf</TT
> будет выглядеть так:</P
><P
>&#13;<PRE
CLASS="SCREEN"
>boot=/dev/hda2</PRE
>&#13;</P
><P
>&#13;Если у вас стоит два винчестера, и Linux установлен на первый раздел на
втором диске, то запись о загрузочном устройстве в файле <TT
CLASS="FILENAME"
>/etc/lilo.conf</TT
>
будет выглядеть так:</P
><P
>&#13;<PRE
CLASS="SCREEN"
>boot=/dev/hdb1</PRE
>&#13;</P
><P
>Запускайте lilo и Linux соответствующих версий! Если вы не помните номер
версии вашей системы, то загрузитесь с дискеты, и посмотрите, какую версию
вы используете.&#13;</P
><P
>Если сейчас вы, вдруг, не можете загрузить Windows NT, то появились
серьезные проблемы. Надеемся, что вы не забыли создать загрузочную дискету.&#13;</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN47"
>4. Bootpart</A
></H1
><P
>Для NT существует программа bootpart, созданная G. Vollant, которая может
помочь вам выполнить действия, описанные в последующих двух пунктах данного
руководства. Bootpart можно найти по адресу
<TT
CLASS="LITERAL"
>http://ourworld.compuserve.com/homepages/gvollant/bootpart.htm</TT
>.</P
><P
>Если же вы сами хотите понять, как взаимодействуют системы NT и Linux, то
проанализируйте и выполните действия, описанные в пунктах 5 и 6
руководства.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN52"
>5. Действия в Linux</A
></H1
><P
>Пока не исправлены конфигурационные файлы NT, придется загружать Linux
с дискет.</P
><P
>Сейчас необходимо получить образ стартового загрузочного сектора с
загрузочного раздела Linux. Если этот раздел - /dev/hda2, то команда должна
быть такой:</P
><P
>&#13;<PRE
CLASS="SCREEN"
># dd if=/dev/hda2 of=/bootsect.lnx bs=512 count=1</PRE
>&#13;</P
><P
>Если размер файла bootsect.lnx больше, чем 512 байт, то что-то прошло
неправильно.</P
><P
>Теперь скопируем файл bootsect.lnx на отформатированную DOS-дискету (если
вы таким образом обмениваетесь информацией с NTFS-Windows-разделом)</P
><P
>Скопировать файл можно командой </P
><P
>&#13;<PRE
CLASS="SCREEN"
># mcopy /bootsect.lnx a:</PRE
>&#13;</P
><P
>или командами </P
><P
>&#13;<PRE
CLASS="SCREEN"
># mount -t msdos /dev/fd0 /mnt
# copy /bootsect.lnx /mnt
# umount /mnt</PRE
>&#13;</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN66"
>6. Действия в Windows NT</A
></H1
><P
>Скопируйте полученный файл с дискеты в <TT
CLASS="FILENAME"
>C:\\bootsect.lnx</TT
>. Не мне вам
объяснять, как это делать.</P
><P
>Чем является файл <TT
CLASS="FILENAME"
>lilo.conf</TT
> для Linux, тем же является и файл <TT
CLASS="FILENAME"
>c:\\boot.ini</TT
>
для Windows NT. Снимите с него атрибуты System и Read-Only командой:</P
><P
>&#13;<PRE
CLASS="SCREEN"
>C:\attrib -s -r c:\boot.ini </PRE
>&#13;</P
><P
>Поменяем содержимое файла boot.ini (в любом текстовом редакторе, например в "notepad"), таким вот образом: </P
><P
>&#13;<PRE
CLASS="SCREEN"
>[boot loader]
timeout=30
default=multi(0)disk(0)rdisk(0)partition(1)\WINNT
[operating systems]
multi(0)disk(0)rdisk(0)partition(1)\WINNT="Windows NT Workstation ... 
multi(0)disk(0)rdisk(0)partition(1)\WINNT="Windows NT Workstation ...
C:\BOOTSECT.LNX="Linux"</PRE
>&#13;</P
><P
>В нашем случае, в файл была добавлена только последняя строчка. Восстановите
прежние атрибуты файла (после того, как сохраните <TT
CLASS="FILENAME"
>boot.ini</TT
>) командой:</P
><P
>&#13;<PRE
CLASS="SCREEN"
>C:\attrib +s +r c:\boot.ini </PRE
>&#13;</P
><P
>Теперь, после выключения Windows NT и перезагрузки компьютера, вы должны
увидеть следующее:</P
><P
>&#13;<PRE
CLASS="SCREEN"
>  OS Loader V4.00
 
  Please select the operating system to start:

  Windows NT Workstation Version 4.0
  Windows NT Workstation Version 4.0 [VGA mode]
  Linux

Выберите пункт меню Linux и получите долгожданную строчку


  LILO loading zImage ....</PRE
>&#13;</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN85"
>7. Все по новой...</A
></H1
><P
>Как только во время работы изменится загрузочный сектор основного раздела
Linux, вам придется повторить операцию с копированием файла bootsect.lnx в
<TT
CLASS="LITERAL"
>C:\BOOTSECT.LNX</TT
>. Такое может произойти, например, после того, как вы
обновите версию вашей системы или переустановите lilo. Понятно, что
подобная комбинация систем совсем не предназначена для отладки и
тестирования экспериментальных версий ядер Linux.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN89"
>8. Диагностика проблем</A
></H1
><P
>Если все работает совсем не так, как вы ожидали, то для начала проверьте
саму возможность загрузки и нормальной работы Linux с помощью загрузочной
дискеты. Если ваш основной раздел - это <TT
CLASS="FILENAME"
>/dev/hdb1</TT
>, то в файле
<TT
CLASS="FILENAME"
>/etc/lilo.conf</TT
> вы должны увидеть следующие строки:</P
><P
>&#13;<PRE
CLASS="SCREEN"
>&#13;root=/dev/hdb1
boot=/dev/fd0</PRE
>&#13;</P
><P
>Вставьте загрузочную дискету и запустите lilo. Если Linux не запускается с
<TT
CLASS="FILENAME"
>/dev/hdb1</TT
>, то, соответственно, и загрузчик NT OS не сможет его запустить.
Если вы видите много символов <TT
CLASS="LITERAL"
>01 01 01 01</TT
>, то это означает, что основной
раздел Linux недоступен. Проверьте, правильно ли определены в BIOS ваши
винчестеры.</P
><P
>Если вы, с помощью дискеты, смогли загрузить Linux, то осталось всего лишь
скопировать загрузочный сектор с дискеты для загрузчика NT OS.</P
><P
>&#13;<PRE
CLASS="SCREEN"
># dd if=/dev/fd0 of=/bootsect.lnx bs=512 count=1</PRE
>&#13;</P
><P
>Можно сохранить эту дискету для аварийной загрузки на случай, если вдруг
что-нибудь случится с системой Windows NT.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN103"
>9. Первоисточники</A
></H1
><P
>&#13;<P
></P
><UL
><LI
><P
>Мини-HOWTO Linux+WindowsNT </P
></LI
><LI
><P
>Часто задаваемые вопросы (FAQ) для FreeBSD 2.X </P
></LI
></UL
>&#13;</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN111"
>10. Благодарности</A
></H1
><P
>&#13;<P
></P
><UL
><LI
><P
>Спасибо Xiaoming Yi &lt;z3c20@ttacs.ttu.edu&gt; за подсказку о том, что описанный
здесь алгоритм действий работает не только на первом винчестере, а на любом
жестком диске в компьютере.</P
></LI
><LI
><P
>Спасибо Frank Dennler &lt;Frank.Dennler@zkb.ch&gt; за разъяснение способа работы
с дискетой&#13;</P
></LI
></UL
>&#13;</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN119"
>11. Отзывы и предложения</A
></H1
><P
>Мы с уважением примем любые комментарии и примечания о работе вышеописанной системы. &#13;</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN122"
>12. Авторские права</A
></H1
><P
>Авторские права на русский перевод этого текста принадлежат &copy; 2000 SWSoft Pte Ltd.
Все права зарезервированы.</P
><P
>Этот документ является частью проекта Linux HOWTO.</P
><P
>Авторские права на документы Linux HOWTO принадлежат их авторам, если явно
не указано иное. Документы Linux HOWTO, а также их переводы, могут
быть воспроизведены и распространены полностью или частично на любом
носителе физическом или электронном, при условии сохранения этой заметки об
авторских правах на всех копиях. Коммерческое распространение разрешается и
поощряется; но, так или иначе, автор текста и автор перевода желали бы знать о
таких дистрибутивах.</P
><P
>Все переводы и производные работы, выполненные по документам Linux HOWTO,
должны сопровождаться этой заметкой об авторских правах. Это делается в
целях предотвращения случаев наложения дополнительных ограничений на
распространение документов HOWTO. Исключения могут составить случаи
получения специального разрешения у координатора Linux HOWTO, с которым
можно связаться по адресу приведенному ниже.</P
><P
>Мы бы хотели распространить эту информацию по всем возможным каналам. Но
при этом сохранить авторские права и быть уведомленными о всех планах
распространения HOWTO. Если у вас возникли вопросы, пожалуйста, обратитесь
к координатору проекта Linux HOWTO по электронной почте:
<TT
CLASS="EMAIL"
>&#60;<A
HREF="mailto:linux-howto@metalab.unc.edu"
>linux-howto@metalab.unc.edu</A
>&#62;</TT
> или к координатору русского
перевода Linux HOWTO компании SWSoft Pte Ltd. по адресу
<TT
CLASS="EMAIL"
>&#60;<A
HREF="mailto:linux-howto@asplinux.ru"
>linux-howto@asplinux.ru</A
>&#62;</TT
></P
></DIV
></DIV
></BODY
></HTML
>